num91:
    text: |-
        ## 91) Информационные критерии для сравнения моделей и выбора порядка временного ряда: Акаике, Шварца, Хеннана-Куина. Условия их применения.

        Для сравнения моделей и выбора порядка используются стандартные информационные критерии, которые определяются через ошибку регрессии 

        $$
        \sigma^2=\dfrac{u_t^2}{n}
        $$

        Информационный критерий Акаике

        $$
        AIC = \ln\sigma^2 + \dfrac{2(p+q+1)}{n}
        $$

        Информационный критерий Шварца

        $$
        BIC = \ln\sigma^2 + \dfrac{(p+q)\ln n}{n}
        $$

        Информационный критерий Хеннана-Куина

        $$
        BQC = \ln\sigma^2 + \dfrac{2(p+q)\ln(\ln n)}{n}
        $$

        где p, q — порядок модели ARMA(p, q)

        При сравнении нескольких моделей ARMA разных порядков мы выбираем ту, что имеет минимальный информационный критерий.

        Критерий Акаике имеет тенденцию к ****завышению порядка ****при больших выборках, поэтому критерий Шварца считается предпочтительнее для оценивания порядка. 

        Критерий Хеннана-Куина может недооценивать порядок при небольших объемах выборки.
    keywords: []
num92:
    text: |-
        ## 92) Проверка адекватности модели: тесты на автокорреляцию временного ряда Дарбина-Уотсона, Льюинга-Бокса.

        Тесты на автокорреляцию позволяют проверить “адекватность” выбранного порядка модели.  Идея состоит в том, что если порядок модели “правильный”, то остатки u_t “моделируют” белый шум (в частности, отсутствует автокорреляция). Так как модель содержит лаговые значения зависимой переменной, то критерий Дарбина–Уотсона для исследования ошибок на автокорреляцию неприменим. Статистика DW будет смещенной в сторону уменьшения.

        Для авторегрессионных моделей разработаны специальные тесты обнаружения

        автокорреляции, в частности *h-статистика Дарбина*, которая определяется по формуле:

        $$
        h = \hat{c}\sqrt{\dfrac{n}{1-n\cdot D_{b_{y_{t-1}}}}}, \text{где}\\ \hat{c} = 1-0,5d -\text{оценка автокорреляции первого порядка}; D_{b_{y_{t-1}}}-\text{выборочная дисперсия коэффициента регрессии при лаговой переменной } y_{t-1}
        $$

        Полученное значение *h*-статистики сравнивается с критической точкой u_(a/2). Если |h|>u_(a/2), то наличие автокорреляции подтверждается. Основная проблема с использованием этого теста заключается в невозможности вычисления *h* при n*D > 1.

        Приведем метод исследования, предложенный Боксом и Льюнгом и основанный на применении Q-статистик. Тесты на серийную корреляцию подразумевают проверку гипотезы:

        $$
        H_0: \rho_u(1) = ... = \rho_u(K)=0
        $$

        Тестовая Q-статистика Льюинга-Бокса:

        $$
        Q = n(n+2) + \sum_{h=1}^{X^K}\dfrac{\rho_u^2(h)}{n-h}
        $$

        где ρ_u(h) – автокорреляционная функция ACF для ряда остатков u_t.

        При выполнении условия Гаусса-Маркова на ошибки модели Q-статистики асимптотически имеют распределение Хи-квадрат со степенью свободы K-q-p. 

        H0 отвергается при 

        $$
        Q > χ^2_{кр}= χ^2(K-p-q, \alpha)
        $$

        Тогда тест указывает на серийную корреляцию для u_t.
    keywords: []
num93:
    text: |-
        ## 93) Линейная регрессия для стационарных рядов: Модель FDL.

        Модель FDL (Finite Distributed Lag) - это метод линейной регрессии, который применяется для анализа взаимосвязи между стационарными временными рядами, где зависимая переменная зависит от текущего и прошлых значений независимой переменной.

        Пусть xt=(x_t1,…,x_tk)' – стационарные ряды. Модель распределённых лагов FDL(q) включает лаги регрессоров до порядка q: 

        $$
        yt=μ+x_t'\beta_0+x_{t-1}'\beta_1+…+x_{t-q}'\beta_q+ u_t, u_t ∼ WN(0, σ_u^2).
        $$

        к модели FDL применимы все выводы стандартной линейной регрессии. При интерпретации коэффициентов при лагах надо отличать краткосрочный и долгосрочный эффект.
    keywords: []
num94:
    text: |-
        ## 94) Линейная регрессия для стационарных рядов. Модель ADL.

        Модель авторегрессии-распределённых лагов ADL(p,q) включает лаги регрессоров до порядка q и лаги зависимой переменной до порядка p.

        $$
        y_t = c + \sum_{i=1}^p \varphi_i y_{t-i} + \sum_{j=1}^q \theta_j x_{t-j} + \varepsilon_t \text{, где:}\\ y_t \text{ - значение зависимой переменной в момент времени} t\\
        x_t \text{ - значение независимой переменной в момент времени} t\\
        c \text{ - константа}\\
        \varphi_i \text{ - коэффициенты авторегрессии (AR)}\\
        \theta_j \text{ - коэффициенты распределённых лагов (DL)}\\
        \varepsilon_t \text{ - белый шум}\\
        $$

        Для использования модели необходимо:

        - проверить стационарность, для этого все корни многочлена

        $$
        φ(z) = 1 − φ_1z − · · · − φ_pz^p \text{(в том числе из C)}
        $$

        должны быть по модулю больше единицы. 

        - x(1), x(2), . . . , x(t)^p – (многомерный) стационарный временной ряд;
        - u_t – процесс белого шума**,** E(u_t) = 0**,** Var(u_t) = σ^2**;**
        - cov(u_t, x_tj ) = 0**,** j = 1 . . . , k**;**
        - cov(u_t, y_{t−s}) = 0**,** s = 1, . . . , p**;**

        Тогда для ADL **п**рименимы все выводы стандартной линейной регрессии. Так как модель регрессии содержит лаговые значения зависимой переменной, то статистика DW будет смещена и тест Дарбина-Уотсона к данной модели неприменим.
    keywords: []
num95:
    text: |-
        ## 95) Понятие TS-ряда. Модель линейного тренда. Модель экспоненциального тренда.

        Определение. Ряд x_t называется стационарным относительно тренда, если для него имеет место представление

        $$
        x_t = f(t) + v(t),\text{ где: } \\f (t) \text{– детерминированная функция (тренд или долгосрочная тенденция)},\\ v_t \text{– стационарный ряд с нулевым средним.}
        $$

        Следовательно, E(x_t )= f (t) и Var(x_t) = Var(v_t) ≡ const.

        Модель линейного тренда задается уравнением 

        $$
        x_t = β_0 + β_1t + u_t,\ t = 1, . . . , n.
        $$

        Будем предполагать, что ошибки ut удовлетворяют условиям теоремы Гаусса – Маркова, поэтому к модели линейного тренда применимы выводы стандартной линейной модели регрессии. В частности, среднее значение E(x_t) линейно зависит от времени t:
        E(x_t_ = β_0 + β_1*t. Коэффициент β_1 имеет следующую интерпретацию: это есть среднее
        приращение временного ряда за один период времени △E(x_t) = E(x_t) − E_(x_{t−1}) = β_1.
        Cредняя скорость изменения временного ряда за один период времени постоянна.

        Модель экспоненциального тренда задается уравнением

        $$
        \ln(x_t) = β_0 + β_1t + u_t.
        $$

        Будем предполагать, что ошибки u_t удовлетворяют условиям теоремы Гаусса – Маркова. Тогда к модели линейного тренда применимы выводы стандартной линейной модели регрессии. В частности, среднее значение зависит от t экспоненциально:
        E ln(x_t) = β_0 + β_1*t. Для коэффициента β_1 получаем следующую интерпретацию:
        △E ln(x_t) = E ln(x_t) − E ln(x_{t−1}) = E ln (x_t/x_{t-1}) = β_1. Следовательно, за один период времени (в среднем) значение x_t изменяется в exp(β_1) раз. Если β_1 мало, то exp(β_1) ≈ 1+β_1 и за один период времени в среднем значение x_t изменяется (в первом приближении) на β_1 · 100%.
    keywords: []
num96:
    text: |-
        ## 96) Нестационарные временные ряды: случайное блуждание, стохастический тренд, случайное блуждание со сносом.

        ### Случайное блуждание и стохастический тренд

        Модель AR(1)

        $$
        x_t = φx_{t−1} + u_t, u_t ∼ WN(0, σ_u^2).
        $$

        А в случае φ = 1 ряд x_t называется **случайным блужданием**. 

        $$
        x_t = x_{t−1} + u_t, u_t ∼ WN(0, σ_u^2)
        $$

        Случайное блуждание — случайный процесс, который описывает путь, состоящий из последовательности случайных шагов.

        Для случайного блуждания x_t

        $$
        x_t = u_t + x_{t−1} = u_t + u_{t−1} + x_{t−2} = · · · = \sum_{s=1}^{x^t}u_s + x_0.
        $$

        s=1 us называется **стохастическим трендом** (us – белый шум).

        Особенность названия происходит от того, что локально ряд часто

        похож на детерминированный тренд (локально наблюдается тенденция к

        росту или к убыванию). 

        ### Случайное блуждание со сносом

        Рассмотрим модель AR(1)

        $$
        x_t = \mu + φx_{t−1} + u_t, u_t ∼ WN(0, σ_u^2).
        $$

        При φ = 1 ряд x_t называется **случайным блужданием со сносом**

        $$
        x_t = \mu + x_{t−1} + u_t, u_t ∼ WN(0, σ_u^2).
        $$
    keywords: []
num97:
    text: |-
        ## 97) Дифференцирование ряда: определение, DS-ряды.

        Операция **дифференцирования** или **первая конечная разность** ряда обозначается как

        $$
        x_t = x_t − x_{t−1} = (1 − L)x_t,\ \text{где } L-\text{лаговый оператор} 
        $$

        Идея состоит в том, чтобы вместо исходного ряда рассматривать его
        приращение за один период.  Дифференцирование ряда позволяет перейти к стационарному ряду относительно приращений.

        Аналогично можно ввести дифференцирование и более высокого порядка.
        Дифференцирование второго порядка:

        $$
        \Delta^2x_t = Δ(Δx_t) = x_t − 2x_{t−1} + x_{t−2}.
        $$

        или через лаговый оператор:

        $$
        \Delta^2x_t = (1 − L)^2x_t = (1
        − 2L + L^2)x_t
        $$

        Для общего случая: 

        $$
        \Delta^kx_t = Δ(Δ^{k-1}x_t)\ \text{или} \Delta^kx_t = (1 − L)^kx_t
        $$

        ### DS-ряды

        Ряд x_t называется **интегрированным порядка** k, если

        1. x_t не TS-ряд и нестационарный;

        2. k – минимальный порядок такой, что Δ^k xt – стационарный или TS-ряд.

        Обозначение: x_t ∼ I(k).

        Ряд x_t называется **DS-рядом**, если x_t ∼ I(k) для некоторого k.
    keywords: []
num98:
    text: |-
        ## 98) Подход Бокса-Дженкинса.

        Подход Бокса-Дженкинса - это методология моделирования и прогнозирования временных рядов. Он представляет собой систематический подход к анализу и моделированию временных рядов, который состоит из трех основных этапов: исследование и определение структуры ряда, оценка параметров модели и прогнозирование.

        1. анализ исходного временного ряда для определения его структуры и свойств, таких как тренд, сезонность и цикличность. Это может быть выполнено путем проведения декомпозиции ряда на составляющие, такие как тренд, сезонность и случайную компоненту.

        2. оцениваются параметры модели, которые максимально соответствуют исходному временному ряду. Это может быть выполнено путем выбора соответствующей модели и оценки ее параметров с помощью метода максимального правдоподобия.

        3. прогнозирование будущих значений ряда. Это может быть выполнено путем использования оцененных параметров модели для генерации будущих значений временного ряда.
    keywords: []
num99:
    text: |-
        ## 99) Модель ARIMA.

        ARIMA - это статистическая модель, которая может использоваться для анализа и прогнозирования стационарных временных рядов. Она является расширением модели ARMA и включает в себя анализ интегрированных рядов, которые содержат нестационарный компонент.

        ARIMA-модель может быть записана как ARIMA(p, d, q), где p, d, q - это параметры, используемые для определения структуры модели:

        - p - количество лагов авторегрессии в модели. То есть сколько предыдущих значений временного ряда будет использоваться для прогнозирования следующего значения.
        - d - количество раз, необходимо диффиренцировать временной ряд для достижения стационарности.
        - q - количество лагов скользящего среднего в модели. То есть сколько предыдущих ошибок прогнозирования будет использоваться для прогнозирования следующего значения.

        Для нестационарных рядов, которые можно представить стационарными относительно приращений, вводится класс моделей: 

        $$
        x_t ∼ ARIMA(p,k,q)^2\text{,если} x_t~I(k);\Delta^kxt∼ARMA(p,q)^3
        $$

        Таким образом, модель ARIMA(p, k, q) можно рассматривать как нестационарную ARMA(p+k, q), авторегрессионный многочлен которой имеет единичный корень кратности k, а остальные р корней по модулю больше единицы. Отсюда происходит и название, так называемых, рядов с единичным корнем.

        Для прогнозирования ARIMA-рядов используем алгоритм прогнозирования для ARMA-рядов
    keywords: []
num100:
    text: |-
        ## 100) Тест ADF на единичный корень.

        Тест Дики и Фуллера используется для проверки ряда на стационарность и является тестом на единичный корень. Тест Дики – Фуллера можно провести только в том случае, если ошибки регрессии не коррелируют и в правой части только первый лаг Y. В противном случае применяется расширенный тест Дики и Фуллера с использованием тех
        же критических значений тестовой статистики. 

        $\Delta X_t = \beta_0 + \delta X_{t-1} + \beta_2t + \sum^m_{i=1}\alpha_i\Delta X_{t-i} + \epsilon_t$ 

        H0: $\delta = 0$ нестационарность
        H1: $\delta < 0$ стационарность

        $t = \frac{\hat\delta}{se(\hat\delta)}$, где $\hat\delta$ - оценка, $se(\hat\delta)$ - стандартное отклонение. 

        Распределение статистики Дики – Фуллера (tau statistics) не
        совпадает с распределением статистики Стьюдента. Нужно
        использовать специальные таблицы. Если значение статистики лежит левее критического значения, то нулевая гипотеза о единичном корне отклоняется и процесс признается стационарным (в смысле данного теста).
    keywords: []
num101:
    text: |-
    ## 101) Модель ARCH.        **Авторегрессионная условная гетероскедастичность** (*ARCH* — AutoRegressive Conditional Heteroscedasticity) — модель анализа временных рядов, у которых условная (по прошлым значениям ряда) дисперсия ряда зависит от прошлых значений ряда, прошлых значений этих дисперсий и иных факторов.        ARCH(q):        $e_t = \sqrt{h_t}v_t, v_t \sim i.i.d. N(0, 1)$        $h_t = a_0 + a_1e^2_{t-1} +…+a_qe^2_{t-q}$ - ARCH(q)         $h_t$ - условная дисперсия случайной величины $e_t$,    относительно «прошлого» ряда $e_t$. Для недопущения отрицательных значений дисперсии предполагается, что все коэффициенты модели неотрицательны, причём константа строго положительна. Необходимое условие стационарности — сумма коэффициентов модели (без константы) строго меньше единицы. Оценка параметров по МНК
    keywords: []
num102:
    text: |-
        ## 102) Модель GARCH

        GARCH (Обобщенная авторегрессионная условная гетероскедастичность) модель является обобщением модели ARCH (модель анализа временных рядов, у которых условная (по прошлым значениям ряда) дисперсия ряда зависит от прошлых значений ряда, прошлых значений этих дисперсий и иных факторов).  Модель GARCH(r, m) описывается следующим образом: 

        $h_t = a^*_0 + b_1h_{t-1}  + b_2h_{t-2} + … + b_rh_{t-r} + a_1e^2_{t-1} + a_2e^2_{t-2} + ... + a_me^2_{t-m}$, где $a^*_0 = [1 - b_1 - b_2 - … - b_r]a_0$ 

        Предполагается, что все коэффициенты модели неотрицательны, причём константа строго положительна. Необходимое условие стационарности
        $\sum^p_{i=1} ~\beta_{i} +\sum_{i=1}^q~\alpha_{i} < 1$
    keywords: []
num103:
    text: |-
        ## 103) Область применения панельных данных. Преимущества использования панельных данных.

        Панельные данные состоят из повторных наблюдений одних и тех же выборочных единиц (индивиды, фирмы, страны и т.д.), которые осуществляются в последовательные периоды времени. Примером панельных данных могут быть ежегодные социально-экономические показатели для регионов одной страны.
        Панельные данные совмещают в себе как пространственные данные, так и временные ряды и сочетают достоинства каждого их этих видов данных. Выделяют следующие преимущества использования панельных данных.

        1. Панельные данные позволяют учитывать индивидуальную неоднородность; 
        2. Панельные данные содержат большое число наблюдений и тем самым предоставляют исследователю большее количество информации, им свойственна большая вариация и меньшая коллинеарность объясняющих переменных, они дают большее число степеней свободы и обеспечивают большую эффективность оценок;
        3. Панельные данные предоставляют возможность изучать динамику изменений индивидуальных характеристик единиц совокупности. Панельные данные могут использоваться как для объяснения того, почему различные единицы совокупности ведут себя по-разному, так и для того, чтобы определить, почему конкретная единица совокупности ведет себя по-разному в различные периоды времени;
        4. Панельные данные лучше способны идентифицировать и измерить эффекты, которые просто не определяемы только во временных рядах или только в пространственных данных;
        5. Панельные данные позволяют конструировать и тестировать более сложные поведенческие модели, чем пространственные данные и временные ряды в отдельности.
    keywords: []
num104:
    text: |-
        ## 104) Модели панельных данных и основные обозначения.

        $y_{it}$ - зависимая переменная для  i-ой единицы совокупности в момент времени t

        $x^j_{it}$ - значение j-ой объясняющей переменной  для i-ой единицы в момент времени t

        i = 1,…,N; t = 1,…,T, j=1,…,k.  Здесь N – количество субъектов, Т – число последовательных моментов времени, k - количество регрессоров

        1. Модель пула (pooled regression) При отсутствии значимых различий (неоднородности) между пространственными объектами выборки $y_{it} = X_{it}b + a + e_{it}$ (python: from linearmodels.panel import *; pooled = PanelOLS(dependent=y, exog=sm.add_constant(X)).fit())
        2. Модель регрессии с фиксированным эффектом (fixed effect model) $y_{it} = X_{it}b + a_{i} + e_{it}, e_{it} \sim iid (0, \sigma^2_e)$  свободный член $a_{i}$ принимает различные значения для каждого объекта выборки. В матричном виде y = Xb + ZA + $\epsilon$ , Размерности матриц: y (NT x 1), X (NT x k), b (k x 1), Z (NT x N), A (N x 1), $\epsilon$ (NT x 1), где А -вектор констант, соответствующих детерминированным индивидуальным эффектам, а Z–блочно-диагональная матрица фиктивных переменных. (python: from linearmodels.panel import *; fixed_effects = PanelOLS(y, sm.tools.tools.add_constant(X), entity_effects=True).fit())
        3. Модель регрессии со случайным эффектом (random effect model) $y_{it} = \mu + X_{it}b + a_{i} + e_{it}$. В матричном виде $y = Xb + u$  Размерности матриц: y (NT x 1), X (NT x k), b (k x 1), u (NT x 1). Здесь $u_{it} = a_i + e_{it}$ , E(u) = 0, D(u)= $\Omega$. (python: from linearmodels.panel import *; random_effects = RandomEffects(y, sm.add_constant(X)).fit())
    keywords: []
num105:
    text: |-
        ## 105) Модель пула (Pool model)

        ```python
        from linearmodels.panel import *;
        pooled = PanelOLS(dependent=y, exog=sm.add_constant(X)).fit()
        ```

        При отсутствии значимых различий (неоднородности) между пространственными объектами выборки по панельным данным строится линейная регрессия $y_{it} = X_{it}b + a + e_{it}$ . При этом 

        $e_it \sim iid(0, \sigma^2_e)$. Модель пула получается, если собрать все данные по i и по t в одну большую регрессию с NT наблюдениями. Оценка коэффициентов производится по МНК.
    keywords: []
num106:
    text: |-
        ## 106) Модель регрессии с фиксированным эффектом (fixed effect model)

        ```python
        from linearmodels.panel import *;
        fixed_effects = PanelOLS(y, sm.tools.tools.add_constant(X), entity_effects=True).fit()
        ```

        Модель используется для описания панельных данных и имеет вид

         $y_{it} = X_{it}b + a_{i} + e_{it}, e_{it} \sim iid (0, \sigma^2_e)$ , свободный член $a_{i}$ принимает различные значения для каждого объекта выборки. 

        В матричном виде y = Xb + ZA + $\epsilon$ , Размерности матриц: y (NT x 1), X (NT x k), b (k x 1), Z (NT x N), A (N x 1), $\epsilon$ (NT x 1), (T-кол-во периодов, N-кол-во объектов, k - кол-во объясн переменных) где А -вектор констант, соответствующих детерминированным индивидуальным эффектам, а Z–блочно-диагональная матрица фиктивных переменных. Оценка коэффициентов по МНК.
    keywords: []
num107:
    text: |-
        ## 107) Модель регрессии со случайным эффектом (random effect model).

        ```python
        from linearmodels.panel import *;
        random_effects = RandomEffects(y, sm.add_constant(X)).fit()
        ```

        Модель используется для описания панельных данных и имеет вид 

        $y_{it} = \mu + X_{it}b + a_{i} + e_{it}$. 

        В матричном виде $y = Xb + u$  

        Размерности матриц: y (NT x 1), X (NT x k), b (k x 1), u (NT x 1). (T-кол-во периодов, N-кол-во объектов, k - кол-во объясн переменных ) Здесь $u_{it} = a_i + e_{it}$ , E(u) = 0, D(u)= $\Omega$. 

        В модели со случайными эффектами $а_i$ являются случайными величинами, в среднем нивелируются и их теоретические дисперсии одинаковы для всех объектов выборки и равны $\sigma^2_a$ 

        Оценка параметров по ОМНК.
    keywords: []
num108:
    text: |-
        ## 108) Тест Бройша-Пагана для панельных данных.

        Для сравнения модели со случайными эффектами со сквозной регрессией (моделью пула) используется тест Бройша-Пагана. Это критерий для проверки в рамках RE-модели(со стандартными предположениями) гипотезы о равенстве межгрупповой дисперсии ошибок нулю:
        𝐻0: $\sigma^2_a =0$– сведение к модели пула.
        Статистика критерия Бройша–Пагана
        $BP = \frac{NT}{2(T-1)}[\frac{\sum^N_{i=1}(\sum^T_{t=1}e_{it})^2}{\sum^N_{i=1}\sum^T_{t=1}e_{it}^2} - 1]^2$ 
        Здесь остатки берутся из модели пула.
        Статистика критерия Бройша–Пагана распределена по  $\chi^2(1)$. Соответственно, гипотеза H0 отвергается в пользу модели со случайными эффектами, если наблюдаемое значение статистики BP превышает критическое значение, рассчитанное по распределению $\chi^2(1)$.
    keywords: []
num109:
    text: |-
        ## 109) Тест Хаусмана для панельных данных.

        Для сравнения модели со случайными эффектами с моделью с фиксированными эффектами используется тест Хаусмана. 
        $H0: cov(a_i, X_{it}) = 0$
        Проверяется критерий
        $m = \hat{q}‘var^{-1}(\hat{q})\hat{q} \sim \chi^2_k$, $\hat{q} = \hat{\beta}_{FE} - \hat{\beta}_{RE}$
        Если остаемся в области Н0, следует пользоваться моделью RE со случайными
        эффектами. Если попадаем в критическую область, следует пользоваться моделью FE c фиксированными эффектами.
    keywords: []
num110:
    text: |-
        ## 110) Тест Лагранжа для панельных данных.

        Для сравнения модели со случайными эффектами со сквозной регрессией (моделью пула) используется тест Бройша-Пагана=Лагранжа. Это критерий для проверки в рамках RE-модели(со стандартными предположениями) гипотезы о равенстве межгрупповой дисперсии ошибок нулю:
        𝐻0: $\sigma^2_a =0$– сведение к модели пула.
        Статистика критерия Лагранжа
        $LM = \frac{NT}{2(T-1)}[\frac{\sum^N_{i=1}(\sum^T_{t=1}e_{it})^2}{\sum^N_{i=1}\sum^T_{t=1}e_{it}^2} - 1]^2$ 
        Здесь остатки берутся из модели пула.
        Статистика критерия LM распределена по  $\chi^2(1)$. Соответственно, гипотеза H0 отвергается в пользу модели со случайными эффектами, если наблюдаемое значение статистики LM превышает критическое значение, рассчитанное по распределению $\chi^2(1)$.
    keywords: []
num111:
    text: |-
        ## 111) Вычисление значения оценок параметров β и а в модели с фиксированным эффектом.

        **$y_{it} = X_{it} * \beta + a_i + \varepsilon_{it}$**

        $a_i$ принимает различные значения для каждого объекта выборки, но для каждого конкретного объекта не изменяется с течением времени t.

        В матричном виде:  $y_{it} = X* \beta + Z*A + \varepsilon$, где A-вектор констант, соответствующих детерминированным индивидуальным эффектам, а Z - блочно-диагональная матрица фикс переменных.

        Оценка $\beta$ (считаются через обычный МНК):

        $$
        \hat\beta_{LSDV} = \begin{pmatrix} X^\prime X & X^\prime Z\\Z^\prime X& Z^\prime Z\end{pmatrix} \begin{pmatrix} X^\prime Y\\Z^\prime Y\end{pmatrix}
        $$

        Модель является довольно гибкой, тк позволят учитывать индивидуальную гетерогенность объектов, но за этим следует потеря значимости оценок (из-за увеличения их стандартных ошибок).

        Другой способ получения значения оценок для $\beta$ и $\alpha$. Пусть:

        $$
        \overline{y_l} = \frac{1}{T} \Sigma^T_{t=1} y_{it}, \overline{X_l}=\frac{1}{T}\Sigma^T_{t=1} X_{it}, \overline{\varepsilon_l}=\frac{1}{T} \Sigma^T_{t=1} \varepsilon_{it}
        $$

        где под Х понимается вектор из всех факторов $𝑥_𝑘$. Те надо рассчитать средние по времени для каждого из факторов. Усредняя по времени обе части изначального уравнения, получим:

        $$
        \overline{y_l} = \overline{X_l}*\beta + \alpha_i +\overline{\varepsilon_i}, i = \overline{1, N}
        $$

        Из изначального уравнения и усредненного изначального получаем:

        $$
        y^*_{it} = X^*_{it} * \beta + \varepsilon^*_{it}, где\ y^*_{it}=y_{it} - \overline{y_l}, X^*_{it} = X_{it} - \overline{X_l}, \varepsilon^*_{it} = \varepsilon_{it} - \overline{\varepsilon_l}
        $$

        В результате - модель, скорректированная на индивидуальные средние, свободные члены оказались исключенными из уравнения. По полученному уравнению можно рассчитать параметр $\beta$. Эта оценка называется «внутригрупповой» (или «within» оценка), она строится только на основании отклонений значений переменных от их средних по времени и тем самым принимает во внимание только изменчивость в пределах каждого субъекта, не обращая внимание на изменчивость между субъектами.

        Получив параметр $\beta$, оценку $\alpha_i$ можно получить: $\alpha_i = \overline{y_l} - \overline{X_l}*\beta, i=\overline{1, N}$

        Полученные в итоге двух методов оценки совпадают численно, но имеют различные стандартные ошибки оценок $\beta$ (во втором случае ошибка меньше). Стандартные ошибки оценок $\alpha_i$, полученные вторым способом, нельзя вычислять по формулам для стандартным ошибок оценок наименьших квадратов.

        β является состоятельной оценкой и когда N → ∞ и когда T → ∞, в $α_i$  состоятельна только, когда T →∞.
    keywords: []
num112:
    text: |-
        ## 112) Отражение пространственных эффектов. Бинарная матрица граничных соседей. Приведите пример.

        Пространственные данные в эконометрике относятся к данным, которые содержат информацию о расположении объектов в пространстве. Для их анализа используются различные методы, которые позволяют учитывать пространственную зависимость между объектами. Одним методом является анализ пространственной автокорреляции (статистическая связь между значениями переменных в пространстве (если сильная — значения переменной будут более похожи для объектов, находящихся близко друг к другу, в отличие от объектов, расположенных на значительном расстоянии друг от друга)). Для расчета ее коэффициентов используется матрица пространственных весов. В зависимости от типа задачи различают: бинарная матрица граничных соседей, бинарная матрица ближайших соседей,  матрица расстояний, матрица расстояний с учетом размера объекта.

        Бинарная матрица граничных соседей:

        $$
        \begin{equation*}w_{ij} =\begin{cases}0, &\text{$i=j$}\\1, &\text{$j\ граничит\ с\ i$}\\0, &\text{$j\ не\ граничит\ с\ i$}\end{cases}\end{equation*}
        $$

        Это наиболее простой способ учета пространственных взаимосвязей. На исследуемые объекты оказывают влияние только граничные соседи. При нормализации: на территорию оказывается влияние соседних территорий с одними и теми же пространственными весами (из-за бинарности матрицы). Матрицу можно использовать, когда исследуемые территориальные системы достаточно однородны по площади.

        Пример: для некоторых областей РФ была построена бинарная матрица граничных соседей. Так для Оренбургской области нет граничных соседей, а другие две области имеют границу между собой.

                                               | Кировская обл | Нижегородская обл| Оренбургская обл

        Кировская обл           |                   0         |               1                     |              0

        Нижегородская обл |                    1         |                 0                  |               0

        Оренбургская обл    |                    0        |                  0                 |                0
    keywords: []
num113:
    text: |-
        ## 113) Отражение пространственных эффектов. Бинарная матрица ближайших соседей. Приведите пример.

        Пространственные данные в эконометрике относятся к данным, которые содержат информацию о расположении объектов в пространстве. Для их анализа используются различные методы, которые позволяют учитывать пространственную зависимость между объектами. Одним методом является анализ пространственной автокорреляции (статистическая связь между значениями переменных в пространстве (если сильная — значения переменной будут более похожи для объектов, находящихся близко друг к другу, в отличие от объектов, расположенных на значительном расстоянии друг от друга)). Для расчета ее коэффициентов используется матрица пространственных весов. В зависимости от типа задачи различают: бинарная матрица граничных соседей, бинарная матрица ближайших соседей,  матрица расстояний, матрица расстояний с учетом размера объекта.

        Бинарная матрица ближайших соседей:

        $$
        \begin{equation*}w_{ij}(k) =\begin{cases}0, &\text{$i=j$}\\1, &\text{$d_{ij} \leq d_i(k)$}\\0, &\text{$d_{ij} \gt d_i(k)$}\end{cases}\end{equation*}
        $$

        где  $d_i(k)$  - наименьшее расстояние k-го порядка между объектами i и  j.

        Для каждого объекта рассчитываются расстояния до всех остальных объектов, выбирается k наименьших расстояний, так что k-e расстояние для рассматриваемого объекта является границей отсечения. Если объекты являются соседями в таком смысле, в ячейках соответствующих строк матрицы весов ставятся единицы, иначе - нули. Обычно используются 10-25 ближ соседей (для устойчивости результатов).

        Пример: для некоторых областей РФ была построена бинарная матрица ближайших соседей. Так для Оренбургской области нет соседей в подсчитанном k-том расстоянии, а другие две области имеют границу между собой.

                                             | Кировская обл | Нижегородская обл | Оренбургская обл

        Кировская обл          |               0           |              1                       |              0

        Нижегородская обл|            1               |                 0                    |                0

        Оренбургская обл  |           0               |                 0                    |                0
    keywords: []
num114:
    text: |-
        ## 114) Отражение пространственных эффектов. Матрица расстояний. Приведите пример.

        Пространственные данные в эконометрике относятся к данным, которые содержат информацию о расположении объектов в пространстве. Для их анализа используются различные методы, которые позволяют учитывать пространственную зависимость между объектами. Одним методом является анализ пространственной автокорреляции (статистическая связь между значениями переменных в пространстве (если сильная — значения переменной будут более похожи для объектов, находящихся близко друг к другу, в отличие от объектов, расположенных на значительном расстоянии друг от друга)). Для расчета ее коэффициентов используется матрица пространственных весов. В зависимости от типа задачи различают: бинарная матрица граничных соседей, бинарная матрица ближайших соседей,  матрица расстояний, матрица расстояний с учетом размера объекта.

        Матрица расстояний:

        $$
        \begin{equation*}w_{ij}(k) =\begin{cases}0, &\text{$i=j$}\\1/d_{ij}^{\gamma}, &\text{$d_{ij} \leq D(q)$}\\0, &\text{$d_{ij} \gt D(q)$}\end{cases}\end{equation*}
        $$

        где $d_i(k)$ - расстояние между центрами объектов, D(q) - квартили расстояний, q=1,2,3,4. Коэффициент $\gamma$ обычно принимает значения от 1 до 10.

        В случае  $\gamma= 2$ (исп чаще всего) коэффициент матрицы весов представляет собой аналог коэффициента гравитации: притяжение объектов обратно пропорционально квадрату расстояния между ними ⇒ чем дальше друг от друга находятся объекты, тем меньшее влияние они оказывают друг на друга. 

        Если $q \lt 4$ ⇒ соотвествующий D(q) считается критическим расстоянием отсечения, дальше которого взаимовлияние считается несущественным. 

        Если $q=4$ ⇒ в матрице весов учитываются все расстояния (в весовой матрице нулевыми будут только элементы главной диагонали).

        Сами расстояния могут представлять собой различные меры расстояний, например:

        1) линейное расстояние

        2) расстояние по автомобильным дорогам, по железнодорожным автомагистралям, по авиационным, речным сообщениям

        3) расстояние по смежным границам (с использованием бинарных переменных 1 и 0)

        ### Пример

        Для некоторых областей РФ была построена матрица расстояний по дорогам.
                Км                               	Кировская обл 	 Нижегородская обл	 Оренбургская обл
        Кировская обл		608	1020 
        Нижегородская обл	 608 		1077
        Оренбургская обл	1020	1077
    keywords: []
num115:
    text: |-
        ## 115) Отражение пространственных эффектов. Матрица расстояний с учетом размера объекта. Приведите пример.

        Пространственные данные в эконометрике относятся к данным, которые содержат информацию о расположении объектов в пространстве. Для их анализа используются различные методы, которые позволяют учитывать пространственную зависимость между объектами. Одним методом является анализ пространственной автокорреляции (статистическая связь между значениями переменных в пространстве (если сильная — значения переменной будут более похожи для объектов, находящихся близко друг к другу, в отличие от объектов, расположенных на значительном расстоянии друг от друга)). Для расчета ее коэффициентов используется матрица пространственных весов. В зависимости от типа задачи различают: бинарная матрица граничных соседей, бинарная матрица ближайших соседей,  матрица расстояний, матрица расстояний с учетом размера объекта.

        Матрица расстояний с учетом размера объекта:

        $$
        \begin{equation*}w_{ij}(q) =\begin{cases}0, &\text{$i=j$}\\A_j/d_{ij}^{\gamma}, &\text{$d_{ij} \leq D(q)$}\\0, &\text{$d_{ij} \gt D(q)$}\end{cases}\end{equation*}
        $$

        где $A_j$ - показатель размера или мощности соседнего региона j(ВРП, численность населения и пр).

        Данный подход позволяет учесть дополнительный параметр, характеризующий каждый из объектов:

        1) его размер, площадь

        2) важность (весомость) в исследуемых процессах

        3) его уровень соц-эк развития

        ### Пример:

        Для некоторых областей РФ была построена матрица расстояний с учетом размеров объекта (в данном случае будет использована численность регионов в тыс.чел).

        | Км                                | Кировская обл  |  Нижегородская обл |  Оренбургская обл |
        | --- | --- | --- | --- |
        | Кировская обл |  | 3214 / 608 | 1963 / 1020  |
        | Нижегородская обл |  1272 / 608  |  | 1963 / 1077 |
        | Оренбургская обл | 1272 / 1020 | 3214 / 1077 |  |

        ##
    keywords: []
num116:
    text: |-
        ## 116) Алгоритм построения матрицы пространственных весов. Приведите пример.

        Алгоритм на примере субъектов РФ состоит из след шагов:

        1. Формирование пространственной матрицы (например, матрицы расстояний между административными центрами субъектов РФ ($x_{ij}$)): по линейным расстояниям; по автомобильным дорогам, железнодорожным магистралям, авиационным, речным сообщениям; по смежным границам (с использованием бинарных переменных 1 и 0).

        2. Стандартизация расстояний в матрице по строкам.

        Для строки i вычислим среднее значение расстояний между регионом и всеми другими регионами $\overline{x_i}=\frac{1}{n}\Sigma_{j \neq i}x_{ij}$ (рассчитываемый регион мы исключаем из подсчета среднего значений). Вычитаем полученное среднее значение из каждого элемента строки матрицы и делим на стандарнтное отклонение в этой строке $x_{ij}^\prime = \frac{x_{ij}-\overline{x_i}}{\sigma_i}$. Стандартизация позволяет привести все расстояния к одному масштабу и тем самым обеспечить справедливое сравнение расстояний между регионами. После стандартизации среднее значение величин $\overline{x_i} = 0$, а стандартное отклонение $\sigma_i=1$.

        3. Преобразование матрицы расстояний в относительную матрицу. Каждый элемент матрицы $X^\prime$ возводим в -1 степень, получаем матрицу V, где $v_{ij}=\frac{1}{x_{ij}^\prime}$.

        4. Формирование матрицы стандартизированных расстояний. Каждый элемент матрицы V делим на сумму всех элементов данной матрицы, получаем искомую матрицу W, где $w_{ij}=\frac{v_{ij}}{\Sigma v_{ij}}$.

        Пример: матрица стандартизированных расстояний между административными центрами субъектов РФ по автодорогам ($W_{ij}$)

        W        |   $W_{ij} = V_{ij} / V_{sum}$    | Кировская обл | Нижегородская обл | Оренбургская обл

        0,111   | Кировская обл         |   0,0000             |         0,0003                 |           0,0002

        0,014  | Нижегородская обл|    0,0002             |         0,0000                |                0,0001

        0,009 | Оренбургская обл    |   0,0002             |         0,0002                 |                0,0000
    keywords: []
num117:
    text: |-
        ## 117) Пространственная автокорреляция по методологии А. Гетиса и Дж. Орда. Недостатки методологии.

        Проверка пространственной автокорреляции позволяет установить, имеют ли наблюдения взаимосвязь с наблюдениями, сделанными в соседних территориях, и характер этой связи.

        Индекс Гетиса – Орда позволяет определить кластеризацию наблюдений с высокими или низкими значениями.

        Среднее значение индекса автокорреляции (показатель Getis-Ord): $G=\dfrac{\sum_{i=1}^n\sum_{j=1}^nW_{ij}x_ix_j}{\sum_{i=1}^n\sum_{j=1}^nx_ix_j}$

        Ожидаемое среднее значение индекса автокорреляции: $E(G)=\dfrac{\sum_{i=1}^n\sum_{j=1}^nW_{ij}}{n\cdot(n-1)}$

        Где $x_i,\ x_j$ — атрибутивные признаки для объектов 

        $W{ij}$ — пространственный вес для пары объектов

        $n$ — общее число объектов

        **Выводы:**

        $G>E(G) \Rightarrow$ Наблюдается пространственная кластеризация объектов с высокими значениями

        $G<E(G) \Rightarrow$ Наблюдается пространственная кластеризация объектов с низкими значениями

        Cтатистическая значимость: $z_G=\dfrac{G-E(G)}{\sigma(G)}$

        **Недостатки:**

        - Однородность распределения показателей социально-экономического развития по территориальным системам встречается крайне редко
        - В условиях высокой поляризованности социально-экономического развития данный метод даёт ложные результаты
    keywords: []
num118:
    text: |-
        ## 118) Пространственная автокорреляция по методологии Роберта Джири.

        Проверка пространственной автокорреляции позволяет установить, имеют ли наблюдения взаимосвязь с наблюдениями, сделанными в соседних территориях, и характер этой связи.

        Мера Джири: $C=\dfrac{n-1}{2\cdot S_0}\cdot\dfrac{\sum_i^n\sum_j^nW_{ij}\cdot(Y_i-Y_j)^2}{\sum_i^n(Y_i-\bar Y)^2}$

        Где: $S_0=\sum_i^n\sum_j^nW_{ij}$ —  сумма весов пространственной матрицы W,

        $Y$ — исследуемый признак

        $N$ — Общее число объектов

        **Выводы:**

        $0<C<1\Rightarrow$ Положительная пространственная автокорреляция

        $С=1\Rightarrow$ Пространственная автокорреляция отсутствует

        $1<C<2\Rightarrow$ Отрицательная пространственная автокорреляция

        Статистическая значимость: $z_C=\dfrac{C-E(C)}{\sigma(C)}$, где $E(C)=\dfrac{-1}{n-1}$
    keywords: []
num119:
    text: |-
        ## 119) Пространственная автокорреляция по методологии Морана П.

        Проверка пространственной автокорреляции позволяет установить, имеют ли наблюдения взаимосвязь с наблюдениями, сделанными в соседних территориях, и характер этой связи.

        Глобальный индекс пространственной автокорреляции П. Морана: $I_G=\dfrac{n}{\sum_i\sum_jW_{ij}}\cdot\dfrac{\sum_i\sum_jW_{ij}\cdot(x_i-\mu)(x_j-\mu)}{\sum_i(x_i-\mu)^2}$

        Ожидаемое среднее значение индекса: $E(I_G)=\dfrac{-1}{n-1}$

        Где: 

        $W_{ij}$ — элемент матрицы пространственных весов 

        $\mu$ — среднее значение признака

        $x_i,\ x_j$ — атрибутивные признаки для объектов

        $N$ — Общее число объектов

        **Выводы:**

        $I_G>E(I_G)\Rightarrow$ Положительная пространственная автокорреляция

        $I_G=E(I_G)\Rightarrow$ Пространственная автокорреляция отсутствует

        $I_G<E(I_G)\Rightarrow$ Отрицательная пространственная автокорреляция

        Статистическая значимость: $z_I=\dfrac{I_G-E(I_G)}{\sigma(I_G)}$
    keywords: []
num120:
    text: |-
        ## 120) Пространственная кластеризация территорий. Локальный индекс автокорреляции П. Морана (Ili)

        Локальные индексы автокорреляции П. Морана позволяют:

        - Установить полюса роста пространственных кластеров
        - Оценить силу взаимовлияния полюсов роста на другие территории
        - Оценить направление пространственной корреляции (прямая / обратная)

        Глобальный индекс пространственной автокорреляции П. Морана: $I_{Li}=n\cdot\dfrac{(x_i-\mu)\sum_jW_{ij}\cdot(x_j-\mu)}{\sum_j(x_j-\mu)^2}$

        Ожидаемое среднее значение индекса: $E(I_G)=\dfrac{-1}{n-1}$

        Где: 

        $W_{ij}$ — элемент матрицы пространственных весов 

        $\mu$ — среднее значение признака

        $x_i,\ x_j$ — атрибутивные признаки для объектов

        $N$ — Общее число объектов

        **Выводы:**

        $I_{Li}>0\Rightarrow$ Положительная пространственная автокорреляция

        $I_{Li}=0\Rightarrow$ Пространственная автокорреляция отсутствует

        $I_{Li}<0\Rightarrow$ Отрицательная пространственная автокорреляция

        $|I_{Li}|>|I_{Lj}|\Rightarrow$ Подобие/различие территории i с окружающими ее соседними территориями является бОльшим, чем в случае территории j и ее соседей.
    keywords: []
num121:
    text: |-
        ## 121) Матрица взаимовлияния Л. Анселина (LISA).

        Матрица взаимовлияния позволяет:

        - оценить тесноту взаимосвязи между исследуемыми объектами в пространстве
        - выявить направление данных взаимосвязей (прямые и обратные)

        $LISA_{ij}=Z_i\cdot Z_j\cdot W_{ij}$

        $LISA_{ij}$ — Индекс локальной автокорреляции между двумя регионами;
        $W_{ij}$ — Элемент матрицы пространственных весов для ре­гионов i и j;
        $Z_i,\ Z_j$ — Стандартизированные значения показателя региона:

        $Z_i=\dfrac{x_i-\mu}{\sqrt{\dfrac{\sum_i(x_i-\bar x)^2}{n}}}$

        В получившейся матрице следует выделить значения, превышающие среднее значение локального индекса автокорреляции. Это позволит:

        - Выявить зоны взаимовлияния полюсов роста
        - Установить территории, получающие импульс от их развития или способствующие их развитию

        - **Модель ARMA(p, q):** Это модель авторегрессионного скользящего среднего, описывающая временной ряд как линейную комбинацию его собственных прошлых значений (AR часть) и случайных ошибок (MA часть).
            - **Классический вид:**
            
            $$
            Y_t = \gamma + a_1 Y_{t-1} + a_2 Y_{t-2} + \cdots + a_p Y_{t-p} + b_1 \epsilon_{t-1} + b_2 \epsilon_{t-2} + \cdots + b_q \epsilon_{t-q}
            $$
            

        Прогнозирование временных рядов с использованием модели ARMA (AutoRegressive Moving Average) включает в себя предсказание будущих значений на основе уже имеющихся данных. Прогнозирование осуществляется путем экстраполяции временного ряда с использованием авторегрессионных и скользящих средних компонентов модели.

        ### Условия прогнозирования

        1. **Стационарность**:
            - Модель ARMA предполагает, что временной ряд стационарен. Стационарность означает, что временной ряд имеет постоянное среднее, постоянную дисперсию и постоянную автокорреляционную структуру во времени.
            - Если временной ряд не стационарен, необходимо сделать его стационарным путем дифференцирования или других преобразований перед применением модели ARMA.
        2. **Корректная спецификация модели**:
            - Выбор правильных значений параметров p и q для модели ARMA(p, q) важен для точного прогнозирования. Эти параметры определяют порядок авторегрессионного и скользящего среднего компонентов.
            - Обычно параметры модели выбираются с использованием критериев информации, таких как AIC или BIC
        3. **Оценка остатков**:
            - Остатки модели (разница между наблюдаемыми и предсказанными значениями) должны быть белым шумом, что указывает на адекватность модели. Остатки должны быть независимыми и одинаково распределенными с нулевым средним.

        ### Периоды прогнозирования

        Прогнозирование с использованием модели ARMA можно разделить на два типа в зависимости от периода прогнозирования:

        1. **Краткосрочное прогнозирование**:
            - Прогнозы на несколько шагов вперед (обычно до 10 шагов). Такие прогнозы обычно более точны, так как они основаны на последних наблюдениях и имеют меньшую неопределенность.
            - Пример: прогнозирование продаж на следующий месяц или квартал.
        2. **Долгосрочное прогнозирование**:
            - Прогнозы на много шагов вперед (более 10 шагов). Такие прогнозы менее точны из-за накопления ошибок и неопределенности.
            - Пример: прогнозирование экономических показателей на несколько лет вперед.

        ### Информативность прогнозов

        Информативность прогнозов модели ARMA зависит от нескольких факторов:

        1. **Доверительные интервалы**:
            - Важно предоставлять прогнозы вместе с доверительными интервалами, которые указывают на диапазон возможных значений и степень неопределенности прогнозов. Широкие доверительные интервалы указывают на большую неопределенность.
        2. **Визуализация прогнозов**:
            - Визуальное представление прогнозов (например, графики) помогает лучше понять будущие тенденции и оценить их достоверность.
        3. **Анализ ошибок**:
            - Оценка ошибок прогнозирования, таких как среднеквадратическая ошибка (MSE) или средняя абсолютная ошибка (MAE), помогает понять точность модели и качество прогнозов.
    keywords:
