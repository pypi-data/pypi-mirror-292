# -*- coding: utf-8 -*-
"""
Created on Fri Oct 16 17:38:11 2020

@author: giamp
"""

import numpy as np

name      = 'gamma'
startp = np.array([1.0, 1.0, 10.0, 1.0])
lb     = startp - 10.0
ub     = startp + 10.0
n      = len(lb)
nint   = 2
ncont  = n-nint
lbmix  = np.zeros(n); lbmix[:ncont] = lb[:ncont]
ubmix  = 100*np.ones(n); ubmix[:ncont] = ub[:ncont]
x_initial = 50*np.ones(n); x_initial[:ncont] = (ub[:ncont] + lb[:ncont])/2 
xmix   = np.zeros(n)

def feval(x):
    t = np.array([[1.0],
     [1.01],
     [1.0],
     [1.03],
     [1.05],
     [1.075],
     [1.1],
     [1.125],
     [1.15],
     [1.2],
     [1.25],
     [1.3],
     [1.35],
     [1.4],
     [1.5],
     [1.6],
     [1.7],
     [1.8],
     [1.9],
     [2.0],
     [2.1],
     [2.2],
     [2.3],
     [2.5],
     [2.75],
     [3.0],
     [3.25],
     [3.5],
     [4.0],
     [4.5],
     [5.0],
     [5.5],
     [6.0],
     [6.5],
     [7.0],
     [7.5],
     [8.0],
     [8.5],
     [9.0],
     [10.0],
     [11.0],
     [12.0],
     [13.0],
     [15.0],
     [17.5],
     [20.0],
     [22.5],
     [25.0],
     [30.0],
     [35.0],
     [40.0],
     [50.0],
     [60.0],
     [70.0],
     [80.0],
     [100.0],
     [150.0],
     [200.0],
     [300.0],
     [500.0],
     [1.e+5]])

    z =np.array([[0.97386702052733792831],
     [0.97390711665677071911],
     [0.97394794566286525039],
     [0.97398947529386626621],
     [0.97407451325974368215],
     [0.97418422166965892644],
     [0.97429732692565188272],
     [0.97441344289222034304],
     [0.97453221704823108216],
     [0.97477647977277153145],
     [0.97502785781178233026],
     [0.97528446418205610067],
     [0.97554472005909873148],
     [0.97580730389916439626],
     [0.97633521198091785788],
     [0.97686134356195586299],
     [0.97738094095418268249],
     [0.97789073928751194169],
     [0.97838854811088140808],
     [0.97887295363155439576],
     [0.97934310478576951385],
     [0.97979855827226762515],
     [0.98023916551033862691],
     [0.98107624468416045728],
     [0.98204290774765289406],
     [0.98292719363632655668],
     [0.98373656564197279264],
     [0.98447846610682328991],
     [0.98578713114264981186],
     [0.98690124654380846379],
     [0.98785879054855173380],
     [0.98868928566806726978],
     [0.98941568049711884384],
     [0.99005592865089067038],
     [0.99062420259214811899],
     [0.99113180018738487730],
     [0.99158781685339306121],
     [0.99199964493176098231],
     [0.99237334707422899195],
     [0.99302559755582945576],
     [0.99357562712206729735],
     [0.99404560031581354300],
     [0.99445173790980305195],
     [0.99511816085114882367],
     [0.99575584307408838284],
     [0.99624640327264396775],
     [0.99663543022201287399],
     [0.99695146031888813172],
     [0.99743367936799001685],
     [0.99778424120023198554],
     [0.99805056960591223604],
     [0.99842841443786596919],
     [0.99868358857261655169],
     [0.99886748198687248566],
     [0.99900629944600342584],
     [0.99920194660435455419],
     [0.99946519560889341627],
     [0.99959785208794891934],
     [0.99973120214935885075],
     [0.99983838442420395745],
     [0.999999189398046846077]])
 
    #    f = (x[0]*(t + x[1] + (x[2]*t + x[3])**(-1))**(t+0.5))/((t+1)*z)
    f = x[0]*((t + x[1] + (x[2]*t + x[3])**(-1))/((t+1)*z))**(t+0.5) - 1.0
    y = np.max(np.abs(f))
    #    f = (x[0]*(t + x[1] + (x[2]*t + x[3])**(-1))**(t+0.5))/(gamma(t+1)*np.exp(t)) - 1.0 #Tommaso
    return y
