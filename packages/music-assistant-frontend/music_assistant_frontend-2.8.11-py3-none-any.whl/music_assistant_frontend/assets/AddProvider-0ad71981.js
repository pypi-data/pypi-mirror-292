import{n as M}from"./index.browser-342e672c.js";import{d as B,an as N,r as g,o as S,b as n,a7 as T,a as P,N as j,c as u,g as V,f as i,w as a,u as r,Y as l,t as f,e as v,i as s,j as y}from"./index-7a6312c5.js";import{E as $}from"./EditConfig-76a2b47a.js";import{V as k,a as h,b as I}from"./VCardText-1c7d9bcc.js";import{V as U}from"./VList-64720c7d.js";import{a as D,V as O}from"./VCard-b78989b6.js";import{s as z,y as H}from"./VListItem-00c5dd98.js";import{c as L}from"./VMenu-7f3a32fb.js";import"./VExpansionPanels-dfcc805e.js";import"./VCheckboxBtn-a75ca569.js";import"./VForm-3fd2dcd7.js";import"./VTextField-3e6d8ed5.js";import"./VVirtualScroll-7a6b8896.js";import"./VSpacer-e39368bc.js";/* empty css              */import"./VDialog-10e8fbe1.js";import"./VAlert-7e63f9d7.js";import"./_plugin-vue_export-helper-c27b6911.js";const R={key:0,style:{"margin-left":"-5px","margin-right":"-5px"}},Y=s("br",null,null,-1),q=["href"],F=s("br",null,null,-1),G=s("br",null,null,-1),J=s("br",null,null,-1),K={id:"auth",href:"",target:"_blank"},ce=B({__name:"AddProvider",props:{domain:{}},setup(C){const w=N(),m=g([]),_=M(11),d=g(!1),c=g(!1),p=C;S(()=>{const e=n.subscribe(T.AUTH_SESSION,t=>{if(t.object_id!==_)return;const o=t.data;c.value=!0,window.setTimeout(()=>{const b=document.getElementById("auth");b.setAttribute("href",o),b.click()},100)});P(e)}),j(()=>p.domain,async e=>{e&&(m.value=await n.getProviderConfigEntries(p.domain,void 0,void 0,{session_id:_}))},{immediate:!0});const A=async function(e){d.value=!0,n.saveProviderConfig(p.domain,e).then(()=>{w.push({name:"providersettings"})}).catch(t=>{alert(t)}).finally(()=>{d.value=!1,c.value=!1})},E=async function(e,t){d.value=!0;for(const o of m.value)o.value!==void 0&&t[o.key]==null&&(t[o.key]=o.value);t.session_id=_,n.getProviderConfigEntries(p.domain,void 0,e,t).then(o=>{m.value=o}).catch(o=>{alert(o)}).finally(()=>{d.value=!1,c.value=!1})};return(e,t)=>(u(),V("section",null,[i(I,null,{default:a(()=>[r(n).providerManifests[e.domain]?(u(),V("div",R,[i(k,null,{default:a(()=>[l(f(e.$t("settings.setup_provider",[r(n).providerManifests[e.domain].name])),1)]),_:1}),i(h,null,{default:a(()=>[l(f(r(n).providerManifests[e.domain].description),1)]),_:1}),Y,r(n).providerManifests[e.domain].codeowners.length?(u(),v(h,{key:0},{default:a(()=>[s("b",null,f(e.$t("settings.codeowners"))+": ",1),l(f(r(n).providerManifests[e.domain].codeowners.join(" / ")),1)]),_:1})):y("",!0),r(n).providerManifests[e.domain].documentation?(u(),v(h,{key:1},{default:a(()=>[s("b",null,f(e.$t("settings.need_help_setup_provider")),1),l("Â  "),s("a",{href:r(n).providerManifests[e.domain].documentation,target:"_blank"},f(e.$t("settings.check_docs")),9,q)]),_:1})):y("",!0)])):y("",!0),F,i(U),G,J,i($,{"config-entries":m.value,disabled:!1,onSubmit:A,onAction:E},null,8,["config-entries"])]),_:1}),i(L,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=o=>d.value=o),scrim:"true",persistent:"",style:{display:"flex","align-items":"center","justify-content":"center"}},{default:a(()=>[c.value?(u(),v(O,{key:0,style:{"background-color":"white"}},{default:a(()=>[i(k,null,{default:a(()=>[l("Authenticating...")]),_:1}),i(h,null,{default:a(()=>[l("A new tab/popup should be opened where you can authenticate")]),_:1}),i(D,null,{default:a(()=>[s("a",K,[i(z,null,{default:a(()=>[l("Click here if the popup did not open")]),_:1})])]),_:1})]),_:1})):(u(),v(H,{key:1,indeterminate:"",size:"64",color:"primary"}))]),_:1},8,["modelValue"])]))}});export{ce as default};
