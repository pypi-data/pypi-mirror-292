"use strict";(self.webpackChunk_datalayer_core=self.webpackChunk_datalayer_core||[]).push([[4061],{44061:(e,t,a)=>{a.r(t),a.d(t,{CellEdit:()=>U,default:()=>E});var n=a(4565),s=a(89456),l=a(40359),r=a(17168),i=a(41237),o=a(36088),c=a(66578),u=a(83773),d=a(52333),p=a(34441),h=a(91899),m=a(78584),x=a(50969),g=a(12784),j=a(25939),y=a(79146),v=a(58783),f=a(72576),C=a.n(f),Z=a(51788);const k=()=>{const e=(0,m.qX)(),t=e.cell().cell,a=t?.outputCdnUrl||!t?.outputData?.startsWith(Z.nf);return(0,n.jsx)(n.Fragment,{children:a?(0,n.jsx)(d.r,{variant:"danger",onClick:()=>{e.cell().update({outputCdnUrl:"",outputData:Z.D_})},children:"Remove outputshot"}):(0,n.jsx)(d.r,{variant:"primary",onClick:()=>{e.layout().showBackdrop();const t=document.getElementsByClassName("jp-OutputArea")[0];C()(t).then((t=>{const a=document.createElement("canvas"),n=a.getContext("2d"),s=t.width,l=t.height;a.width=s,a.height=l,n?.drawImage(t,0,0);const r=a.toDataURL("",1);e.cell().update({outputCdnUrl:"",outputData:r})})).finally((()=>{e.layout().hideBackdrop()}))},children:"Take outputshot"})})};var b=a(51370);const T=()=>{const e=(0,m.qX)(),t=e.cell().cell;if(!t)return(0,n.jsx)(n.Fragment,{});const{updateCell:a}=(0,h.YT)(),l=(0,h.aF)(),{enqueueToast:r}=(0,h.pm)(),i=(0,v.gQ)(),o=e.layout().leftSidebarVariant,u=i.getInput("cell"),[p,x]=(0,s.useState)(!1),f=e.layout().organization,C=e.layout().space,[Z,T]=(0,s.useState)({name:t.name,description:t.description}),[$,w]=(0,s.useState)({name:!0,description:!0});return(0,s.useEffect)((()=>{w({...$,name:void 0===Z.name?void 0:Z.name.length>2,description:void 0===Z.description?void 0:Z.description.length>2})}),[Z]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(c.Z,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr"},children:[(0,n.jsxs)(c.Z,{sx:{label:{marginTop:2}},children:[(0,n.jsxs)(g.Z,{children:[(0,n.jsx)(g.Z.Label,{children:"Name"}),(0,n.jsx)(j.Z,{block:!0,value:Z.name,onChange:t=>{T((e=>({...e,name:t.target.value}))),e.cell().update({name:t.target.value})}}),!1===$.name&&(0,n.jsx)(g.Z.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,n.jsxs)(g.Z,{children:[(0,n.jsx)(g.Z.Label,{children:"Description"}),(0,n.jsx)(y.ZP,{block:!0,value:Z.description,onChange:t=>{T((e=>({...e,description:t.target.value}))),e.cell().update({description:t.target.value})}}),!1===$.description&&(0,n.jsx)(g.Z.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,n.jsxs)(g.Z,{children:[(0,n.jsx)(d.r,{variant:"primary",disabled:p||!$.name||!$.description,sx:{marginTop:2},onClick:()=>{t?.outputData.length>3e5?r(`Output screenshot is too large (actual size is ${t?.outputData.length}, the maximum allowed is 300000)`,{variant:"error"}):(e.layout().showBackdrop(),x(!0),a({id:t?.id,name:t?.name,description:t?.description,source:u,outputCdnUrl:t.outputCdnUrl,outputData:t?.outputCdnUrl?void 0:t?.outputData,accountType:"organization-space"===o?"organization":"user",accountId:"organization-space"===o?f?.id:l?.id,spaceId:C?.id}).then((a=>{if(x(!1),a.success){const a={...t,public:t?.public,description:t?.description,source:u,outputCdnUrl:t?.outputCdnUrl,outputData:t?.outputData};e.layout().triggerItemsRefresh(),e.cell().update(a),r("The cell is successfully updated.",{variant:"success"})}})).finally((()=>{e.layout().hideBackdrop(),x(!1)})))},children:p?"Saving cell...":"Save cell"}),(0,n.jsx)(k,{})]})]}),(0,n.jsx)(c.Z,{ml:5,children:(0,n.jsx)(b.Z,{cell:t})})]})})};var $=a(1990),w=a(13707);const D=e=>{switch(e.contentType){case"application/vnd.ms-excel":case"text/csv":return`# --- âœ… Load the ${e.fileName}.${e.datasetExtension} dataset (${e.mimeType})\nimport pandas as pd\n${e.fileName}_${e.datasetExtension} = pd.read_csv("${e.cdnUrl}")\n${e.fileName}_${e.datasetExtension}\n\n`;case"image/png":case"image/jpg":case"image/jpeg":return`# --- âœ… Display the ${e.fileName}.${e.datasetExtension} dataset (${e.mimeType})\nfrom IPython.display import Image\nurl = "${e.cdnUrl}"\nImage(url, width=300)\n\n`;default:return`# --- ðŸ˜ž File of type ${e.contentType} is not supported for now.\n`}},I=e=>{const{source:t,outputshotRef:a}=e,{defaultKernel:s}=(0,$.W$)();return s?(0,n.jsx)("div",{ref:a,style:{marginTop:"8px"},children:(0,n.jsx)(w.r,{showEditor:!0,autoRun:!0,kernel:s,code:t,id:"cell",insertText:D})}):(0,n.jsx)(n.Fragment,{})},U=()=>{const{cellId:e}=(0,r.UO)();if(!e)return(0,n.jsx)(n.Fragment,{});const t=(0,h.aF)(),a=(0,m.qX)(),g=(a.layout().organization,a.layout().space),j=a.cell().cell,y=(0,i.N)(),v=(0,h.s0)(),{enqueueToast:f}=(0,h.pm)(),{getCell:C,refreshCell:Z,cloneCell:k}=(0,h.YT)(),[b,$]=(0,s.useState)(),[w,D]=(0,s.useState)(!1),U=(0,s.useMemo)((()=>(0,s.createRef)()),[]);(0,s.useEffect)((()=>{const t=document.getElementById("right-panel-id"),s=(0,l.createPortal)((0,n.jsx)(x.Z,{}),t);return a.layout().setRightPortal({portal:s,pinned:!1}),Z(e).then((t=>{if(t.success){const t=C(e);t?($(t.source),a.cell().update(t),a.layout().setItem(t),$(t.source)):v("/")}})),()=>{a.layout().setItem(void 0)}}),[e]);const E=(0,s.useCallback)((async n=>{y({title:"Are you sure?",content:"Please confirm you want to clone this cell in your private library."}).then((n=>{n&&k(e).then((e=>{e.success&&(f(e.message,{variant:"success"}),a.layout().triggerItemsRefresh(),v(`/${t?.handle}/library/cells`))}))}))}),[y,j]);return(0,n.jsx)(n.Fragment,{children:j&&b&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.Z,{children:(0,n.jsxs)(c.Z,{display:"flex",children:[(0,n.jsx)(c.Z,{flex:1,children:(0,n.jsx)(u.Z,{sx:{fontSize:3},children:"Cell editor"})}),(0,n.jsx)(c.Z,{children:w?(0,n.jsx)(d.r,{variant:"invisible",size:"small",onClick:()=>D(!1),children:"Hide details"}):(0,n.jsx)(d.r,{variant:"invisible",size:"small",onClick:()=>D(!0),children:"Show details"})}),(0,n.jsx)(c.Z,{ml:1,children:t&&g&&(0,n.jsx)(d.r,{variant:"invisible",size:"small",leadingVisual:p.jcu,onClick:E,children:"Clone"})})]})}),(0,n.jsxs)(c.Z,{children:[w&&(0,n.jsx)(c.Z,{children:(0,n.jsx)(T,{})}),(0,n.jsx)(c.Z,{children:(0,n.jsx)(I,{source:b,outputshotRef:U,cellId:j?.id})})]})]})})},E=U}}]);