import{d as U,V as F}from"./index-sGwfp0Vf.js";import{aa as V,_ as N,b as G,Z as J,G as h,o as d,c as k,w as a,a as o,I as L,R as r,t as c,f as g,Q as x,J as D,e as Q}from"./index-BAZgbal1.js";import{_ as S}from"./MenuItems-CMNoDCEg.js";import{V as R,a as Z}from"./VToolbar-7dK0ghH-.js";import{V as E}from"./VMenu-lrmWHp5u.js";import{h as M,i as q}from"./index-2vnC8Vie.js";import{V as H}from"./forwardRefs-CjMRaIA6.js";import{V as K}from"./VSpacer-DMaQhIUp.js";import{V as W}from"./VTextField-B1aixe0Y.js";import{V as $}from"./VChip-CTOpyymj.js";import{c as X}from"./VCard-DNO-zK2P.js";import"./VDataTable-C0eQeH3V.js";import"./tag-cARXM09U.js";import"./dimensions-BvonjXC6.js";import"./VSelect-2dOoZxQo.js";import"./VAvatar-DuybK5Si.js";import"./filter-G89ZZbTZ.js";import"./ssrBoot-CWMlusa3.js";/* empty css              */const v="alarms",A={getAll(i){return V.get(`${v}/`,{params:i})},switchStatus(i,e){return V.patch(`${v}/${i}/switch/`,e)},delete(i){return V.delete(`${v}/${i}/`)},bulkDelete(i){return V.delete(`${v}/bulk_delete/`,{params:{ids:i}})}},Y=1,ee=2,y={ALARM_OPENED:Y,ALARM_CLOSED:ee},te={class:"text-right"},ae={__name:"AlarmList",setup(i){const{$gettext:e}=G(),u=J(),w=h([]),b=h(!1),p=h(""),f=h([]),C=h(0),O=[{title:e("Triggered"),key:"created"},{title:e("Status"),key:"status"},{title:e("Domain"),key:"domain.name",sortable:!1},{title:e("Mailbox"),key:"mailbox",sortable:!1},{title:e("Message"),key:"title"},{title:e("Actions"),key:"actions",sortable:!1,align:"right"}];function T(){const l=[];return f.value.length>0&&l.push({label:e("Delete"),icon:"mdi-delete-outline",onClick:P,color:"red"}),l.push({label:e("Reload"),icon:"mdi-reload",onClick:n}),l}function I(l){const s=[];return s.push({label:e("Delete"),icon:"mdi-delete-outline",onClick:z,color:"red"}),l.status===y.ALARM_OPENED?s.push({label:e("Close alarm"),icon:"mdi-check",onClick:B,color:"green"}):s.push({label:e("Reopen alarm"),icon:"mdi-alert-circle-outline",onClick:j,color:"orange"}),s}function n({page:l,itemsPerPage:s,sortBy:t}){const _={page:l||1,page_size:s||10};t&&t.length&&(_.ordering=t.map(m=>m.order!=="asc"?`-${m.key}`:m.key).join(",")),p.value!==""&&(_.search=p.value),b.value=!0,A.getAll(_).then(m=>{w.value=m.data.results,C.value=m.data.count,b.value=!1})}async function z(l,s=!0){A.delete(l.id).then(()=>{s&&(u.displayNotification({msg:e("Alarm deleted")}),n({}))})}async function P(){await A.bulkDelete(f.value.map(l=>l.id)),u.displayNotification({msg:e("Alarms deleted")}),f.value=[],n({})}async function B(l){A.switchStatus(l.id,{status:y.ALARM_CLOSED}).then(()=>{u.displayNotification({msg:e("Alarm closed")}),n({})})}async function j(l){A.switchStatus(l.id,{status:y.ALARM_OPENED}).then(()=>{u.displayNotification({msg:e("Alarm re-opened")}),n({})})}return n=U(n,500),(l,s)=>(d(),k(X,{class:"mt-6"},{default:a(()=>[o(F,{modelValue:f.value,"onUpdate:modelValue":s[1]||(s[1]=t=>f.value=t),headers:O,items:w.value,search:p.value,"item-value":"id","items-length":C.value,loading:b.value,elevation:"0","show-select":"","onUpdate:options":n},{top:a(()=>[o(R,{color:"white",flat:""},{default:a(()=>[o(E,{location:"bottom"},{activator:a(({props:t})=>[o(M,L(t,{size:"small"}),{default:a(()=>[r(c(g(e)("Actions"))+" ",1),o(q,{right:""},{default:a(()=>[r("mdi-chevron-down")]),_:1})]),_:2},1040)]),default:a(()=>[o(H,{density:"compact"},{default:a(()=>[o(g(S),{items:T()},null,8,["items"])]),_:1})]),_:1}),o(K),o(W,{modelValue:p.value,"onUpdate:modelValue":s[0]||(s[0]=t=>p.value=t),"prepend-inner-icon":"mdi-magnify",placeholder:"Search",density:"compact",variant:"outlined","hide-details":"",flat:"","single-line":""},null,8,["modelValue"])]),_:1})]),"item.status":a(({item:t})=>[t.status===1?(d(),k($,{key:0,color:"warning",size:"small"},{default:a(()=>[r(c(g(e)("Opened")),1)]),_:1})):(d(),k($,{key:1,color:"info",size:"small"},{default:a(()=>[r(c(g(e)("Closed")),1)]),_:1}))]),"item.mailbox":a(({item:t})=>[t.mailbox?(d(),x(D,{key:0},[r(c(t.mailbox.address)+"@"+c(t.domain.name),1)],64)):(d(),x(D,{key:1},[r(" / ")],64))]),"item.created":a(({item:t})=>[r(c(l.$date(t.created)),1)]),"item.actions":a(({item:t})=>[Q("div",te,[o(E,{location:"bottom"},{activator:a(({props:_})=>[o(M,L({icon:"mdi-dots-horizontal"},_,{variant:"text"}),null,16)]),default:a(()=>[o(g(S),{items:I(t),obj:t},null,8,["items","obj"])]),_:2},1024)])]),_:2},1032,["modelValue","items","search","items-length","loading"])]),_:1}))}},le=N(ae,[["__scopeId","data-v-4c01bec3"]]),oe={__name:"AlarmsView",setup(i){return(e,u)=>(d(),x(D,null,[o(R,{flat:""},{default:a(()=>[o(Z,null,{default:a(()=>[r(c(e.$gettext("Opened alarms")),1)]),_:1})]),_:1}),o(le)],64))}},xe=N(oe,[["__scopeId","data-v-d7e4ea18"]]);export{xe as default};
