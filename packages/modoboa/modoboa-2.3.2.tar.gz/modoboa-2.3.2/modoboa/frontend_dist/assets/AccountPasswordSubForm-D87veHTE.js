import{b as B,Z as S,i as b,o as i,Q as m,J as v,e as V,t as y,f as l,a as t,S as c,w as u,c as A,a9 as E,aK as R}from"./index-BAZgbal1.js";import{r as p}from"./VForm-CMLbYr8a.js";import{V as w}from"./VTextField-B1aixe0Y.js";import{V as P,a as q}from"./VRow-B9t19ukL.js";import{V as N}from"./VSwitch-gbuBfPzI.js";import{V as U}from"./VAlert-hKmdjX4d.js";import{h as j}from"./index-2vnC8Vie.js";const F={class:"m-label"},O={class:"text-white mr-4"},Q={__name:"AccountPasswordSubForm",props:{modelValue:{type:Object,default:null},withPasswordCheck:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},editing:{type:Boolean,default:!1},formErrors:{type:Object,required:!1,default:()=>{}}},setup(a){const{$gettext:o}=B(),g=S(),n=a,e=b(()=>n.modelValue),f=b(()=>!n.disabled&&(!n.editing||e.value.password)),k=d=>d===e.value.password||o("Password mismatch");function h(){navigator.clipboard.writeText(e.value.password).then(()=>{g.displayNotification({msg:o("Password copied to clipboard")})})}function x(d){d?E.getRandomPassword().then(s=>{e.value.password=s.data.password}):(e.value.password=null,e.value.password_confirmation=null)}async function C(d){return d?R.checkPassword(d).then(()=>!0).catch(()=>o("Invalid password")):!0}return(d,s)=>(i(),m("div",null,[a.withPasswordCheck?(i(),m(v,{key:0},[V("label",F,y(l(o)("Current password")),1),t(w,{modelValue:e.value.currentPassword,"onUpdate:modelValue":s[0]||(s[0]=r=>e.value.currentPassword=r),autocomplete:"new-password",variant:"outlined",type:"password",density:"compact","validate-on":"submit",rules:a.disabled?[]:[l(p).required,C],disabled:a.disabled},null,8,["modelValue","rules","disabled"])],64)):c("",!0),t(q,{justify:"center"},{default:u(()=>[t(P,{cols:"auto"},{default:u(()=>[t(N,{modelValue:e.value.random_password,"onUpdate:modelValue":[s[1]||(s[1]=r=>e.value.random_password=r),x],label:l(o)("Random password"),density:"compact",color:"primary",class:"text-center",disabled:a.disabled},null,8,["modelValue","label","disabled"])]),_:1}),t(P,null,{default:u(()=>[e.value.random_password?(i(),A(U,{key:0,style:{"background-color":"#515d78"},class:"ml-6",density:"compact"},{default:u(()=>[V("span",O,y(e.value.password),1),t(j,{size:"small",color:"white",variant:"text",density:"compact",disabled:a.disabled,icon:"mdi-clipboard-multiple-outline",title:l(o)("Copy to clipboard"),onClick:h},null,8,["disabled","title"])]),_:1})):c("",!0)]),_:1})]),_:1}),e.value.random_password?c("",!0):(i(),m(v,{key:1},[t(w,{modelValue:e.value.password,"onUpdate:modelValue":s[2]||(s[2]=r=>e.value.password=r),variant:"outlined",label:l(o)("Password"),type:"password",autocomplete:"new-password",density:"compact",disabled:a.disabled,rules:f.value?[l(p).required]:[]},null,8,["modelValue","label","disabled","rules"]),t(w,{modelValue:e.value.password_confirmation,"onUpdate:modelValue":s[3]||(s[3]=r=>e.value.password_confirmation=r),variant:"outlined",type:"password",label:l(o)("Confirmation"),density:"compact",disabled:a.disabled,rules:f.value?[l(p).required,k]:[],"error-messages":a.formErrors&&a.formErrors.value?a.formErrors.value.password:[]},null,8,["modelValue","label","disabled","rules","error-messages"])],64))]))}};export{Q as _};
