import{_ as A,b as I,Z as z,M as G,L,G as m,i as B,k as C,o as s,Q as n,a as u,w as i,R as U,t as h,J as c,U as y,c as p,P as M,S as R,e as W}from"./index-BAZgbal1.js";import{p as g}from"./parameters-DfOTof2l.js";import{V as j,a as D}from"./VToolbar-7dK0ghH-.js";import{V as J,a as O,b as Q,c as Z}from"./VTabs-BlfiARVt.js";import{h as $}from"./index-2vnC8Vie.js";import{V as q}from"./VContainer-CpoaXVwO.js";import{c as H,a as K}from"./VCard-DNO-zK2P.js";import{V as X}from"./VSwitch-gbuBfPzI.js";import{V as Y}from"./VSelect-2dOoZxQo.js";import{V as ee}from"./VTextField-B1aixe0Y.js";import"./tag-cARXM09U.js";import"./forwardRefs-CjMRaIA6.js";import"./ssrBoot-CWMlusa3.js";import"./dimensions-BvonjXC6.js";import"./VAvatar-DuybK5Si.js";import"./VWindowItem-CZOsIkmI.js";import"./VChip-CTOpyymj.js";import"./VMenu-lrmWHp5u.js";/* empty css              */const te={key:0},ae={class:"m-label"},le={__name:"ParametersView",setup(oe){const{$gettext:_}=I(),w=z(),f=G(),P=L(),v=m(0),V=m([]),r=m({}),d=m({}),k=m(""),b=m([]),x=B(()=>V.value.filter(l=>T(l))),F=B(()=>_("Settings: "+k.value));function S(l){g.getApplicationStructure(l).then(t=>{V.value=t.data}),g.getApplication(l).then(t=>{r.value=t.data.params,k.value=t.data.label})}function T(l){if(l.display==="")return!0;let t=!0;return l.display.split("&").forEach(a=>{let[e,o]=a.split("=");(o==="true"||o==="false")&&(o=!!o),t&=r.value[e]===o}),t}function E(l){return l.filter(t=>T(t))}async function N(){d.value={},b.value=[],g.saveApplication(f.params.app,r.value).then(()=>{w.displayNotification({msg:_("Parameters updated")}),f.params.app==="imap_migration"&&(P.imapMigrationEnabled=r.value.enabled_imapmigration)}).catch(l=>{w.displayNotification({msg:_("Could not save parameters"),type:"error"}),d.value=l.response.data,Object.keys(d.value).forEach(t=>{for(let a=0;a<V.value.length;a++)V.value[a].parameters.filter(o=>o.name===t).length>0&&b.value.push(a)})})}return C(f,l=>{S(l.params.app)}),C(r,()=>{b.value=[]}),S(f.params.app),(l,t)=>(s(),n("div",null,[u(j,{flat:""},{default:i(()=>[u(D,null,{default:i(()=>[U(h(F.value),1)]),_:1})]),_:1}),u(J,{modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=a=>v.value=a),"bg-color":"white"},{default:i(()=>[(s(!0),n(c,null,y(x.value,(a,e)=>(s(),p(Q,{key:e,color:"primary",class:M(b.value.includes(e)?"error_tab":"")},{default:i(()=>[U(h(a.label),1)]),_:2},1032,["class"]))),128))]),_:1},8,["modelValue"]),u(O,{modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=a=>v.value=a)},{default:i(()=>[(s(!0),n(c,null,y(x.value,a=>(s(),p(Z,{key:a.label},{default:i(()=>[u(q,{fluid:"",class:"pa-0"},{default:i(()=>[u(H,null,{default:i(()=>[u(K,null,{default:i(()=>[(s(!0),n(c,null,y(E(a.parameters),e=>(s(),n("div",{key:e.name,class:"my-4"},[e.widget==="SeparatorField"?(s(),n("h2",te,h(e.label),1)):e.widget==="BooleanField"?(s(),n(c,{key:1},[e.widget==="BooleanField"?(s(),p(X,{key:0,modelValue:r.value[e.name],"onUpdate:modelValue":o=>r.value[e.name]=o,label:e.label,hint:e.help_text,error:d.value[e.name]!==void 0,color:"primary",density:"compact","error-messages":d.value[e.name],"persistent-hint":""},null,8,["modelValue","onUpdate:modelValue","label","hint","error","error-messages"])):R("",!0)],64)):(s(),n(c,{key:2},[W("label",ae,h(e.label),1),e.widget==="ChoiceField"?(s(),p(Y,{key:0,modelValue:r.value[e.name],"onUpdate:modelValue":o=>r.value[e.name]=o,items:e.choices,"item-title":"text",hint:e.help_text,"persistent-hint":"",density:"compact",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","items","hint"])):(s(),p(ee,{key:1,modelValue:r.value[e.name],"onUpdate:modelValue":o=>r.value[e.name]=o,hint:e.help_text,"persistent-hint":"",error:d.value[e.name]!==void 0,"error-messages":d.value[e.name],type:e.widget==="PasswordField"?"password":"text",density:"compact",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","hint","error","error-messages","type"]))],64))]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"]),u($,{icon:"mdi-content-save",class:"ma-5",position:"fixed",location:"bottom right",color:"green",size:"large",onClick:N})]))}},xe=A(le,[["__scopeId","data-v-f74bd599"]]);export{xe as default};
