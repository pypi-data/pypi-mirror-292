[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.hatch.build.targets.wheel]
packages = ["src/qoa4ml"]

[project]
name = "qoa4ml"
version = "0.2.12"
description = "Quality of Analysis for Machine Learning"
readme = "README.md"

authors = [
  { name = "AaltoSEA", email = "tri.m.nguyen@aalto.fi" },
  { name = "nguu0123", email = "nguu0123@gmail.com" },
]
license = { text = "Apache-2.0" }
keywords = ["Monitoring", "Machine Learning"]
homepage = "https://rdsea.github.io/"
repository = "https://github.com/rdsea/QoA4ML"
documentation = "https://rdsea.github.io/QoA4ML/"
classifiers = [
  "License :: OSI Approved :: Apache Software License",
  "Development Status :: 3 - Alpha",
  "Programming Language :: Python :: 3.10",
]

dependencies = [
  "pika>=1.3.2",
  "psutil>=5.9.2",
  "PyYAML>=6.0.1",
  "requests>=2.31.0",
  "fastapi>=0.110.2",
  "flatten_dict>=0.4.2",
  "pydantic>=2.7.4,<2.8",
  "tinyflux>=1.0.0",
  "uvicorn>=0.29.0",
  "lazy-import>=0.2.2",
  "confluent-kafka>=2.4.0",
  "docker==7.1.0",
  "numpy>=1.23.5",
  "pandas>=1.4.3",
]

optional-dependencies.ml = [
  "paho-mqtt==1.6.1",
  "Pillow==10.0.0",
  "prometheus-client==0.16.0",
  "tensorflow>=2.16.0",
  # "ydata-quality==0.1.0",
]

optional-dependencies.otel = [
  "opentelemetry-api>=1.26.0",
  "opentelemetry-sdk>=1.26.0",
  "opentelemetry-instrumentation-system-metrics>=0.47b0",
]

[tool.rye]
dev-dependencies = [
  "mkdocs-material",
  "pre-commit",
  "devtools",
  "ruff",
  "codespell",
  "pip>=24.2",
]
managed = true


[tool.ruff.lint]
exclude = ["src/qoa4ml/utils/pynvml_forked.py"]
select = [
  "F",   # Pyflakes
  "E",   # Pycode styles
  "W",   # Pycode styles
  "N",   # Pep8 naming
  "I",   # Isort
  "UP",  # Pyupgrade
  "C4",  # Flake8 comprehension
  "ISC", # Flake8 implicit str concat
  "B",   # Flake8 bugbear
  "PGH", # Pygrep hook
  "RUF", # Ruff specific rules
]
ignore = [
  "E501",   # Line too long
  "RET504", # Unnecessary assignment
  "RET505", # Unnecessary else after return
  "C901",   # Too complex function
  "B904",   # raise-without-from-inside-except, enable when understand more
  "PLR",
  "ISC001",
]

[tool.rye.lint.pylint]
max-args = 10
