"use strict";(self.webpackChunk_educational_technology_collective_etc_jupyterlab_nbgrader_validate=self.webpackChunk_educational_technology_collective_etc_jupyterlab_nbgrader_validate||[]).push([[763],{763:(e,t,n)=>{n.r(t),n.d(t,{IValidateButtonExtension:()=>u,ValidateButtonExtension:()=>v,default:()=>p});var a=n(717),o=n(882),i=n(930),r=n(586),l=n(770),s=n(281),c=n(663);const d="@educational-technology-collective/etc_jupyterlab_nbgrader_validate:plugin",u=new i.Token(d);class v{constructor(e){this.pioneer=e}createNew(e,t){const n=new r.ToolbarButton({className:"validate-button",label:"Validate",onClick:async()=>{var t,n,a;await e.revealed,await this.pioneer.loadExporters(e);try{null===(t=this.pioneer.exporters)||void 0===t||t.forEach((async t=>{await this.pioneer.publishEvent(e,{eventName:"validate_button_clicked",eventTime:Date.now(),eventInfo:{}},t,!0)}));const i=document.getElementsByClassName("validate-button")[0];i.firstElementChild.textContent="Validating...";const l={name:e.context.path};let d;try{d=await async function(e="",t={}){const n=c.ServerConnection.makeSettings(),a=s.URLExt.join(n.baseUrl,"jupyterlab-nbgrader-validate",e);let o;try{o=await c.ServerConnection.makeRequest(a,t,n)}catch(e){throw new c.ServerConnection.NetworkError(e)}let i=await o.text();if(i.length>0)try{i=JSON.parse(i)}catch(e){console.log("Not a JSON response body.",o)}if(!o.ok)throw new c.ServerConnection.ResponseError(o,i.message||i);return i}("validate",{body:JSON.stringify(l),method:"POST"}),console.log(d)}catch(e){throw new Error(`Error on POST /jupyterlab-nbgrader-validate/validate ${l}.\n${e}`)}finally{i.firstElementChild.textContent="Validate"}const u=document.createElement("div"),v=document.createElement("pre");v.innerText=d.output,u.appendChild(v),null===(n=this.pioneer.exporters)||void 0===n||n.forEach((async t=>{await this.pioneer.publishEvent(e,{eventName:"validation_results_displayed",eventTime:Date.now(),eventInfo:{message:null==d?void 0:d.output}},t,!0)}));const p=await(0,r.showDialog)({title:"Validation Results",body:new o.Widget({node:u}),buttons:[r.Dialog.okButton()]});null===(a=this.pioneer.exporters)||void 0===a||a.forEach((async t=>{await this.pioneer.publishEvent(e,{eventName:"validation_results_dismissed",eventTime:Date.now(),eventInfo:{message:p}},t,!0)}))}catch(e){console.error(e)}},tooltip:"Validate"});return e.toolbar.insertItem(10,"validateNotebook",n),new a.DisposableDelegate((()=>{n.dispose()}))}}const p={id:d,provides:u,requires:[l.IJupyterLabPioneer],autoStart:!0,activate:(e,t)=>{const n=new v(t);return e.docRegistry.addWidgetExtension("Notebook",n),n}}}}]);