(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3cb4005a"],{"60da":function(t,i,e){"use strict";var a=e("83ab"),n=e("d039"),r=e("df75"),o=e("7418"),l=e("d1e7"),s=e("7b0b"),c=e("44ad"),p=Object.assign,u=Object.defineProperty;t.exports=!p||n((function(){if(a&&1!==p({b:1},p(u({},"a",{enumerable:!0,get:function(){u(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},i={},e=Symbol(),n="abcdefghijklmnopqrst";return t[e]=7,n.split("").forEach((function(t){i[t]=t})),7!=p({},t)[e]||r(p({},i)).join("")!=n}))?function(t,i){var e=s(t),n=arguments.length,p=1,u=o.f,f=l.f;while(n>p){var h,g=c(arguments[p++]),d=u?r(g).concat(u(g)):r(g),m=d.length,v=0;while(m>v)h=d[v++],a&&!f.call(g,h)||(e[h]=g[h])}return e}:p},"81d5":function(t,i,e){"use strict";var a=e("7b0b"),n=e("23cb"),r=e("50c4");t.exports=function(t){var i=a(this),e=r(i.length),o=arguments.length,l=n(o>1?arguments[1]:void 0,e),s=o>2?arguments[2]:void 0,c=void 0===s?e:n(s,e);while(c>l)i[l++]=t;return i}},9485:function(t,i,e){t.exports=e.p+"static/img/nodata.8290bed9.png"},b218:function(t,i,e){},c6c6:function(t,i,e){"use strict";e("b218")},cb29:function(t,i,e){var a=e("23e7"),n=e("81d5"),r=e("44d2");a({target:"Array",proto:!0},{fill:n}),r("fill")},cca6:function(t,i,e){var a=e("23e7"),n=e("60da");a({target:"Object",stat:!0,forced:Object.assign!==n},{assign:n})},d2cb:function(t,i,e){"use strict";e.r(i);var a=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{staticClass:"cl-cluster"},[a("div",{staticClass:"cl-cluster-bk"},[a("div",{staticClass:"profiling-content-title"},[t._v(" "+t._s(t.$t("profilingCluster.clusterStepView"))+" "),t.tips.length?a("el-tooltip",{staticClass:"item",attrs:{effect:"light",placement:"top-start"}},[a("div",{staticClass:"step-trace-tooltip-contain",attrs:{slot:"content"},slot:"content"},t._l(t.tips,(function(i,e){return a("div",{key:e,staticClass:"step-trace-tooltip-contain-item"},[a("span",{staticClass:"label"},[t._v(t._s(i.label))]),t._v(" "+t._s(i.value)+" ")])})),0),a("i",{staticClass:"el-icon-info"})]):t._e()],1),a("div",{staticClass:"cl-step-filter"},[a("label",[t._v(t._s(t.stepTip))]),a("el-input",{staticClass:"step-input",attrs:{clearable:""},on:{clear:t.viewStepFilter},model:{value:t.step.showStep,callback:function(i){t.$set(t.step,"showStep",t._n(i))},expression:"step.showStep"}}),a("el-button",{on:{click:t.viewStepFilter}},[t._v(t._s(t.$t("public.sure")))]),t.stageShow?a("span",[a("label",[t._v(t._s(t.stageTip))]),a("el-select",{on:{change:function(i){return t.queryStepTraceInfo(!0)}},model:{value:t.stageId,callback:function(i){t.stageId=i},expression:"stageId"}},t._l(t.stageArr,(function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1):t._e()],1),a("div",{ref:"clusterChart",staticClass:"cl-cluster-chart"}),a("div",{staticClass:"cl-cluster-table"},[a("el-table",{ref:"table",attrs:{data:t.tableData,height:"100%",width:"100%",stripe:""},on:{"sort-change":t.tableSortChange}},[a("el-table-column",{attrs:{width:"120",prop:"rank_id",label:t.$t("profilingCluster.rankID")}}),t._l(t.cols,(function(i){return[a("el-table-column",{key:i,attrs:{prop:i,sortable:"custom"}},[a("template",{slot:"header"},[a("div",{staticClass:"col-name",attrs:{title:t.getHeaderField(i)+"(ms)"}},[t._v(t._s(t.getHeaderField(i))+"(ms)")])])],2)]})),a("el-table-column",{attrs:{fixed:"right",width:"180"},scopedSlots:t._u([{key:"default",fn:function(i){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.viewProfilingDetail(i.row)}}},[t._v(t._s(t.$t("profiling.viewDetail")))])]}}])},[a("template",{slot:"header"},[t._v(" "+t._s(t.$t("summaryManage.operation"))+" ")])],2)],2)],1),a("div",{staticClass:"cl-cluster-page"},[a("el-pagination",{attrs:{"page-sizes":t.pageSizes,"page-size":t.group_condition.limit,"current-page":t.group_condition.offset+1,layout:"total,sizes,prev,pager,next,jumper",total:t.totalCount},on:{"current-change":t.currentPageChange,"size-change":t.currentPageSizeChange}})],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.chartData.length,expression:"!chartData.length"}],staticClass:"no-data-img"},[a("div",[a("img",{attrs:{src:e("9485"),alt:""}}),a("p",[t._v(t._s(t.initOver?t.$t("public.noData"):t.$t("public.dataLoading")))])])])])},n=[],r=(e("99af"),e("cb29"),e("d81d"),e("fb6a"),e("cca6"),e("d3b7"),e("ac1f"),e("00b4"),e("5319"),e("159b"),e("9fac")),o=e("3778"),l={data:function(){return{trainInfo:{id:this.$route.query.id,path:this.$route.query.path,dir:this.$route.query.dir},chartObj:null,chartData:[],chartOption:{tooltip:{trigger:"axis",axisPointer:{type:"shadow"},confine:!0},legend:{right:70,top:8,data:""},grid:{top:35,left:80,right:80},dataset:{},xAxis:{name:this.$t("profilingCluster.rankID"),nameTextStyle:{align:"left",padding:[0,5]},type:"category"},yAxis:{name:this.$t("profilingCluster.timeTitle"),nameGap:20,nameTextStyle:{align:"right",padding:[0,5]},splitLine:{lineStyle:{width:1,type:"dashed"}}},series:[],dataZoom:[]},chartResizeTimer:null,tableData:[],initOver:!1,pageSizes:[10,20,50],group_condition:{offset:0,limit:10},sort_condition:{},totalCount:0,step:{maxStep:"",filterStep:"",showStep:""},stepTip:this.$t("profiling.stepInputTip"),cols:[],stageId:"",stageArr:[],stageTip:this.$t("profiling.stageTip"),tips:[],stageShow:!1}},mounted:function(){var t=this.trainInfo.id;if(!t)return this.$message.error(this.$t("trainingDashboard.invalidId")),void(this.initOver=!0);document.title=(t?t+"-":"")+"".concat(this.$t("profilingCluster.clusterView"),"-MindInsight"),window.addEventListener("resize",this.resizeCallback,!1),this.$bus.$on("collapse",this.resizeCallback),this.queryStepTraceInfo(!0)},destroyed:function(){window.removeEventListener("resize",this.resizeCallback),this.$bus.$off("collapse",this.resizeCallback),this.chartResizeTimer&&(clearTimeout(this.chartResizeTimer),this.chartResizeTimer=null)},methods:{getHeaderField:function(t){var i={iteration_interval:this.$t("profiling.iterationGapTime"),fp_and_bp:this.$t("profiling.fpBpTime"),tail:this.$t("profiling.tailTime"),communication_alone:this.$t("profilingCluster.communicationAloneTime"),computation:this.$t("profilingCluster.computationTime"),receive_alone:this.$t("profilingCluster.receiveAloneTime"),stage:this.$t("profilingCluster.stageTime"),collective_communication_alone:this.$t("profilingCluster.collectiveCommunicationAlone")};return i[t]},queryStepTraceInfo:function(t){var i=this,e={params:{train_id:this.trainInfo.id},body:{filter_condition:{}}};this.sort_condition.type&&(e.body.sort_condition=this.sort_condition),t||(e.body.group_condition=this.group_condition),""!==this.step.filterStep&&(e.body.filter_condition.step_id=this.step.filterStep),""!==this.stageId&&this.stageId!==this.$t("debugger.all")&&(e.body.filter_condition.stage_id=this.stageId),o["a"].getClusterInfo(e).then((function(e){if(e&&e.data&&e.data.info&&e.data.info.length){i.initOver=!0,i.step.maxStep=e.data.total_step_num,i.stepTip=i.$t("profiling.stepInputTip",{max:i.step.maxStep}),i.totalCount=e.data.size,i.stageArr=new Array(e.data.stage_num).fill().map((function(t,i){return i+1})),i.stageArr.length>1&&i.stageArr.unshift(i.$t("debugger.all")),i.stageId||(i.stageId=i.stageArr[0]);var a=[],n=e.data["parallel-mode"];i.stageShow="pipeline-parallel"==n;var r={"data-parallel":{model:"step_trace_info",dimensions:[i.$t("profilingCluster.rankID"),i.$t("profiling.iterationGapTime"),i.$t("profiling.fpBpTime"),i.$t("profiling.tailTime")],cols:["iteration_interval","fp_and_bp","tail"],tips:[{label:i.$t("profiling.iterationGapTime"),value:i.$t("profilingCluster.iterationGapTimeTip")},{label:i.$t("profiling.fpBpTime"),value:i.$t("profilingCluster.fpBpTimeTip")},{label:i.$t("profiling.tailTime"),value:i.$t("profilingCluster.tailTimeTip")}]},"model-parallel":{model:"step_bottleneck_info",dimensions:[i.$t("profilingCluster.rankID"),i.$t("profiling.iterationGapTime"),i.$t("profilingCluster.computationTime"),i.$t("profilingCluster.communicationAloneTime")],cols:["iteration_interval","computation","communication_alone"],tips:[{label:i.$t("profiling.iterationGapTime"),value:i.$t("profilingCluster.iterationGapTimeTip")},{label:i.$t("profilingCluster.communicationAloneTime"),value:i.$t("profilingCluster.communicationAloneTimeTip")},{label:i.$t("profilingCluster.computationTime"),value:i.$t("profilingCluster.computationTimeTip")}]},"pipeline-parallel":{model:"step_bottleneck_info",dimensions:[i.$t("profilingCluster.rankID"),i.$t("profiling.iterationGapTime"),i.$t("profilingCluster.computationTime"),i.$t("profilingCluster.stageTime"),i.$t("profilingCluster.communicationAloneTime"),i.$t("profilingCluster.collectiveCommunicationAlone"),i.$t("profilingCluster.receiveAloneTime")],cols:["iteration_interval","computation","stage","communication_alone","collective_communication_alone","receive_alone"],tips:[{label:i.$t("profiling.iterationGapTime"),value:i.$t("profilingCluster.iterationGapTimeTip")},{label:i.$t("profilingCluster.receiveAloneTime"),value:i.$t("profilingCluster.receiveAloneTimeTip")},{label:i.$t("profilingCluster.stageTime"),value:i.$t("profilingCluster.stageTimeTip")},{label:i.$t("profilingCluster.communicationAloneTime"),value:i.$t("profilingCluster.communicationAloneTimeTip")},{label:i.$t("profilingCluster.computationTime"),value:i.$t("profilingCluster.computationTimeTip")},{label:i.$t("profilingCluster.collectiveCommunicationAlone"),value:i.$t("profilingCluster.collectiveCommunicationAloneTip")}]}};i.tips=r[n].tips,t&&(e.data.info.forEach((function(t){var i=[t.rank_id].concat(t[r[n].model]);a.push(i)})),i.chartData=[],"pipeline-parallel"===n?a.forEach((function(t){i.chartData.push([t[0],t[1],t[2],t[4],t[3],t[6],t[5]])})):i.chartData=a,i.initChart(r[n].dimensions)),i.cols=r[n].cols;var o=e.data.info.slice(0,i.group_condition.limit);i.tableData=[],o.forEach((function(t){var e={};e.rank_id=t.rank_id,e.profiler_dir=t.profiler_dir;var a=t[r[n].model];"pipeline-parallel"===n&&(a=[a[0],a[1],a[3],a[2],a[5],a[4]]),a.forEach((function(t,n){e[i.cols[n]]=a[n]})),i.tableData.push(e)}))}})).catch((function(t){i.initOver=!0,i.chartData=[],i.tableData=[]}))},initChart:function(t){var i=this;this.chartOption.dataset={dimensions:t,source:[t].concat(this.chartData)};var e=this.chartData.length>25?25:this.chartData.length;this.chartOption.dataZoom=[{startValue:0,endValue:e},{startValue:0,endValue:e,type:"inside"}],this.chartOption.series=new Array(t.length-1).fill({type:"bar",barWidth:8}),this.$nextTick((function(){i.chartObj||(i.chartObj=r["a"].init(i.$refs.clusterChart,r["b"])),i.chartObj.setOption(i.chartOption,!0)}))},resizeCallback:function(){var t=this;this.chartResizeTimer&&(clearTimeout(this.chartResizeTimer),this.chartResizeTimer=null),this.chartResizeTimer=setTimeout((function(){t.chartObj&&t.chartObj.resize()}),200)},viewProfilingDetail:function(t){this.$router.push({path:"/profiling-gpu/single",query:Object.assign(this.trainInfo,{rankID:t.rank_id})})},currentPageChange:function(t){this.group_condition.offset=t-1,this.queryStepTraceInfo(!1)},currentPageSizeChange:function(t){this.group_condition.offset=0,this.group_condition.limit=t,this.queryStepTraceInfo(!1)},tableSortChange:function(t){this.sort_condition={name:t.prop,type:t.order},this.group_condition.offset=0,this.queryStepTraceInfo(!0)},viewStepFilter:function(){/^[0-9]*[1-9][0-9]*$/.test(this.step.showStep)&&this.step.showStep<=this.step.maxStep?(this.step.filterStep=this.step.showStep,this.group_condition.offset=0,this.queryStepTraceInfo(!0)):""===this.step.showStep?(this.step.filterStep="",this.group_condition.offset=0,this.queryStepTraceInfo(!0)):(this.step.showStep=this.step.filterStep,this.$message.error(this.$t("profiling.inputError").replace("{max}",this.step.maxStep)))}}},s=l,c=(e("c6c6"),e("2877")),p=Object(c["a"])(s,a,n,!1,null,null,null);i["default"]=p.exports},d81d:function(t,i,e){"use strict";var a=e("23e7"),n=e("b727").map,r=e("1dde"),o=e("ae40"),l=r("map"),s=o("map");a({target:"Array",proto:!0,forced:!l||!s},{map:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},fb6a:function(t,i,e){"use strict";var a=e("23e7"),n=e("861d"),r=e("e8b5"),o=e("23cb"),l=e("50c4"),s=e("fc6a"),c=e("8418"),p=e("b622"),u=e("1dde"),f=e("ae40"),h=u("slice"),g=f("slice",{ACCESSORS:!0,0:0,1:2}),d=p("species"),m=[].slice,v=Math.max;a({target:"Array",proto:!0,forced:!h||!g},{slice:function(t,i){var e,a,p,u=s(this),f=l(u.length),h=o(t,f),g=o(void 0===i?f:i,f);if(r(u)&&(e=u.constructor,"function"!=typeof e||e!==Array&&!r(e.prototype)?n(e)&&(e=e[d],null===e&&(e=void 0)):e=void 0,e===Array||void 0===e))return m.call(u,h,g);for(a=new(void 0===e?Array:e)(v(g-h,0)),p=0;h<g;h++,p++)h in u&&c(a,p,u[h]);return a.length=p,a}})}}]);