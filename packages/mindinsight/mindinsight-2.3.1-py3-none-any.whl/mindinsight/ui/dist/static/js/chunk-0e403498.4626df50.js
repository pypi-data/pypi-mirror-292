(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e403498"],{"06c5":function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));a("a630"),a("fb6a"),a("b0c0"),a("d3b7"),a("ac1f"),a("00b4"),a("25f0"),a("3ca3");var i=a("6b75");function r(t,e){if(t){if("string"==typeof t)return Object(i["a"])(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Object(i["a"])(t,e):void 0}}},1148:function(t,e,a){"use strict";var i=a("a691"),r=a("1d80");t.exports="".repeat||function(t){var e=String(r(this)),a="",n=i(t);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(e+=e))1&n&&(a+=e);return a}},"174c":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"data-process-wrap"},[i("div",{class:["profiling-content-title"+(t.isGPU?"-gpu":"")]},[t._v(t._s(t.$t("profiling.minddataTitle")))]),i("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:t.$t("profiling.queueInfo"),name:"queueInfo"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.processSummary.noData,expression:"!processSummary.noData"}],staticClass:"data-process-top"},[i("div",{staticClass:"cell-container data-process"},[i("div",{staticClass:"title"},[t._v(" "+t._s(t.$t("profiling.pipeline"))+" ")])]),i("div",{staticClass:"queue-container"},[i("div",{staticClass:"img"},[i("div",{staticClass:"edge"},[i("img",{attrs:{src:a("7012")}})]),i("div",{staticClass:"icon"},[i("img",{attrs:{src:a("1b54"),clickKey:"connector_queue"},on:{click:function(e){return t.highlight("connector_queue")}}})]),i("div",{staticClass:"edge"},[i("img",{attrs:{src:a("7012")}})])]),i("div",{staticClass:"title"},[t._v(t._s(t.connectorQuene))]),i("div",{staticClass:"description"},[t.processSummary.device.empty||0===t.processSummary.device.empty?i("div",{staticClass:"item"},[t._v(" "+t._s(t.$t("profiling.queueTip2"))+" "),i("span",{staticClass:"num"},[t._v(" "+t._s(t.processSummary.device.empty)+"/"+t._s(t.processSummary.device.total)+" ")])]):t._e(),t.processSummary.device.full||0===t.processSummary.device.full?i("div",{staticClass:"item"},[t._v(" "+t._s(t.$t("profiling.queueTip1"))+" "),i("span",{staticClass:"num"},[t._v(" "+t._s(t.processSummary.device.full)+"/"+t._s(t.processSummary.device.total)+" ")])]):t._e()])]),i("div",{staticClass:"cell-container device_queue_op",style:{cursor:t.processSummary.count!==t.processSummary.maxCount?"default":"pointer"},attrs:{clickKey:"device_queue_op"},on:{click:function(e){return t.highlight("device_queue_op")}}},[i("div",{staticClass:"title"},[t._v(" "+t._s(t.$t("profiling.deviceQueueOp"))+" ")])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.processSummary.count===t.processSummary.maxCount,expression:"processSummary.count === processSummary.maxCount"}],staticClass:"queue-container"},[i("div",{staticClass:"img"},[i("div",{staticClass:"edge"},[i("img",{attrs:{src:a("7012")}})]),i("div",{staticClass:"icon"},[i("img",{attrs:{src:a("1b54"),clickKey:"data_queue"},on:{click:function(e){return t.highlight("data_queue")}}})]),i("div",{staticClass:"edge"},[i("img",{attrs:{src:a("7012")}})])]),i("div",{staticClass:"title"},[t._v(t._s(t.$t("profiling.dataQueue")))]),i("div",{staticClass:"description"},[t.processSummary.get_next.empty||0===t.processSummary.get_next.empty?i("div",{staticClass:"item"},[t._v(" "+t._s(t.$t("profiling.queueTip2"))+" "),i("span",{staticClass:"num"},[t._v(" "+t._s(t.processSummary.get_next.empty)+"/"+t._s(t.processSummary.get_next.total)+" ")])]):t._e(),t.processSummary.get_next.full||0===t.processSummary.get_next.full?i("div",{staticClass:"item"},[t._v(" "+t._s(t.$t("profiling.queueTip1"))+" "),i("span",{staticClass:"num"},[t._v(" "+t._s(t.processSummary.get_next.full)+"/"+t._s(t.processSummary.get_next.total)+" ")])]):t._e()])]),t.processSummary.count===t.processSummary.maxCount?i("div",{staticClass:"cell-container get-next",attrs:{clickKey:"get_next"},on:{click:function(e){return t.highlight("get_next")}}},[i("div",{staticClass:"title"},[t._v(" "+t._s(t.$t("profiling.getData"))+" ")])]):t._e()]),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.processSummary.noData,expression:"!processSummary.noData"}],staticClass:"data-process-bottom"},[t.processSummary.count===t.processSummary.maxCount?i("div",{staticClass:"queue-step-wrap"},[i("div",{staticClass:"title"},[t._v(t._s(t.$t("profiling.queueStep")))]),i("div",{staticClass:"chart-content"},[i("div",{staticClass:"chart-wrap",class:{highlight:"connector_queue"===t.selected}},[i("div",{staticClass:"title"},[t._v(t._s(t.connectorQuene))]),t.connectQueueChart.noData?i("div",{staticClass:"image-noData"},[i("div",[i("img",{attrs:{src:a("9485")}})]),i("p",[t._v(t._s(t.connectQueueChart.initOver?t.$t("public.noData"):t.$t("public.dataLoading")))])]):[void 0!==t.connectQueueChart.queueSummary.empty_queue?i("div",{staticClass:"data-tips"},[i("div",[t._v(" "+t._s(t.$t("profiling.queueTip2"))+t._s(t.connectQueueChart.queueSummary.empty_queue)+" /"+t._s(t.connectQueueChart.size))]),i("div",[t._v(" "+t._s(t.$t("profiling.queueTip1"))+" "+t._s(t.connectQueueChart.size-t.connectQueueChart.queueSummary.empty_queue)+" /"+t._s(t.connectQueueChart.size))])]):t._e(),i("div",{staticClass:"chart",attrs:{id:"connect-queue"}})]],2),i("div",{staticClass:"chart-wrap",class:{highlight:"data_queue"===t.selected}},[i("div",{staticClass:"title"},[t._v(t._s(t.$t("profiling.dataQueue")))]),t.dataQueueChart.noData?i("div",{staticClass:"image-noData"},[i("div",[i("img",{attrs:{src:a("9485")}})]),i("p",[t._v(t._s(t.dataQueueChart.initOver?t.$t("public.noData"):t.$t("public.dataLoading")))])]):[void 0!==t.dataQueueChart.queueSummary.empty_queue?i("div",{staticClass:"data-tips"},[i("div",[t._v(" "+t._s(t.$t("profiling.queueTip2"))+t._s(t.dataQueueChart.queueSummary.empty_queue)+" /"+t._s(t.dataQueueChart.size))]),i("div",[t._v(" "+t._s(t.$t("profiling.queueTip1"))+" "+t._s(t.dataQueueChart.size-t.dataQueueChart.queueSummary.empty_queue)+" /"+t._s(t.dataQueueChart.size))])]):t._e(),i("div",{staticClass:"chart",attrs:{id:"data-queue"}})]],2)])]):t._e(),t.processSummary.count===t.processSummary.maxCount?i("div",{staticClass:"queue-step-wrap"},[i("div",{staticClass:"title"},[t._v(t._s(t.$t("profiling.operatorTimeConAnalysis")))]),i("div",{staticClass:"chart-content second"},[i("div",{staticClass:"chart-wrap analysis",class:{highlight:"device_queue_op"===t.selected}},[i("div",{staticClass:"title"},[t._v(t._s(t.$t("profiling.deviceQueueOp")))]),t.deviceQueueOpChart.noData?i("div",{staticClass:"image-noData"},[i("div",[i("img",{attrs:{src:a("9485")}})]),i("p",[t._v(t._s(t.deviceQueueOpChart.initOver?t.$t("public.noData"):t.$t("public.dataLoading")))])]):[i("div",{staticClass:"data-tips"},[void 0!==t.deviceQueueOpChart.timeSummary.avg_cost?i("div",[t._v(" "+t._s(t.$t("profiling.avgCost"))+t._s(t.deviceQueueOpChart.timeSummary.avg_cost)+"ms")]):t._e(),void 0!==t.deviceQueueOpChart.timeSummary.get_cost?i("div",[t._v(" "+t._s(t.$t("profiling.getCost"))+t._s(t.deviceQueueOpChart.timeSummary.get_cost)+"ms")]):t._e(),void 0!==t.deviceQueueOpChart.timeSummary.push_cost?i("div",[t._v(" "+t._s(t.$t("profiling.pushCost"))+t._s(t.deviceQueueOpChart.timeSummary.push_cost)+"ms")]):t._e()]),i("div",{staticClass:"chart",attrs:{id:"device_queue_op"}})]],2),i("div",{staticClass:"chart-wrap analysis",class:{highlight:"get_next"===t.selected}},[i("div",{staticClass:"title"},[t._v(t._s(t.$t("profiling.getNext")))]),t.getNextChart.noData?i("div",{staticClass:"image-noData"},[i("div",[i("img",{attrs:{src:a("9485")}})]),i("p",[t._v(t._s(t.getNextChart.initOver?t.$t("public.noData"):t.$t("public.dataLoading")))])]):[i("div",{staticClass:"data-tips"},[void 0!==t.getNextChart.timeSummary.avg_cost?i("div",[t._v(" "+t._s(t.$t("profiling.avgCost"))+t._s(t.getNextChart.timeSummary.avg_cost)+"ms")]):t._e(),void 0!==t.getNextChart.timeSummary.get_cost?i("div",[t._v(" "+t._s(t.$t("profiling.getCost"))+t._s(t.getNextChart.timeSummary.get_cost)+"ms")]):t._e(),void 0!==t.getNextChart.timeSummary.push_cost?i("div",[t._v(" "+t._s(t.$t("profiling.pushCost"))+t._s(t.getNextChart.timeSummary.push_cost)+"ms")]):t._e()]),i("div",{staticClass:"chart",attrs:{id:"get_next"}})]],2)])]):t._e(),t.processSummary.count!==t.processSummary.maxCount?i("div",{staticClass:"queue-step-wrap single"},[i("div",{staticClass:"title"},[t._v(t._s(t.$t("profiling.queueStep")))]),i("div",{staticClass:"chart-content"},[i("div",{staticClass:"chart-wrap",class:{highlight:"connector_queue"===t.selected}},[i("div",{staticClass:"title"},[t._v(t._s(t.connectorQuene))]),t.connectQueueChart.noData?t._e():[void 0!==t.connectQueueChart.queueSummary.empty_queue?i("div",{staticClass:"data-tips"},[i("div",[t._v(" "+t._s(t.$t("profiling.queueTip2"))+t._s(t.connectQueueChart.queueSummary.empty_queue)+" /"+t._s(t.connectQueueChart.size))]),i("div",[t._v(" "+t._s(t.$t("profiling.queueTip1"))+" "+t._s(t.connectQueueChart.size-t.connectQueueChart.queueSummary.empty_queue)+" /"+t._s(t.connectQueueChart.size))])]):t._e(),i("div",{staticClass:"chart",attrs:{id:"connect-queue"}})]],2)])]):t._e()]),t.processSummary.noData?i("div",{staticClass:"image-noData"},[i("div",[i("img",{attrs:{src:a("9485")}})]),i("p",[t._v(t._s(t.initOver?t.$t("public.noData"):t.$t("public.dataLoading")))])]):t._e()]),i("el-tab-pane",{attrs:{label:t.$t("profiling.pipeline"),name:"pipeLine"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.pipeData,expression:"!pipeData"}],staticClass:"pipeline-wrap"},[i("div",{staticClass:"pipeline-top"},[i("div",{staticClass:"pipeline-top-title"},[t._v(" "+t._s(t.$t("profiling.pipelineTopTitle"))+" ")]),i("div",{staticClass:"average-rate-wrap"},[i("div",{attrs:{id:"average-rate"}})])]),i("div",{staticClass:"pipeline-middle"},[i("div",{staticClass:"pipeline-middle-title"},[t._v(" "+t._s(t.$t("profiling.pipelineMiddleTitle"))+" ")]),i("div",{staticClass:"operator-graph"},[i("div",{attrs:{id:"graph"}})])]),i("div",{staticClass:"pipeline-bottom"},[i("div",{staticClass:"queue-deep-wrap"},[i("div",{staticClass:"left"},[i("div",{attrs:{id:"queue-deep"}})]),i("div",{staticClass:"right"},[i("div",{staticClass:"title"},[t._v(t._s(t.$t("profiling.operatorInfo",{msg1:t.current_op.name,msg2:t.parent_op.name})))]),i("div",{staticClass:"item-wrap"},[i("div",{staticClass:"item"},[i("span",[t._v(t._s(t.current_op.name)+" ID:")]),i("span",{staticClass:"eitem-right"},[t._v(t._s(t.current_op.op_id))])]),i("div",{staticClass:"item"},[i("span",[t._v(t._s(t.current_op.name)+" type:")]),i("span",{staticClass:"eitem-right"},[t._v(t._s(t.current_op.op_type))])]),i("div",{staticClass:"item"},[i("span",[t._v(t._s(t.current_op.name)+" "+t._s(t.$t("profiling.workersNum"))+":")]),i("span",{staticClass:"eitem-right"},[t._v(t._s(t.current_op.num_workers))])]),i("div",{staticClass:"item"},[i("span",[t._v(t._s(t.parent_op.name)+" ID:")]),i("span",{staticClass:"eitem-right"},[t._v(t._s(t.parent_op.op_id))])]),i("div",{staticClass:"item"},[i("span",[t._v(t._s(t.parent_op.name)+" type:")]),i("span",{staticClass:"eitem-right"},[t._v(t._s(t.parent_op.op_type))])]),i("div",{staticClass:"item"},[i("span",[t._v(t._s(t.parent_op.name)+" "+t._s(t.$t("profiling.workersNum"))+":")]),i("span",{staticClass:"eitem-right"},[t._v(t._s(t.parent_op.num_workers))])])])])])])]),t.pipeData?i("div",{staticClass:"image-noData"},[i("div",[i("img",{attrs:{src:a("9485")}})]),i("p",[t._v(t._s(t.initOver?t.$t("public.noData"):t.$t("public.dataLoading")))])]):t._e()])],1)],1)},r=[],n=(a("99af"),a("4de4"),a("a630"),a("caad"),a("d81d"),a("4e82"),a("b0c0"),a("e9c4"),a("a9e3"),a("b680"),a("b64b"),a("d3b7"),a("2532"),a("3ca3"),a("498a"),a("159b"),a("9fac")),s=a("3778"),o=a("2dd7"),c=a("5698"),u=a("0165"),l=(a("6d21"),a("9944")),p={select:c["select"],selectAll:c["selectAll"],zoom:c["zoom"]},d={props:{rankID:String},data:function(){return{isGPU:this.$route.path.includes("profiling-gpu"),trainInfo:{path:this.$route.query.path,dir:this.$route.query.dir,id:this.$route.query.id},connectQueueChart:{id:"connect-queue",chartDom:null,data:[],queueSummary:{},type:0,params:"device_queue",noData:!0,size:null,deviceId:null,initOver:!1},dataQueueChart:{id:"data-queue",chartDom:null,data:[],queueSummary:{},type:0,params:"get_next",noData:!0,size:null,initOver:!1},deviceQueueOpChart:{id:"device_queue_op",chartDom:null,data:[],timeSummary:{},type:1,params:"device_queue",noData:!0,initOver:!1},getNextChart:{id:"get_next",chartDom:null,data:[],timeSummary:{},type:1,params:"get_next",noData:!0,initOver:!1},processSummary:{noData:!0,count:6,maxCount:6,device:{empty:0,full:0,total:0},get_next:{empty:0,full:0,total:0}},activeName:"queueInfo",averageRateChart:{id:"average-rate",chartDom:null,deviceId:null},queueDeepChart:{id:"queue-deep",chartDom:null},current_op:{},parent_op:{},pipeData:!0,initOver:!1,allGraphData:{},graphviz:null,totalMemory:33554432,scaleRange:[1e-4,1e4],initQueue:"",trainId:"",selected:"",connectorQuene:"",resizeDebounce:null,themeColor:"",chartThemeObj:o["a"].commonChartTheme[this.$store.state.themeIndex]}},watch:{rankID:{handler:function(t){Object(l["b"])(t)?"queueInfo"===this.activeName?this.init():"pipeLine"===this.activeName&&this.queryAverageRate():""===t&&(this.initOver=!0)},immediate:!0}},mounted:function(){var t=this,e=this.trainInfo.id;document.title=(e?e+"-":"")+"".concat(this.$t("profiling.mindData"),"-MindInsight"),this.resizeDebounce=this.debounce(this.resizeCallback,200),window.addEventListener("resize",this.resizeDebounce,!1),setTimeout((function(){t.$bus.$on("collapse",t.resizeDebounce)}),500),this.themeColor=getComputedStyle(document.documentElement).getPropertyValue("--theme-color")},methods:{addPercentSign:function(t){return 0===t||"0"===t?"0":"".concat(t,"%")},debounce:function(t,e){var a=null;return function(){a&&clearTimeout(a),a=setTimeout(t,e)}},handleClick:function(){var t=this;"pipeLine"===this.activeName&&this.averageRateChart.deviceId!==this.currentCard?this.queryAverageRate():"queueInfo"===this.activeName&&this.connectQueueChart.deviceId!==this.currentCard&&this.init(),this.$nextTick((function(){t.resizeCallback()}))},init:function(){this.connectorQuene=this.$t("profiling.connectorQuene"),this.queryProcessSummary()},resizeCallback:function(){var t=this,e=["connectQueueChart","dataQueueChart","deviceQueueOpChart","getNextChart","averageRateChart","queueDeepChart"];e.forEach((function(e){t[e].chartDom&&t[e].chartDom.resize()}))},queryMinddataOp:function(t){var e=this,a={profile:this.trainInfo.dir,device_id:this.rankID,type:t.params,train_id:this.trainInfo.id};s["a"].minddataOp(a).then((function(a){if(a&&a.data){t.initOver=!0;var i=a.data;t.data=i.info,i.summary&&(t.timeSummary=i.summary.time_summary||{},Object.keys(t.timeSummary).forEach((function(e){t.timeSummary[e]=parseFloat(t.timeSummary[e]).toFixed(3)}))),i.size>0?(t.noData=!1,e.$nextTick((function(){e.setOption(t)}))):(t.chartDom&&t.chartDom.clear(),t.noData=!0)}}),(function(e){t.chartDom&&t.chartDom.clear(),t.initOver=!0,t.noData=!0}))},queryQueueInfo:function(t){var e=this,a={profile:this.trainInfo.dir,device_id:this.rankID,type:t.params,train_id:this.trainInfo.id};s["a"].queueInfo(a).then((function(a){if(a&&a.data){t.initOver=!0;var i=a.data;t.data=i.info,i.summary&&(t.queueSummary=i.summary.queue_summary||{}),i.size>0?(t.noData=!1,t.size=i.size,e.$nextTick((function(){e.setOption(t)}))):(t.chartDom&&t.chartDom.clear(),t.noData=!0)}}),(function(e){t.initOver=!0,t.noData=!0,t.chartDom&&t.chartDom.clear()}))},setOption:function(t){var e=n["a"].init(document.getElementById(t.id),n["b"]),a={tooltip:{trigger:"axis",confine:!0},toolbox:{show:!0},xAxis:{name:"step",data:[],axisLine:{lineStyle:{color:this.chartThemeObj.axisTextColor}}},yAxis:{axisLine:{lineStyle:{color:this.chartThemeObj.axisTextColor}},splitLine:{show:!0,lineStyle:{color:this.chartThemeObj.splitLineColor}}},series:[],grid:{left:70,top:20,right:50,bottom:60},dataZoom:[{start:0,end:100,bottom:0},{start:0,end:100,type:"inside",bottom:0}]},i=[];Object.keys(t.data).forEach((function(e,a){var r={type:"line"};if(r.data=t.data[e],r.name=e,0===t.type){var n=[];r.data.forEach((function(t,e){0===t&&n.push({xAxis:e,yAxis:t,symbolSize:20})})),r.markPoint={data:n}}i.push(r)})),a.series=i,a.xAxis.data=t.data[Object.keys(t.data)[0]].map((function(t,e){return e+1})),e.setOption(a),t.chartDom=e,this.connectQueueChart.chartDom&&this.deviceQueueOpChart.chartDom&&n["a"].connect([this.connectQueueChart.chartDom,this.deviceQueueOpChart.chartDom]),this.getNextChart.chartDom&&this.dataQueueChart.chartDom&&n["a"].connect([this.getNextChart.chartDom,this.dataQueueChart.chartDom])},queryProcessSummary:function(){var t=this,e={profile:this.trainInfo.dir,device_id:this.rankID,train_id:this.trainInfo.id};this.connectQueueChart.deviceId=this.deviceID,this.initOver=!1,s["a"].queryProcessSummary(e).then((function(e){if(e&&e.data){var a=JSON.parse(JSON.stringify(e.data));t.processSummary.count=Object.keys(a).length,t.processSummary.count?(t.dealProcess(a),t.$nextTick((function(){t.processSummary.count<t.processSummary.maxCount?(t.queryQueueInfo(t.connectQueueChart),t.dataQueueChart.noData=!1,t.deviceQueueOpChart.noData=!1,t.getNextChart.noData=!1):(t.queryQueueInfo(t.connectQueueChart),t.queryQueueInfo(t.dataQueueChart),t.queryMinddataOp(t.deviceQueueOpChart),t.queryMinddataOp(t.getNextChart))}))):t.dealProcess(null)}else t.dealProcess(null)}),(function(e){t.dealProcess(null)}))},dealProcess:function(t){this.processSummary.device={empty:0,full:0,total:0},this.processSummary.get_next={empty:0,full:0,total:0},this.processSummary.noData=!0,this.initOver=!0,t&&(t.device_queue_info&&t.device_queue_info.summary&&(this.processSummary.device={empty:t.device_queue_info.summary.empty_batch_count,full:t.device_queue_info.summary.total_batch-t.device_queue_info.summary.empty_batch_count,total:t.device_queue_info.summary.total_batch}),t.get_next_queue_info&&t.get_next_queue_info.summary&&(this.processSummary.get_next={empty:t.get_next_queue_info.summary.empty_batch_count,full:t.get_next_queue_info.summary.total_batch-t.get_next_queue_info.summary.empty_batch_count,total:t.get_next_queue_info.summary.total_batch}),this.processSummary.noData=!1)},queryAverageRate:function(){var t=this,e={params:{train_id:this.trainInfo.id,profile:this.trainInfo.dir},body:{device_id:this.rankID}};this.averageRateChart.deviceId=this.rankID,this.initOver=!1,s["a"].queryOpQueue(e).then((function(e){if(t.initOver=!0,e&&e.data){t.removeGraph();var a=JSON.parse(JSON.stringify(e.data));if(t.dealPipeLineData(a),t.pipeData=!(e.data.object&&e.data.object.length),e.data.object&&e.data.object.length&&e.data.col_name){var i=e.data.object.map((function(t){var a={};return e.data.col_name.forEach((function(e,i){a[e]=t[i]})),a})),r=i.sort((function(t,e){return t.output_queue_usage_rate-e.output_queue_usage_rate})).filter((function(t){return null!==t.parent_id})),s=r.map((function(t){return Number((100*t.output_queue_usage_rate).toFixed(4))})),o=r.map((function(t){return"Queue_".concat(t.op_id)})),c=t.$t("profiling"),u={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},confine:!0,formatter:function(t){var e={};return r.forEach((function(a){"".concat(a.op_id)===t[0].axisValue.split("")[6]&&(e=a)})),"".concat(t[0].axisValue,"<br>").concat(t[0].marker)+"".concat(c.averageCapacity,"：").concat(e.output_queue_average_size,"<br>")+"".concat(t[0].marker).concat(c.totalCapacity,"：")+"".concat(e.output_queue_length)}},grid:{left:70,top:20,right:100,bottom:50},xAxis:{type:"value",boundaryGap:[0,.01],max:100,axisLabel:{formatter:function(t){return"".concat(t,"%")}}},yAxis:{type:"category",data:o},series:[{type:"bar",data:s,itemStyle:{color:t.themeColor},label:{show:!0,position:"right",color:t.chartThemeObj.legendTextColor,formatter:function(t){return"".concat(t.value,"%")}}}],dataZoom:[{start:0,end:100,orient:"vertical",right:10},{start:0,end:100,type:"inside",orient:"vertical",right:10}]};t.$nextTick((function(){var e=n["a"].init(document.getElementById(t.averageRateChart.id),n["b"]);e.setOption(u),t.averageRateChart.chartDom=e}))}}}),(function(){t.initOver=!0,t.pipeData=!0,t.removeGraph()}))},queryQueue:function(t){var e=this,a={profile:this.trainInfo.dir,train_id:this.trainInfo.id,device_id:this.rankID,op_id:t};s["a"].queryQueue(a).then((function(a){if(a&&a.data){var i=a.data.queue_info,r=i.output_queue_size;e.current_op=a.data.current_op||{},e.parent_op=a.data.parent_op||{},e.current_op.name="".concat(e.current_op.op_type,"_").concat(e.current_op.op_id),e.parent_op.name="".concat(e.parent_op.op_type,"_").concat(e.parent_op.op_id);var s={title:{text:e.$t("profiling.queueDeepChartTitle",{msg:"Queue".concat(t)}),textStyle:{fontSize:13,color:e.chartThemeObj.legendTextColor},left:20,top:10},tooltip:{trigger:"axis",confine:!0},xAxis:{name:"".concat(e.$t("profiling.sampleInterval"),"\n").concat(i.sample_interval,"ms"),data:r.map((function(t,e){return e+1}))},yAxis:{name:""},series:[{type:"line",data:r,itemStyle:{color:e.themeColor}}],grid:{left:50,top:40,right:100,bottom:60},dataZoom:[{start:0,end:100,bottom:10},{start:0,end:100,type:"inside",bottom:10}]};e.$nextTick((function(){var t=n["a"].init(document.getElementById(e.queueDeepChart.id),n["b"]);t.setOption(s),e.queueDeepChart.chartDom=t}))}}))},highlight:function(t){if("device_queue_op"!==t||this.processSummary.count===this.processSummary.maxCount){var e=document.querySelectorAll(".data-process-top *[clickKey]");Array.prototype.forEach.call(e,(function(e){e.getAttribute("clickKey")===t?e.classList.add("selected"):e.classList.remove("selected")})),this.selected=t}},dealPipeLineData:function(t){var e=this,a=t.col_name,i=a.length,r=t.object;if(r.forEach((function(t){if(t&&t.length===i){var r={output:""};if(a.forEach((function(e,a){r[e]=t[a]})),r.op_id||0===r.op_id){if(r.key="".concat(r.op_id,"_operator"),r.parent_id||0===r.parent_id){var n="".concat(r.op_id,"_queue");r.output=n;var s=JSON.parse(JSON.stringify(r));s.key=n,s.op_type="queue",s.output="".concat(r.parent_id,"_operator"),e.allGraphData[n]=s,e.initQueue||0===e.initQueue||(e.initQueue=s.op_id)}e.allGraphData[r.key]=r}}})),Object.keys(this.allGraphData).length){var n=this.packageGraphData();this.initGraph(n)}else this.removeGraph()},packageGraphData:function(){var t=this,e="",a="";Object.keys(this.allGraphData).forEach((function(i){var r=t.allGraphData[i];e+="<".concat(i,'>[id="').concat(i,'";')+"".concat("queue"===r.op_type?'shape=rect;class="queue";label="Queue_'.concat(r.op_id,"(").concat(parseFloat((100*(r.output_queue_usage_rate||0)).toFixed(4)),'%)";'):'shape=Mrecord;class="operator";label="'.concat(r.op_type,"_").concat(r.op_id,'";'),"];"),r.output&&(a+="<".concat(r.key,">-><").concat(r.output,">"))}));var i='node[style="filled";fontsize="10px"];edge[fontsize="6px";];';return"digraph {compound=true;rankdir=LR;".concat(i).concat(e).concat(a,"}")},initGraph:function(t){this.graphviz=p.select("#graph").graphviz({useWorker:!1,totalMemory:this.totalMemory}).zoomScaleExtent(this.scaleRange).dot(t).attributer(this.attributer).render(this.startApp)},attributer:function(t,e,a){if("svg"===t.tag){var i="100%",r="100%";t.attributes.width=i,t.attributes.height=r}},startApp:function(){var t=this;setTimeout((function(){t.graphviz&&(t.graphviz._data=null,t.graphviz._dictionary=null,t.graphviz=null)}),500),p.select("#graph").selectAll(".operator>title").remove();for(var e=Array.from(document.querySelectorAll("#graph .queue")),a=0,i=e.length;a<i;a++){var r=e[a],n=this.allGraphData[r.id];if(n){var s=r.querySelector("polygon"),o="rgba(19, 171, 173, ".concat(n.output_queue_usage_rate,")");s.setAttribute("fill",o),s.setAttribute("stroke",o);var c=r.querySelector("title");c.textContent="".concat(this.$t("profiling.averageCapacity"),":").concat(n.output_queue_average_size||0,"\n")+"".concat(this.$t("profiling.totalCapacity"),":").concat(n.output_queue_length||0)}}this.initZooming();var u=p.selectAll("g.queue");u.on("click",(function(e,a,i){var r=i[a];u.classed("selected",!1),p.select('g[id="'.concat(r.id,'"]')).classed("selected",!0);var n=t.allGraphData[r.id];n&&t.queryQueue(n.op_id)})),p.select('g[id="'.concat(this.initQueue,'_queue"]')).classed("selected",!0),this.queryQueue(this.initQueue)},initZooming:function(){var t=this,e=document.querySelector("#graph svg"),a=e.getBoundingClientRect(),i=document.querySelector("#graph #graph0"),r=i.getBBox(),n=i.getBoundingClientRect(),s={},o=Math.min(a.width/2/n.width,a.height/2/n.height),c=4,l=20,d={start:{x:0,y:0},end:{x:0,y:0}},m=p.zoom().on("start",(function(){var t=u["c"].sourceEvent;d.start.x=t.x,d.start.y=t.y})).on("zoom",(function(){var e=u["c"].sourceEvent,n=t.getTransformData(i);Object.keys(s).length||(s={x:n.translate[0],y:n.translate[1],k:n.scale[0]});var p="",m={},h=n.scale[0],v=i.getBoundingClientRect(),f=r.width/v.width;if("mousemove"===e.type){d.end.x=e.x,d.end.y=e.y;var _=d.end.x-d.start.x,g=d.end.y-d.start.y,y=Math.max(c/f/h,l);v.left+y+_>=a.left+a.width&&(_=Math.min(_,0)),v.left+v.width-y+_<=a.left&&(_=Math.max(_,0)),v.top+y+g>=a.top+a.height&&(g=Math.min(g,0)),v.top+v.height-y+g<=a.top&&(g=Math.max(g,0)),m={x:_*f*h,y:g*f*h},d.start.x=d.end.x,d.start.y=d.end.y}else if("wheel"===e.type){var C=-e.deltaY,b=1.2;h=C>0?n.scale[0]*b:n.scale[0]/b,h=Math.max(t.scaleRange[0],h,o),h=Math.min(t.scaleRange[1],h),m={x:(v.x+c/f-e.x)*f*(h-n.scale[0]),y:(v.bottom-c/f-e.y)*f*(h-n.scale[0])}}s={x:n.translate[0]+m.x,y:n.translate[1]+m.y,k:h},p="translate(".concat(s.x,",").concat(s.y,") scale(").concat(s.k,")"),i.setAttribute("transform",p),e.stopPropagation(),e.preventDefault()})),h=p.select("#graph svg");h.on(".zoom",null),h.call(m),h.on("dblclick.zoom",null),h.on("wheel.zoom",null);var v=p.select("#graph #graph0");v.on(".zoom",null),v.call(m)},getTransformData:function(t){if(!t)return[];var e=t.getAttribute("transform"),a={};if(e){var i=e.trim().split(" ");i.forEach((function(t){var e=t.indexOf("("),i=t.indexOf(")"),r=t.substring(0,e),n=t.substring(e+1,i).split(",").map((function(t){return parseFloat(t)||0}));a[r]=n}))}return a},removeGraph:function(){var t=document.querySelector("#graph svg");t&&t.remove(),this.allGraphData={}}},destroyed:function(){window.removeEventListener("resize",this.resizeDebounce,!1),this.$bus.$off("collapse")}},m=d,h=(a("a34f"),a("2877")),v=Object(h["a"])(m,i,r,!1,null,null,null);e["default"]=v.exports},"1b54":function(t,e,a){t.exports=a.p+"static/img/queue.9041b2bc.svg"},3835:function(t,e,a){"use strict";function i(t){if(Array.isArray(t))return t}a.d(e,"a",(function(){return o}));a("e01a"),a("d28b"),a("e260"),a("d3b7"),a("3ca3"),a("ddb0");function r(t,e){var a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var i,r,n,s,o=[],c=!0,u=!1;try{if(n=(a=a.call(t)).next,0===e){if(Object(a)!==a)return;c=!1}else for(;!(c=(i=n.call(a)).done)&&(o.push(i.value),o.length!==e);c=!0);}catch(t){u=!0,r=t}finally{try{if(!c&&null!=a["return"]&&(s=a["return"](),Object(s)!==s))return}finally{if(u)throw r}}return o}}var n=a("06c5");function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t,e){return i(t)||r(t,e)||Object(n["a"])(t,e)||s()}},"408a":function(t,e,a){var i=a("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=i(t))throw TypeError("Incorrect invocation");return+t}},"498a":function(t,e,a){"use strict";var i=a("23e7"),r=a("58a8").trim,n=a("c8d2");i({target:"String",proto:!0,forced:n("trim")},{trim:function(){return r(this)}})},"4de4":function(t,e,a){"use strict";var i=a("23e7"),r=a("b727").filter,n=a("1dde"),s=a("ae40"),o=n("filter"),c=s("filter");i({target:"Array",proto:!0,forced:!o||!c},{filter:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(t,e,a){"use strict";var i=a("0366"),r=a("7b0b"),n=a("9bdd"),s=a("e95a"),o=a("50c4"),c=a("8418"),u=a("35a1");t.exports=function(t){var e,a,l,p,d,m,h=r(t),v="function"==typeof this?this:Array,f=arguments.length,_=f>1?arguments[1]:void 0,g=void 0!==_,y=u(h),C=0;if(g&&(_=i(_,f>2?arguments[2]:void 0,2)),void 0==y||v==Array&&s(y))for(e=o(h.length),a=new v(e);e>C;C++)m=g?_(h[C],C):h[C],c(a,C,m);else for(p=y.call(h),d=p.next,a=new v;!(l=d.call(p)).done;C++)m=g?n(p,_,[l.value,C],!0):l.value,c(a,C,m);return a.length=C,a}},"4e82":function(t,e,a){"use strict";var i=a("23e7"),r=a("1c0b"),n=a("7b0b"),s=a("d039"),o=a("a640"),c=[],u=c.sort,l=s((function(){c.sort(void 0)})),p=s((function(){c.sort(null)})),d=o("sort"),m=l||!p||!d;i({target:"Array",proto:!0,forced:m},{sort:function(t){return void 0===t?u.call(n(this)):u.call(n(this),r(t))}})},"5e89":function(t,e,a){var i=a("861d"),r=Math.floor;t.exports=function(t){return!i(t)&&isFinite(t)&&r(t)===t}},"5f45":function(t,e,a){},"6b75":function(t,e,a){"use strict";function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=Array(e);a<e;a++)i[a]=t[a];return i}a.d(e,"a",(function(){return i}))},7012:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFkAAAAOCAYAAABEgLDgAAAAAXNSR0IArs4c6QAAAKtJREFUWAnt1FEKwyAQhOFYerBex1v0Fl7HnKyR4g8VxMwmj51AmJfZDX4Qt82PLFBKqe19yQO9mKID/9xvwJ9+/r3lO+dcFQ8jK0q984PMlIRtZLiEnCAztcQ2MkxCLpCZnmIbGR4hBWS2DNgpMMgCpy7wxX7ofTevCvi6CMgF/vrhungGvuHqucCAS93ISNzLKS4rjYzEtVzistLISMRSwmWlkZHQMoTLygPMOjzZRkfJYgAAAABJRU5ErkJggg=="},"8ba4":function(t,e,a){var i=a("23e7"),r=a("5e89");i({target:"Number",stat:!0},{isInteger:r})},9485:function(t,e,a){t.exports=a.p+"static/img/nodata.8290bed9.png"},9944:function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"c",(function(){return s})),a.d(e,"b",(function(){return o}));var i=a("3835");a("99af"),a("caad"),a("8ba4"),a("b680"),a("d3b7"),a("ac1f"),a("25f0"),a("2532"),a("466d");function r(t,e,a){t.toLowerCase().includes("rgb")||(t=n(t)),e.toLowerCase().includes("rgb")||(e=n(e));for(var r=t.match(/[0-9]\d*/g),s=Object(i["a"])(r,3),o=s[0],c=s[1],u=s[2],l=e.match(/[0-9]\d*/g),p=Object(i["a"])(l,3),d=p[0],m=p[1],h=p[2],v=(+d-+o)/a,f=(+m-+c)/a,_=(+h-+u)/a,g=[t],y=1;y<a;y++){var C=parseInt(v*y+ +o),b=parseInt(f*y+ +c),x=parseInt(_*y+ +u);g.push("rgb(".concat(C,",").concat(b,",").concat(x,")"))}return g}function n(t){var e=16;return 4===t.length?"rgb(".concat(parseInt(t[1]+t[1],e),", ").concat(parseInt(t[2]+t[2],e),", ").concat(parseInt(t[3]+t[3],e),")"):"rgb(".concat(parseInt(t[1]+t[2],e),", ").concat(parseInt(t[3]+t[4],e),", ").concat(parseInt(t[5]+t[6],e),")")}function s(t,e){if("number"!==typeof t&&(t=parseFloat(t)),isNaN(t))return"NaN";var a=t+"",i=a.indexOf(".");return i<0||a.length-i-1<=e?a:t.toFixed(e)}function o(t){if(Number.isInteger(t))return!0;if("string"!==typeof t)return!1;var e=+t;return e+""===t&&Number.isInteger(e)}},a34f:function(t,e,a){"use strict";a("5f45")},a630:function(t,e,a){var i=a("23e7"),r=a("4df4"),n=a("1c7e"),s=!n((function(t){Array.from(t)}));i({target:"Array",stat:!0,forced:s},{from:r})},b0c0:function(t,e,a){var i=a("83ab"),r=a("9bf2").f,n=Function.prototype,s=n.toString,o=/^\s*function ([^ (]*)/,c="name";i&&!(c in n)&&r(n,c,{configurable:!0,get:function(){try{return s.call(this).match(o)[1]}catch(t){return""}}})},b680:function(t,e,a){"use strict";var i=a("23e7"),r=a("a691"),n=a("408a"),s=a("1148"),o=a("d039"),c=1..toFixed,u=Math.floor,l=function(t,e,a){return 0===e?a:e%2===1?l(t,e-1,a*t):l(t*t,e/2,a)},p=function(t){var e=0,a=t;while(a>=4096)e+=12,a/=4096;while(a>=2)e+=1,a/=2;return e},d=c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!o((function(){c.call({})}));i({target:"Number",proto:!0,forced:d},{toFixed:function(t){var e,a,i,o,c=n(this),d=r(t),m=[0,0,0,0,0,0],h="",v="0",f=function(t,e){var a=-1,i=e;while(++a<6)i+=t*m[a],m[a]=i%1e7,i=u(i/1e7)},_=function(t){var e=6,a=0;while(--e>=0)a+=m[e],m[e]=u(a/t),a=a%t*1e7},g=function(){var t=6,e="";while(--t>=0)if(""!==e||0===t||0!==m[t]){var a=String(m[t]);e=""===e?a:e+s.call("0",7-a.length)+a}return e};if(d<0||d>20)throw RangeError("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(h="-",c=-c),c>1e-21)if(e=p(c*l(2,69,1))-69,a=e<0?c*l(2,-e,1):c/l(2,e,1),a*=4503599627370496,e=52-e,e>0){f(0,a),i=d;while(i>=7)f(1e7,0),i-=7;f(l(10,i,1),0),i=e-1;while(i>=23)_(1<<23),i-=23;_(1<<i),f(1,1),_(2),v=g()}else f(0,a),f(1<<-e,0),v=g()+s.call("0",d);return d>0?(o=v.length,v=h+(o<=d?"0."+s.call("0",d-o)+v:v.slice(0,o-d)+"."+v.slice(o-d))):v=h+v,v}})},c8d2:function(t,e,a){var i=a("d039"),r=a("5899"),n="​᠎";t.exports=function(t){return i((function(){return!!r[t]()||n[t]()!=n||r[t].name!==t}))}},d28b:function(t,e,a){var i=a("746f");i("iterator")},e01a:function(t,e,a){"use strict";var i=a("23e7"),r=a("83ab"),n=a("da84"),s=a("5135"),o=a("861d"),c=a("9bf2").f,u=a("e893"),l=n.Symbol;if(r&&"function"==typeof l&&(!("description"in l.prototype)||void 0!==l().description)){var p={},d=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof d?new l(t):void 0===t?l():l(t);return""===t&&(p[e]=!0),e};u(d,l);var m=d.prototype=l.prototype;m.constructor=d;var h=m.toString,v="Symbol(test)"==String(l("test")),f=/^Symbol\((.*)\)[^)]+$/;c(m,"description",{configurable:!0,get:function(){var t=o(this)?this.valueOf():this,e=h.call(t);if(s(p,t))return"";var a=v?e.slice(7,-1):e.replace(f,"$1");return""===a?void 0:a}}),i({global:!0,forced:!0},{Symbol:d})}},e9c4:function(t,e,a){var i=a("23e7"),r=a("d066"),n=a("d039"),s=r("JSON","stringify"),o=/[\uD800-\uDFFF]/g,c=/^[\uD800-\uDBFF]$/,u=/^[\uDC00-\uDFFF]$/,l=function(t,e,a){var i=a.charAt(e-1),r=a.charAt(e+1);return c.test(t)&&!u.test(r)||u.test(t)&&!c.test(i)?"\\u"+t.charCodeAt(0).toString(16):t},p=n((function(){return'"\\udf06\\ud834"'!==s("\udf06\ud834")||'"\\udead"'!==s("\udead")}));s&&i({target:"JSON",stat:!0,forced:p},{stringify:function(t,e,a){var i=s.apply(null,arguments);return"string"==typeof i?i.replace(o,l):i}})}}]);