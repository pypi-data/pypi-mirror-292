<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Coverage for test_taxonomic.py: 96%</title>
    <link rel="icon" sizes="32x32" href="favicon_32.png">
    <link rel="stylesheet" href="style.css" type="text/css">
    <script type="text/javascript" src="coverage_html.js" defer></script>
</head>
<body class="pyfile">
<header>
    <div class="content">
        <h1>
            <span class="text">Coverage for </span><b>test_taxonomic.py</b>:
            <span class="pc_cov">96%</span>
        </h1>
        <aside id="help_panel_wrapper">
            <input id="help_panel_state" type="checkbox">
            <label for="help_panel_state">
                <img id="keyboard_icon" src="keybd_closed.png" alt="Show/hide keyboard shortcuts" />
            </label>
            <div id="help_panel">
                <p class="legend">Shortcuts on this page</p>
                <div class="keyhelp">
                    <p>
                        <kbd>r</kbd>
                        <kbd>m</kbd>
                        <kbd>x</kbd>
                        &nbsp; toggle line displays
                    </p>
                    <p>
                        <kbd>j</kbd>
                        <kbd>k</kbd>
                        &nbsp; next/prev highlighted chunk
                    </p>
                    <p>
                        <kbd>0</kbd> &nbsp; (zero) top of page
                    </p>
                    <p>
                        <kbd>1</kbd> &nbsp; (one) first highlighted chunk
                    </p>
                    <p>
                        <kbd>[</kbd>
                        <kbd>]</kbd>
                        &nbsp; prev/next file
                    </p>
                    <p>
                        <kbd>u</kbd> &nbsp; up to the index
                    </p>
                    <p>
                        <kbd>?</kbd> &nbsp; show/hide this help
                    </p>
                </div>
            </div>
        </aside>
        <h2>
            <span class="text">97 statements &nbsp;</span>
            <button type="button" class="run button_toggle_run" value="run" data-shortcut="r" title="Toggle lines run">93<span class="text"> run</span></button>
            <button type="button" class="mis show_mis button_toggle_mis" value="mis" data-shortcut="m" title="Toggle lines missing">4<span class="text"> missing</span></button>
            <button type="button" class="exc show_exc button_toggle_exc" value="exc" data-shortcut="x" title="Toggle lines excluded">0<span class="text"> excluded</span></button>
        </h2>
        <p class="text">
            <a id="prevFileLink" class="nav" href="test_prune_py.html">&#xab; prev</a> &nbsp; &nbsp;
            <a id="indexLink" class="nav" href="index.html">&Hat; index</a> &nbsp; &nbsp;
            <a id="nextFileLink" class="nav" href="d_a75cd4a9f8cad98a___init___py.html">&#xbb; next</a>
            &nbsp; &nbsp; &nbsp;
            <a class="nav" href="https://coverage.readthedocs.io/en/7.2.7">coverage.py v7.2.7</a>,
            created at 2024-08-07 10:27 +0200
        </p>
        <aside class="hidden">
            <button type="button" class="button_next_chunk" data-shortcut="j"/>
            <button type="button" class="button_prev_chunk" data-shortcut="k"/>
            <button type="button" class="button_top_of_page" data-shortcut="0"/>
            <button type="button" class="button_first_chunk" data-shortcut="1"/>
            <button type="button" class="button_prev_file" data-shortcut="["/>
            <button type="button" class="button_next_file" data-shortcut="]"/>
            <button type="button" class="button_to_index" data-shortcut="u"/>
            <button type="button" class="button_show_hide_help" data-shortcut="?"/>
        </aside>
    </div>
</header>
<main id="source">
    <p class="run"><span class="n"><a id="t1" href="#t1">1</a></span><span class="t"><span class="key">import</span> <span class="nam">sys</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t2" href="#t2">2</a></span><span class="t"><span class="key">import</span> <span class="nam">os</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t3" href="#t3">3</a></span><span class="t"><span class="key">from</span> <span class="nam">io</span> <span class="key">import</span> <span class="nam">StringIO</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t4" href="#t4">4</a></span><span class="t"><span class="key">import</span> <span class="nam">unittest</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t5" href="#t5">5</a></span><span class="t"><span class="key">import</span> <span class="nam">requests</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t6" href="#t6">6</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t7" href="#t7">7</a></span><span class="t"><span class="nam">sys</span><span class="op">.</span><span class="nam">path</span><span class="op">.</span><span class="nam">insert</span><span class="op">(</span><span class="num">0</span><span class="op">,</span> <span class="nam">os</span><span class="op">.</span><span class="nam">path</span><span class="op">.</span><span class="nam">abspath</span><span class="op">(</span><span class="nam">os</span><span class="op">.</span><span class="nam">path</span><span class="op">.</span><span class="nam">dirname</span><span class="op">(</span><span class="nam">__file__</span><span class="op">)</span> <span class="op">+</span> <span class="str">'/..'</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t8" href="#t8">8</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t9" href="#t9">9</a></span><span class="t"><span class="com">#from collections import namedtuple</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t10" href="#t10">10</a></span><span class="t"><span class="key">from</span> <span class="nam">tempfile</span> <span class="key">import</span> <span class="nam">NamedTemporaryFile</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t11" href="#t11">11</a></span><span class="t"><span class="key">from</span> <span class="nam">treeprofiler</span> <span class="key">import</span> <span class="nam">tree_annotate</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t12" href="#t12">12</a></span><span class="t"><span class="key">from</span> <span class="nam">treeprofiler</span><span class="op">.</span><span class="nam">src</span> <span class="key">import</span> <span class="nam">utils</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t13" href="#t13">13</a></span><span class="t"><span class="key">from</span> <span class="nam">ete4</span> <span class="key">import</span> <span class="nam">GTDBTaxa</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t14" href="#t14">14</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t15" href="#t15">15</a></span><span class="t"><span class="com"># GTDB_r202_url = "https://github.com/etetoolkit/ete-data/raw/main/gtdb_taxonomy/gtdb202/gtdb202dump.tar.gz"</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t16" href="#t16">16</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t17" href="#t17">17</a></span><span class="t"><span class="com"># def update_gtdb_r202():</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t18" href="#t18">18</a></span><span class="t"><span class="com">#     gtdb = GTDBTaxa()</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t19" href="#t19">19</a></span><span class="t"><span class="com">#     fname = "gtdb202dump.tar.gz"</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t20" href="#t20">20</a></span><span class="t"><span class="com">#     #utils.download_file(GTDB_r202_url, "gtdb202dump.tar.gz")</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t21" href="#t21">21</a></span><span class="t"><span class="com">#     if not os.path.exists(fname):</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t22" href="#t22">22</a></span><span class="t"><span class="com">#         print(f'Downloading {fname} from {GTDB_r202_url} ... for testing GTDB taxonomic annotation')</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t23" href="#t23">23</a></span><span class="t"><span class="com">#         with open(fname, 'wb') as f:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t24" href="#t24">24</a></span><span class="t"><span class="com">#             f.write(requests.get(GTDB_r202_url).content)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t25" href="#t25">25</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t26" href="#t26">26</a></span><span class="t"><span class="com">#     gtdb.update_taxonomy_database("gtdb202dump.tar.gz")</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t27" href="#t27">27</a></span><span class="t"><span class="com">#     os.remove(fname)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t28" href="#t28">28</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t29" href="#t29">29</a></span><span class="t"><span class="com"># need gtdb release to be 202</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t30" href="#t30">30</a></span><span class="t"><span class="com">#update_gtdb_r202()</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t31" href="#t31">31</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t32" href="#t32">32</a></span><span class="t"><span class="key">class</span> <span class="nam">TestNCBITaxonomy</span><span class="op">(</span><span class="nam">unittest</span><span class="op">.</span><span class="nam">TestCase</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t33" href="#t33">33</a></span><span class="t">    <span class="key">def</span> <span class="nam">test_annotate_taxnomic_NCBI_01</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t34" href="#t34">34</a></span><span class="t">        <span class="com"># taxid in the leaf name</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t35" href="#t35">35</a></span><span class="t">        <span class="nam">sp_delimiter</span> <span class="op">=</span> <span class="str">''</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t36" href="#t36">36</a></span><span class="t">        <span class="nam">sp_field</span> <span class="op">=</span> <span class="str">''</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t37" href="#t37">37</a></span><span class="t">        <span class="nam">test_tree</span> <span class="op">=</span> <span class="nam">utils</span><span class="op">.</span><span class="nam">ete4_parse</span><span class="op">(</span><span class="str">"((9598, 9606), 10090);"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t38" href="#t38">38</a></span><span class="t">        <span class="nam">test_tree_annotated</span><span class="op">,</span> <span class="nam">rank2values</span> <span class="op">=</span> <span class="nam">tree_annotate</span><span class="op">.</span><span class="nam">annotate_taxa</span><span class="op">(</span><span class="nam">test_tree</span><span class="op">,</span> <span class="nam">db</span><span class="op">=</span><span class="str">'NCBI'</span><span class="op">,</span> <span class="nam">taxid_attr</span><span class="op">=</span><span class="str">"name"</span><span class="op">,</span> <span class="nam">sp_delimiter</span><span class="op">=</span><span class="nam">sp_delimiter</span><span class="op">,</span> <span class="nam">sp_field</span><span class="op">=</span><span class="nam">sp_field</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t39" href="#t39">39</a></span><span class="t">        <span class="nam">expected_tree</span> <span class="op">=</span> <span class="str">"((9598:1[&amp;&amp;NHX:taxid=9598:sci_name=Pan troglodytes:common_name=Pan troglodytes:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598|9596|9598:rank=species:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Pan|Pan troglodytes|Hominidae|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria],9606:1[&amp;&amp;NHX:taxid=9606:sci_name=Homo sapiens:common_name=Homo sapiens:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598|9605|9606:rank=species:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Hominidae|Homo|Homo sapiens|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria]):1[&amp;&amp;NHX:taxid=207598:sci_name=Homininae:common_name=:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598:rank=subfamily:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Hominidae|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria],10090:1[&amp;&amp;NHX:taxid=10090:sci_name=Mus musculus:common_name=Mus musculus:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|314147|9989|1963758|337687|10066|39107|10088|862507|10090:rank=species:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Rodentia|Muridae|Mus|Mus musculus|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Murinae|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Euarchontoglires|Glires|Muroidea|Mus|Dipnotetrapodomorpha|Boreoeutheria|Myomorpha]);"</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t40" href="#t40">40</a></span><span class="t">        <span class="nam">props</span> <span class="op">=</span> <span class="op">[</span><span class="str">'taxid'</span><span class="op">,</span> <span class="str">'sci_name'</span><span class="op">,</span> <span class="str">'common_name'</span><span class="op">,</span> <span class="str">'lineage'</span><span class="op">,</span> <span class="str">'rank'</span><span class="op">,</span> <span class="str">'named_lineage'</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t41" href="#t41">41</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">assertEqual</span><span class="op">(</span><span class="nam">test_tree_annotated</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">props</span><span class="op">=</span><span class="nam">props</span><span class="op">,</span> <span class="nam">parser</span><span class="op">=</span><span class="num">1</span><span class="op">)</span><span class="op">,</span> <span class="nam">expected_tree</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t42" href="#t42">42</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t43" href="#t43">43</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t44" href="#t44">44</a></span><span class="t">    <span class="key">def</span> <span class="nam">test_annotate_taxnomic_NCBI_02</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t45" href="#t45">45</a></span><span class="t">        <span class="com"># taxid in the leaf name</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t46" href="#t46">46</a></span><span class="t">        <span class="nam">test_tree</span> <span class="op">=</span> <span class="nam">utils</span><span class="op">.</span><span class="nam">ete4_parse</span><span class="op">(</span><span class="str">"((9598.abc, 9606.nca), 10090.abd);"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t47" href="#t47">47</a></span><span class="t">        <span class="nam">test_tree_annotated</span><span class="op">,</span> <span class="nam">rank2values</span> <span class="op">=</span> <span class="nam">tree_annotate</span><span class="op">.</span><span class="nam">annotate_taxa</span><span class="op">(</span><span class="nam">test_tree</span><span class="op">,</span> <span class="nam">db</span><span class="op">=</span><span class="str">'NCBI'</span><span class="op">,</span> <span class="nam">taxid_attr</span><span class="op">=</span><span class="str">"name"</span><span class="op">,</span> <span class="nam">sp_delimiter</span><span class="op">=</span><span class="str">'.'</span><span class="op">,</span> <span class="nam">sp_field</span><span class="op">=</span><span class="num">0</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t48" href="#t48">48</a></span><span class="t">        <span class="nam">props</span> <span class="op">=</span> <span class="op">[</span><span class="str">'taxid'</span><span class="op">,</span> <span class="str">'sci_name'</span><span class="op">,</span> <span class="str">'common_name'</span><span class="op">,</span> <span class="str">'lineage'</span><span class="op">,</span> <span class="str">'rank'</span><span class="op">,</span> <span class="str">'named_lineage'</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t49" href="#t49">49</a></span><span class="t">        <span class="nam">expected_tree</span> <span class="op">=</span> <span class="str">"((9598.abc:1[&amp;&amp;NHX:taxid=9598:sci_name=Pan troglodytes:common_name=Pan troglodytes:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598|9596|9598:rank=species:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Pan|Pan troglodytes|Hominidae|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria],9606.nca:1[&amp;&amp;NHX:taxid=9606:sci_name=Homo sapiens:common_name=Homo sapiens:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598|9605|9606:rank=species:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Hominidae|Homo|Homo sapiens|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria]):1[&amp;&amp;NHX:taxid=207598:sci_name=Homininae:common_name=:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598:rank=subfamily:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Hominidae|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria],10090.abd:1[&amp;&amp;NHX:taxid=10090:sci_name=Mus musculus:common_name=Mus musculus:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|314147|9989|1963758|337687|10066|39107|10088|862507|10090:rank=species:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Rodentia|Muridae|Mus|Mus musculus|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Murinae|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Euarchontoglires|Glires|Muroidea|Mus|Dipnotetrapodomorpha|Boreoeutheria|Myomorpha]);"</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t50" href="#t50">50</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">assertEqual</span><span class="op">(</span><span class="nam">test_tree_annotated</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">props</span><span class="op">=</span><span class="nam">props</span><span class="op">,</span> <span class="nam">parser</span><span class="op">=</span><span class="num">1</span><span class="op">)</span><span class="op">,</span> <span class="nam">expected_tree</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t51" href="#t51">51</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t52" href="#t52">52</a></span><span class="t">    <span class="key">def</span> <span class="nam">test_annotate_taxnomic_NCBI_03</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t53" href="#t53">53</a></span><span class="t">        <span class="com"># ncbi_id in the other column </span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t54" href="#t54">54</a></span><span class="t">        <span class="nam">test_tree</span> <span class="op">=</span> <span class="nam">utils</span><span class="op">.</span><span class="nam">ete4_parse</span><span class="op">(</span><span class="str">"(A:1,((B:1,D:1):1,E:1):1);"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t55" href="#t55">55</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t56" href="#t56">56</a></span><span class="t">        <span class="key">with</span> <span class="nam">NamedTemporaryFile</span><span class="op">(</span><span class="nam">suffix</span><span class="op">=</span><span class="str">'.tsv'</span><span class="op">)</span> <span class="key">as</span> <span class="nam">f_annotation</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t57" href="#t57">57</a></span><span class="t">            <span class="nam">f_annotation</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="str">b'#name\tncbi_id\nA\t7707\nB\t9606\nD\t9598\nE\t10090\n'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t58" href="#t58">58</a></span><span class="t">            <span class="nam">f_annotation</span><span class="op">.</span><span class="nam">flush</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t59" href="#t59">59</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t60" href="#t60">60</a></span><span class="t">            <span class="nam">metadata_dict</span><span class="op">,</span> <span class="nam">node_props</span><span class="op">,</span> <span class="nam">columns</span><span class="op">,</span> <span class="nam">prop2type</span> <span class="op">=</span> <span class="nam">tree_annotate</span><span class="op">.</span><span class="nam">parse_csv</span><span class="op">(</span><span class="op">[</span><span class="nam">f_annotation</span><span class="op">.</span><span class="nam">name</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t61" href="#t61">61</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t62" href="#t62">62</a></span><span class="t">        <span class="nam">test_tree_annotated</span><span class="op">,</span> <span class="nam">annotated_prop2type</span> <span class="op">=</span> <span class="nam">tree_annotate</span><span class="op">.</span><span class="nam">run_tree_annotate</span><span class="op">(</span><span class="nam">test_tree</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t63" href="#t63">63</a></span><span class="t">            <span class="nam">metadata_dict</span><span class="op">=</span><span class="nam">metadata_dict</span><span class="op">,</span> <span class="nam">node_props</span><span class="op">=</span><span class="nam">node_props</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t64" href="#t64">64</a></span><span class="t">            <span class="nam">columns</span><span class="op">=</span><span class="nam">columns</span><span class="op">,</span> <span class="nam">prop2type</span><span class="op">=</span><span class="nam">prop2type</span><span class="op">,</span> <span class="nam">taxadb</span><span class="op">=</span><span class="str">'NCBI'</span><span class="op">,</span> <span class="nam">taxon_column</span><span class="op">=</span><span class="str">'ncbi_id'</span><span class="op">,</span> <span class="nam">taxon_delimiter</span><span class="op">=</span><span class="str">''</span><span class="op">,</span> <span class="nam">taxa_field</span><span class="op">=</span><span class="num">0</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t65" href="#t65">65</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t66" href="#t66">66</a></span><span class="t">        <span class="nam">expected_tree_no_root</span> <span class="op">=</span> <span class="str">'(A:1[&amp;&amp;NHX:taxid=7707:ncbi_id=7707:sci_name=Dendrochirotida:rank=order:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa],((B:1[&amp;&amp;NHX:taxid=9606:ncbi_id=9606:sci_name=Homo sapiens:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598|9605|9606:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Hominidae|Homo|Homo sapiens|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria],D:1[&amp;&amp;NHX:taxid=9598:ncbi_id=9598:sci_name=Pan troglodytes:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598|9596|9598:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Pan|Pan troglodytes|Hominidae|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria])N3:1[&amp;&amp;NHX:taxid=207598:sci_name=Homininae:rank=subfamily:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Hominidae|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria],E:1[&amp;&amp;NHX:taxid=10090:ncbi_id=10090:sci_name=Mus musculus:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|314147|9989|1963758|337687|10066|39107|10088|862507|10090:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Rodentia|Muridae|Mus|Mus musculus|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Murinae|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Euarchontoglires|Glires|Muroidea|Mus|Dipnotetrapodomorpha|Boreoeutheria|Myomorpha])N5:1[&amp;&amp;NHX:taxid=314146:sci_name=Euarchontoglires:rank=superorder:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Euarchontoglires|Dipnotetrapodomorpha|Boreoeutheria]);'</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t67" href="#t67">67</a></span><span class="t">        <span class="nam">expected_tree_with_root</span> <span class="op">=</span> <span class="str">'(A:1[&amp;&amp;NHX:taxid=7707:ncbi_id=7707:sci_name=Dendrochirotida:rank=order:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa],((B:1[&amp;&amp;NHX:taxid=9606:ncbi_id=9606:sci_name=Homo sapiens:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598|9605|9606:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Hominidae|Homo|Homo sapiens|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria],D:1[&amp;&amp;NHX:taxid=9598:ncbi_id=9598:sci_name=Pan troglodytes:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598|9596|9598:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Pan|Pan troglodytes|Hominidae|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria])N3:1[&amp;&amp;NHX:taxid=207598:sci_name=Homininae:rank=subfamily:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Hominidae|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria],E:1[&amp;&amp;NHX:taxid=10090:ncbi_id=10090:sci_name=Mus musculus:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|314147|9989|1963758|337687|10066|39107|10088|862507|10090:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Rodentia|Muridae|Mus|Mus musculus|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Murinae|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Euarchontoglires|Glires|Muroidea|Mus|Dipnotetrapodomorpha|Boreoeutheria|Myomorpha])N5:1[&amp;&amp;NHX:taxid=314146:sci_name=Euarchontoglires:rank=superorder:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Euarchontoglires|Dipnotetrapodomorpha|Boreoeutheria])Root[&amp;&amp;NHX:taxid=33511:sci_name=Deuterostomia:rank=clade:lineage=1|131567|2759|33154|33208|6072|33213|33511:named_lineage=root|Eukaryota|Eumetazoa|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms];'</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t68" href="#t68">68</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t69" href="#t69">69</a></span><span class="t">        <span class="nam">show_properties</span> <span class="op">=</span> <span class="op">[</span><span class="str">'taxid'</span><span class="op">,</span> <span class="str">'ncbi_id'</span><span class="op">,</span><span class="str">'sci_name'</span><span class="op">,</span><span class="str">'rank'</span><span class="op">,</span><span class="str">'lineage'</span><span class="op">,</span> <span class="str">'named_lineage'</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t70" href="#t70">70</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">assertEqual</span><span class="op">(</span><span class="nam">test_tree_annotated</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">props</span><span class="op">=</span><span class="nam">show_properties</span><span class="op">,</span> <span class="nam">parser</span><span class="op">=</span><span class="num">1</span><span class="op">)</span><span class="op">,</span> <span class="nam">expected_tree_no_root</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t71" href="#t71">71</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">assertEqual</span><span class="op">(</span><span class="nam">test_tree_annotated</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">props</span><span class="op">=</span><span class="nam">show_properties</span><span class="op">,</span> <span class="nam">parser</span><span class="op">=</span><span class="num">1</span><span class="op">,</span> <span class="nam">format_root_node</span><span class="op">=</span><span class="key">True</span><span class="op">)</span><span class="op">,</span> <span class="nam">expected_tree_with_root</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t72" href="#t72">72</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t73" href="#t73">73</a></span><span class="t">    <span class="key">def</span> <span class="nam">test_annotate_taxnomic_NCBI_04</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t74" href="#t74">74</a></span><span class="t">        <span class="com"># ncbi_id in the other column </span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t75" href="#t75">75</a></span><span class="t">        <span class="nam">test_tree</span> <span class="op">=</span> <span class="nam">utils</span><span class="op">.</span><span class="nam">ete4_parse</span><span class="op">(</span><span class="str">"(A:1,((B:1,D:1):1,E:1):1);"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t76" href="#t76">76</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t77" href="#t77">77</a></span><span class="t">        <span class="key">with</span> <span class="nam">NamedTemporaryFile</span><span class="op">(</span><span class="nam">suffix</span><span class="op">=</span><span class="str">'.tsv'</span><span class="op">)</span> <span class="key">as</span> <span class="nam">f_annotation</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t78" href="#t78">78</a></span><span class="t">            <span class="nam">f_annotation</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="str">b'#name\tncbi_id\nA\t7707.abc\nB\t9606.acs\nD\t9598.asd\nE\t10090.sds\n'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t79" href="#t79">79</a></span><span class="t">            <span class="nam">f_annotation</span><span class="op">.</span><span class="nam">flush</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t80" href="#t80">80</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t81" href="#t81">81</a></span><span class="t">            <span class="nam">metadata_dict</span><span class="op">,</span> <span class="nam">node_props</span><span class="op">,</span> <span class="nam">columns</span><span class="op">,</span> <span class="nam">prop2type</span> <span class="op">=</span> <span class="nam">tree_annotate</span><span class="op">.</span><span class="nam">parse_csv</span><span class="op">(</span><span class="op">[</span><span class="nam">f_annotation</span><span class="op">.</span><span class="nam">name</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t82" href="#t82">82</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t83" href="#t83">83</a></span><span class="t">        <span class="nam">test_tree_annotated</span><span class="op">,</span> <span class="nam">annotated_prop2type</span> <span class="op">=</span> <span class="nam">tree_annotate</span><span class="op">.</span><span class="nam">run_tree_annotate</span><span class="op">(</span><span class="nam">test_tree</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t84" href="#t84">84</a></span><span class="t">            <span class="nam">metadata_dict</span><span class="op">=</span><span class="nam">metadata_dict</span><span class="op">,</span> <span class="nam">node_props</span><span class="op">=</span><span class="nam">node_props</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t85" href="#t85">85</a></span><span class="t">            <span class="nam">columns</span><span class="op">=</span><span class="nam">columns</span><span class="op">,</span> <span class="nam">prop2type</span><span class="op">=</span><span class="nam">prop2type</span><span class="op">,</span> <span class="nam">taxadb</span><span class="op">=</span><span class="str">'NCBI'</span><span class="op">,</span> <span class="nam">taxon_column</span><span class="op">=</span><span class="str">'ncbi_id'</span><span class="op">,</span> <span class="nam">taxon_delimiter</span><span class="op">=</span><span class="str">'.'</span><span class="op">,</span> <span class="nam">taxa_field</span><span class="op">=</span><span class="num">0</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t86" href="#t86">86</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t87" href="#t87">87</a></span><span class="t">        <span class="nam">expected_tree_no_root</span> <span class="op">=</span> <span class="str">'(A:1[&amp;&amp;NHX:taxid=7707:ncbi_id=7707:sci_name=Dendrochirotida:rank=order:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa],((B:1[&amp;&amp;NHX:taxid=9606:ncbi_id=9606:sci_name=Homo sapiens:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598|9605|9606:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Hominidae|Homo|Homo sapiens|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria],D:1[&amp;&amp;NHX:taxid=9598:ncbi_id=9598:sci_name=Pan troglodytes:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598|9596|9598:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Pan|Pan troglodytes|Hominidae|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria])N3:1[&amp;&amp;NHX:taxid=207598:sci_name=Homininae:rank=subfamily:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Hominidae|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria],E:1[&amp;&amp;NHX:taxid=10090:ncbi_id=10090:sci_name=Mus musculus:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|314147|9989|1963758|337687|10066|39107|10088|862507|10090:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Rodentia|Muridae|Mus|Mus musculus|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Murinae|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Euarchontoglires|Glires|Muroidea|Mus|Dipnotetrapodomorpha|Boreoeutheria|Myomorpha])N5:1[&amp;&amp;NHX:taxid=314146:sci_name=Euarchontoglires:rank=superorder:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Euarchontoglires|Dipnotetrapodomorpha|Boreoeutheria]);'</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t88" href="#t88">88</a></span><span class="t">        <span class="nam">expected_tree_with_root</span> <span class="op">=</span> <span class="str">'(A:1[&amp;&amp;NHX:taxid=7707:ncbi_id=7707:sci_name=Dendrochirotida:rank=order:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa],((B:1[&amp;&amp;NHX:taxid=9606:ncbi_id=9606:sci_name=Homo sapiens:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598|9605|9606:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Hominidae|Homo|Homo sapiens|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria],D:1[&amp;&amp;NHX:taxid=9598:ncbi_id=9598:sci_name=Pan troglodytes:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598|9596|9598:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Pan|Pan troglodytes|Hominidae|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria])N3:1[&amp;&amp;NHX:taxid=207598:sci_name=Homininae:rank=subfamily:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|9443|376913|314293|9526|314295|9604|207598:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Primates|Catarrhini|Hominidae|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Homininae|Euarchontoglires|Simiiformes|Hominoidea|Haplorrhini|Dipnotetrapodomorpha|Boreoeutheria],E:1[&amp;&amp;NHX:taxid=10090:ncbi_id=10090:sci_name=Mus musculus:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146|314147|9989|1963758|337687|10066|39107|10088|862507|10090:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Rodentia|Muridae|Mus|Mus musculus|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Murinae|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Euarchontoglires|Glires|Muroidea|Mus|Dipnotetrapodomorpha|Boreoeutheria|Myomorpha])N5:1[&amp;&amp;NHX:taxid=314146:sci_name=Euarchontoglires:rank=superorder:lineage=1|131567|2759|33154|33208|6072|33213|33511|7711|89593|7742|7776|117570|117571|8287|1338369|32523|32524|40674|32525|9347|1437010|314146:named_lineage=root|Eukaryota|Eumetazoa|Chordata|Vertebrata|Gnathostomata|Sarcopterygii|Eutheria|Tetrapoda|Amniota|Theria|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Mammalia|Craniata|Teleostomi|Euteleostomi|cellular organisms|Euarchontoglires|Dipnotetrapodomorpha|Boreoeutheria])Root[&amp;&amp;NHX:taxid=33511:sci_name=Deuterostomia:rank=clade:lineage=1|131567|2759|33154|33208|6072|33213|33511:named_lineage=root|Eukaryota|Eumetazoa|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms];'</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t89" href="#t89">89</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t90" href="#t90">90</a></span><span class="t">        <span class="nam">show_properties</span> <span class="op">=</span> <span class="op">[</span><span class="str">'taxid'</span><span class="op">,</span> <span class="str">'ncbi_id'</span><span class="op">,</span><span class="str">'sci_name'</span><span class="op">,</span><span class="str">'rank'</span><span class="op">,</span><span class="str">'lineage'</span><span class="op">,</span> <span class="str">'named_lineage'</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t91" href="#t91">91</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">assertEqual</span><span class="op">(</span><span class="nam">test_tree_annotated</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">props</span><span class="op">=</span><span class="nam">show_properties</span><span class="op">,</span> <span class="nam">parser</span><span class="op">=</span><span class="num">1</span><span class="op">)</span><span class="op">,</span> <span class="nam">expected_tree_no_root</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t92" href="#t92">92</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">assertEqual</span><span class="op">(</span><span class="nam">test_tree_annotated</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">props</span><span class="op">=</span><span class="nam">show_properties</span><span class="op">,</span> <span class="nam">parser</span><span class="op">=</span><span class="num">1</span><span class="op">,</span> <span class="nam">format_root_node</span><span class="op">=</span><span class="key">True</span><span class="op">)</span><span class="op">,</span> <span class="nam">expected_tree_with_root</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t93" href="#t93">93</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t94" href="#t94">94</a></span><span class="t"><span class="key">class</span> <span class="nam">TestGTDBTaxonomy</span><span class="op">(</span><span class="nam">unittest</span><span class="op">.</span><span class="nam">TestCase</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t95" href="#t95">95</a></span><span class="t">    <span class="key">def</span> <span class="nam">update_taxadb</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t96" href="#t96">96</a></span><span class="t">        <span class="com"># download GTDB taxonomy</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t97" href="#t97">97</a></span><span class="t">        <span class="nam">gtdb_version</span> <span class="op">=</span> <span class="num">202</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t98" href="#t98">98</a></span><span class="t">        <span class="nam">gtdbtaxadump</span> <span class="op">=</span> <span class="nam">tree_annotate</span><span class="op">.</span><span class="nam">get_gtdbtaxadump</span><span class="op">(</span><span class="nam">gtdb_version</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t99" href="#t99">99</a></span><span class="t">        <span class="nam">GTDBTaxa</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="nam">update_taxonomy_database</span><span class="op">(</span><span class="nam">gtdbtaxadump</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t100" href="#t100">100</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t101" href="#t101">101</a></span><span class="t">    <span class="key">def</span> <span class="nam">test_annotate_taxnomic_GTDB_01</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t102" href="#t102">102</a></span><span class="t">        <span class="com"># taxid in the leaf name</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t103" href="#t103">103</a></span><span class="t">        <span class="com"># (GB_GCA_011358815.1@sample1:1,(RS_GCF_000019605.1@sample2:1,(RS_GCF_003948265.1@sample3:1,GB_GCA_003344655.1@sample4:1)1:0.5)1:0.5);</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t104" href="#t104">104</a></span><span class="t">        <span class="nam">test_tree</span> <span class="op">=</span> <span class="nam">utils</span><span class="op">.</span><span class="nam">ete4_parse</span><span class="op">(</span><span class="str">"(GB_GCA_011358815.1:1,(RS_GCF_000019605.1:1,(RS_GCF_003948265.1:1,GB_GCA_003344655.1:1):0.5):0.5);"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t105" href="#t105">105</a></span><span class="t">        <span class="nam">test_tree_annotated</span><span class="op">,</span> <span class="nam">rank2values</span> <span class="op">=</span> <span class="nam">tree_annotate</span><span class="op">.</span><span class="nam">annotate_taxa</span><span class="op">(</span><span class="nam">test_tree</span><span class="op">,</span> <span class="nam">db</span><span class="op">=</span><span class="str">'GTDB'</span><span class="op">,</span> <span class="nam">taxid_attr</span><span class="op">=</span><span class="str">"name"</span><span class="op">,</span> <span class="nam">sp_delimiter</span><span class="op">=</span><span class="str">''</span><span class="op">,</span> <span class="nam">sp_field</span><span class="op">=</span><span class="num">0</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t106" href="#t106">106</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t107" href="#t107">107</a></span><span class="t">        <span class="nam">expected_tree_no_root</span> <span class="op">=</span> <span class="str">'(GB_GCA_011358815.1:1[&amp;&amp;NHX:taxid=GB_GCA_011358815.1:sci_name=s__Korarchaeum cryptofilum:common_name=:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|GB_GCA_011358815.1],(RS_GCF_000019605.1:1[&amp;&amp;NHX:taxid=RS_GCF_000019605.1:sci_name=s__Korarchaeum cryptofilum:common_name=:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|RS_GCF_000019605.1],(RS_GCF_003948265.1:1[&amp;&amp;NHX:taxid=RS_GCF_003948265.1:sci_name=s__Korarchaeum cryptofilum:common_name=:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|RS_GCF_003948265.1],GB_GCA_003344655.1:1[&amp;&amp;NHX:taxid=GB_GCA_003344655.1:sci_name=s__Korarchaeum sp003344655:common_name=:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum sp003344655|GB_GCA_003344655.1]):0.5[&amp;&amp;NHX:taxid=g__Korarchaeum:sci_name=g__Korarchaeum:common_name=:rank=genus:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum]):0.5[&amp;&amp;NHX:taxid=g__Korarchaeum:sci_name=g__Korarchaeum:common_name=:rank=genus:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum]);'</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t108" href="#t108">108</a></span><span class="t">        <span class="nam">expected_tree_with_root</span> <span class="op">=</span> <span class="str">'(GB_GCA_011358815.1:1[&amp;&amp;NHX:taxid=GB_GCA_011358815.1:sci_name=s__Korarchaeum cryptofilum:common_name=:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|GB_GCA_011358815.1],(RS_GCF_000019605.1:1[&amp;&amp;NHX:taxid=RS_GCF_000019605.1:sci_name=s__Korarchaeum cryptofilum:common_name=:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|RS_GCF_000019605.1],(RS_GCF_003948265.1:1[&amp;&amp;NHX:taxid=RS_GCF_003948265.1:sci_name=s__Korarchaeum cryptofilum:common_name=:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|RS_GCF_003948265.1],GB_GCA_003344655.1:1[&amp;&amp;NHX:taxid=GB_GCA_003344655.1:sci_name=s__Korarchaeum sp003344655:common_name=:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum sp003344655|GB_GCA_003344655.1]):0.5[&amp;&amp;NHX:taxid=g__Korarchaeum:sci_name=g__Korarchaeum:common_name=:rank=genus:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum]):0.5[&amp;&amp;NHX:taxid=g__Korarchaeum:sci_name=g__Korarchaeum:common_name=:rank=genus:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum])[&amp;&amp;NHX:taxid=g__Korarchaeum:sci_name=g__Korarchaeum:common_name=:rank=genus:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum];'</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t109" href="#t109">109</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t110" href="#t110">110</a></span><span class="t">        <span class="nam">props</span> <span class="op">=</span> <span class="op">[</span><span class="str">'taxid'</span><span class="op">,</span> <span class="str">'sci_name'</span><span class="op">,</span> <span class="str">'common_name'</span><span class="op">,</span> <span class="str">'rank'</span><span class="op">,</span> <span class="str">'named_lineage'</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t111" href="#t111">111</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">assertEqual</span><span class="op">(</span><span class="nam">test_tree_annotated</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">props</span><span class="op">=</span><span class="nam">props</span><span class="op">,</span> <span class="nam">parser</span><span class="op">=</span><span class="num">1</span><span class="op">)</span><span class="op">,</span> <span class="nam">expected_tree_no_root</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t112" href="#t112">112</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">assertEqual</span><span class="op">(</span><span class="nam">test_tree_annotated</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">props</span><span class="op">=</span><span class="nam">props</span><span class="op">,</span> <span class="nam">parser</span><span class="op">=</span><span class="num">1</span><span class="op">,</span> <span class="nam">format_root_node</span><span class="op">=</span><span class="key">True</span><span class="op">)</span><span class="op">,</span> <span class="nam">expected_tree_with_root</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t113" href="#t113">113</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t114" href="#t114">114</a></span><span class="t">    <span class="key">def</span> <span class="nam">test_annotate_taxnomic_GTDB_02</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t115" href="#t115">115</a></span><span class="t">        <span class="com"># taxid in the other column</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t116" href="#t116">116</a></span><span class="t">        <span class="com"># (GB_GCA_011358815.1:1,(RS_GCF_000019605.1:1,(RS_GCF_003948265.1:1,GB_GCA_003344655.1:1):0.5):0.5);</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t117" href="#t117">117</a></span><span class="t">        <span class="nam">test_tree</span> <span class="op">=</span> <span class="nam">utils</span><span class="op">.</span><span class="nam">ete4_parse</span><span class="op">(</span><span class="str">"(A:1,(B:1,(C:1,D:1):0.5):0.5);"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t118" href="#t118">118</a></span><span class="t">        <span class="key">with</span> <span class="nam">NamedTemporaryFile</span><span class="op">(</span><span class="nam">suffix</span><span class="op">=</span><span class="str">'.tsv'</span><span class="op">)</span> <span class="key">as</span> <span class="nam">f_annotation</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t119" href="#t119">119</a></span><span class="t">            <span class="nam">f_annotation</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="str">b'#name\tgtdb_taxid\nA\tGB_GCA_011358815.1\nB\tRS_GCF_000019605.1\nC\tRS_GCF_003948265.1\nD\tGB_GCA_003344655.1\n'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t120" href="#t120">120</a></span><span class="t">            <span class="nam">f_annotation</span><span class="op">.</span><span class="nam">flush</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t121" href="#t121">121</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t122" href="#t122">122</a></span><span class="t">            <span class="nam">metadata_dict</span><span class="op">,</span> <span class="nam">node_props</span><span class="op">,</span> <span class="nam">columns</span><span class="op">,</span> <span class="nam">prop2type</span> <span class="op">=</span> <span class="nam">tree_annotate</span><span class="op">.</span><span class="nam">parse_csv</span><span class="op">(</span><span class="op">[</span><span class="nam">f_annotation</span><span class="op">.</span><span class="nam">name</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t123" href="#t123">123</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t124" href="#t124">124</a></span><span class="t">        <span class="nam">test_tree_annotated</span><span class="op">,</span> <span class="nam">annotated_prop2type</span> <span class="op">=</span> <span class="nam">tree_annotate</span><span class="op">.</span><span class="nam">run_tree_annotate</span><span class="op">(</span><span class="nam">test_tree</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t125" href="#t125">125</a></span><span class="t">            <span class="nam">metadata_dict</span><span class="op">=</span><span class="nam">metadata_dict</span><span class="op">,</span> <span class="nam">node_props</span><span class="op">=</span><span class="nam">node_props</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t126" href="#t126">126</a></span><span class="t">            <span class="nam">columns</span><span class="op">=</span><span class="nam">columns</span><span class="op">,</span> <span class="nam">prop2type</span><span class="op">=</span><span class="nam">prop2type</span><span class="op">,</span> <span class="nam">taxadb</span><span class="op">=</span><span class="str">'GTDB'</span><span class="op">,</span> <span class="nam">gtdb_version</span><span class="op">=</span><span class="num">202</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t127" href="#t127">127</a></span><span class="t">            <span class="nam">taxon_column</span><span class="op">=</span><span class="str">'gtdb_taxid'</span><span class="op">,</span> <span class="nam">taxon_delimiter</span><span class="op">=</span><span class="str">''</span><span class="op">,</span> <span class="nam">taxa_field</span><span class="op">=</span><span class="num">0</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t128" href="#t128">128</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t129" href="#t129">129</a></span><span class="t">        <span class="nam">show_properties</span> <span class="op">=</span> <span class="op">[</span><span class="str">'taxid'</span><span class="op">,</span> <span class="str">'gtdb_taxid'</span><span class="op">,</span><span class="str">'sci_name'</span><span class="op">,</span><span class="str">'rank'</span><span class="op">,</span> <span class="str">'named_lineage'</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t130" href="#t130">130</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t131" href="#t131">131</a></span><span class="t">        <span class="nam">expected_tree_no_root</span> <span class="op">=</span> <span class="str">'(A:1[&amp;&amp;NHX:taxid=GB_GCA_011358815.1:gtdb_taxid=GB_GCA_011358815.1:sci_name=s__Korarchaeum cryptofilum:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|GB_GCA_011358815.1],(B:1[&amp;&amp;NHX:taxid=RS_GCF_000019605.1:gtdb_taxid=RS_GCF_000019605.1:sci_name=s__Korarchaeum cryptofilum:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|RS_GCF_000019605.1],(C:1[&amp;&amp;NHX:taxid=RS_GCF_003948265.1:gtdb_taxid=RS_GCF_003948265.1:sci_name=s__Korarchaeum cryptofilum:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|RS_GCF_003948265.1],D:1[&amp;&amp;NHX:taxid=GB_GCA_003344655.1:gtdb_taxid=GB_GCA_003344655.1:sci_name=s__Korarchaeum sp003344655:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum sp003344655|GB_GCA_003344655.1])N4:0.5[&amp;&amp;NHX:taxid=g__Korarchaeum:sci_name=g__Korarchaeum:rank=genus:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum])N5:0.5[&amp;&amp;NHX:taxid=g__Korarchaeum:sci_name=g__Korarchaeum:rank=genus:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum]);'</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t132" href="#t132">132</a></span><span class="t">        <span class="nam">expected_tree_with_root</span> <span class="op">=</span> <span class="str">'(A:1[&amp;&amp;NHX:taxid=GB_GCA_011358815.1:gtdb_taxid=GB_GCA_011358815.1:sci_name=s__Korarchaeum cryptofilum:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|GB_GCA_011358815.1],(B:1[&amp;&amp;NHX:taxid=RS_GCF_000019605.1:gtdb_taxid=RS_GCF_000019605.1:sci_name=s__Korarchaeum cryptofilum:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|RS_GCF_000019605.1],(C:1[&amp;&amp;NHX:taxid=RS_GCF_003948265.1:gtdb_taxid=RS_GCF_003948265.1:sci_name=s__Korarchaeum cryptofilum:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|RS_GCF_003948265.1],D:1[&amp;&amp;NHX:taxid=GB_GCA_003344655.1:gtdb_taxid=GB_GCA_003344655.1:sci_name=s__Korarchaeum sp003344655:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum sp003344655|GB_GCA_003344655.1])N4:0.5[&amp;&amp;NHX:taxid=g__Korarchaeum:sci_name=g__Korarchaeum:rank=genus:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum])N5:0.5[&amp;&amp;NHX:taxid=g__Korarchaeum:sci_name=g__Korarchaeum:rank=genus:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum])Root[&amp;&amp;NHX:taxid=g__Korarchaeum:sci_name=g__Korarchaeum:rank=genus:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum];'</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t133" href="#t133">133</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t134" href="#t134">134</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">assertEqual</span><span class="op">(</span><span class="nam">test_tree_annotated</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">props</span><span class="op">=</span><span class="nam">show_properties</span><span class="op">,</span> <span class="nam">parser</span><span class="op">=</span><span class="num">1</span><span class="op">)</span><span class="op">,</span> <span class="nam">expected_tree_no_root</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t135" href="#t135">135</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">assertEqual</span><span class="op">(</span><span class="nam">test_tree_annotated</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">props</span><span class="op">=</span><span class="nam">show_properties</span><span class="op">,</span> <span class="nam">parser</span><span class="op">=</span><span class="num">1</span><span class="op">,</span> <span class="nam">format_root_node</span><span class="op">=</span><span class="key">True</span><span class="op">)</span><span class="op">,</span> <span class="nam">expected_tree_with_root</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t136" href="#t136">136</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t137" href="#t137">137</a></span><span class="t">    <span class="key">def</span> <span class="nam">test_annotate_taxnomic_GTDB_03</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t138" href="#t138">138</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t139" href="#t139">139</a></span><span class="t">        <span class="com"># taxid in the other column</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t140" href="#t140">140</a></span><span class="t">        <span class="com"># (GB_GCA_011358815.1:1,(RS_GCF_000019605.1:1,(RS_GCF_003948265.1:1,GB_GCA_003344655.1:1):0.5):0.5);</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t141" href="#t141">141</a></span><span class="t">        <span class="nam">test_tree</span> <span class="op">=</span> <span class="nam">utils</span><span class="op">.</span><span class="nam">ete4_parse</span><span class="op">(</span><span class="str">"(A:1,(B:1,(C:1,D:1):0.5):0.5);"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t142" href="#t142">142</a></span><span class="t">        <span class="key">with</span> <span class="nam">NamedTemporaryFile</span><span class="op">(</span><span class="nam">suffix</span><span class="op">=</span><span class="str">'.tsv'</span><span class="op">)</span> <span class="key">as</span> <span class="nam">f_annotation</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t143" href="#t143">143</a></span><span class="t">            <span class="nam">f_annotation</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="str">b'#name\tgtdb_taxid\nA\tGB_GCA_011358815.1@sample1\nB\tRS_GCF_000019605.1@sample2\nC\tRS_GCF_003948265.1@sample3\nD\tGB_GCA_003344655.1@sample4\n'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t144" href="#t144">144</a></span><span class="t">            <span class="nam">f_annotation</span><span class="op">.</span><span class="nam">flush</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t145" href="#t145">145</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t146" href="#t146">146</a></span><span class="t">            <span class="nam">metadata_dict</span><span class="op">,</span> <span class="nam">node_props</span><span class="op">,</span> <span class="nam">columns</span><span class="op">,</span> <span class="nam">prop2type</span> <span class="op">=</span> <span class="nam">tree_annotate</span><span class="op">.</span><span class="nam">parse_csv</span><span class="op">(</span><span class="op">[</span><span class="nam">f_annotation</span><span class="op">.</span><span class="nam">name</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t147" href="#t147">147</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t148" href="#t148">148</a></span><span class="t">        <span class="nam">test_tree_annotated</span><span class="op">,</span> <span class="nam">annotated_prop2type</span> <span class="op">=</span> <span class="nam">tree_annotate</span><span class="op">.</span><span class="nam">run_tree_annotate</span><span class="op">(</span><span class="nam">test_tree</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t149" href="#t149">149</a></span><span class="t">            <span class="nam">metadata_dict</span><span class="op">=</span><span class="nam">metadata_dict</span><span class="op">,</span> <span class="nam">node_props</span><span class="op">=</span><span class="nam">node_props</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t150" href="#t150">150</a></span><span class="t">            <span class="nam">columns</span><span class="op">=</span><span class="nam">columns</span><span class="op">,</span> <span class="nam">prop2type</span><span class="op">=</span><span class="nam">prop2type</span><span class="op">,</span> <span class="nam">taxadb</span><span class="op">=</span><span class="str">'GTDB'</span><span class="op">,</span> <span class="nam">gtdb_version</span><span class="op">=</span><span class="num">202</span><span class="op">,</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t151" href="#t151">151</a></span><span class="t">            <span class="nam">taxon_column</span><span class="op">=</span><span class="str">'gtdb_taxid'</span><span class="op">,</span> <span class="nam">taxon_delimiter</span><span class="op">=</span><span class="str">'@'</span><span class="op">,</span> <span class="nam">taxa_field</span><span class="op">=</span><span class="num">0</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t152" href="#t152">152</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t153" href="#t153">153</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t154" href="#t154">154</a></span><span class="t">        <span class="nam">show_properties</span> <span class="op">=</span> <span class="op">[</span><span class="str">'taxid'</span><span class="op">,</span> <span class="str">'gtdb_taxid'</span><span class="op">,</span><span class="str">'sci_name'</span><span class="op">,</span><span class="str">'rank'</span><span class="op">,</span> <span class="str">'named_lineage'</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t155" href="#t155">155</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t156" href="#t156">156</a></span><span class="t">        <span class="nam">expected_tree_no_root</span> <span class="op">=</span> <span class="str">'(A:1[&amp;&amp;NHX:taxid=GB_GCA_011358815.1:gtdb_taxid=GB_GCA_011358815.1:sci_name=s__Korarchaeum cryptofilum:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|GB_GCA_011358815.1],(B:1[&amp;&amp;NHX:taxid=RS_GCF_000019605.1:gtdb_taxid=RS_GCF_000019605.1:sci_name=s__Korarchaeum cryptofilum:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|RS_GCF_000019605.1],(C:1[&amp;&amp;NHX:taxid=RS_GCF_003948265.1:gtdb_taxid=RS_GCF_003948265.1:sci_name=s__Korarchaeum cryptofilum:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|RS_GCF_003948265.1],D:1[&amp;&amp;NHX:taxid=GB_GCA_003344655.1:gtdb_taxid=GB_GCA_003344655.1:sci_name=s__Korarchaeum sp003344655:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum sp003344655|GB_GCA_003344655.1])N4:0.5[&amp;&amp;NHX:taxid=g__Korarchaeum:sci_name=g__Korarchaeum:rank=genus:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum])N5:0.5[&amp;&amp;NHX:taxid=g__Korarchaeum:sci_name=g__Korarchaeum:rank=genus:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum]);'</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t157" href="#t157">157</a></span><span class="t">        <span class="nam">expected_tree_with_root</span> <span class="op">=</span> <span class="str">'(A:1[&amp;&amp;NHX:taxid=GB_GCA_011358815.1:gtdb_taxid=GB_GCA_011358815.1:sci_name=s__Korarchaeum cryptofilum:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|GB_GCA_011358815.1],(B:1[&amp;&amp;NHX:taxid=RS_GCF_000019605.1:gtdb_taxid=RS_GCF_000019605.1:sci_name=s__Korarchaeum cryptofilum:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|RS_GCF_000019605.1],(C:1[&amp;&amp;NHX:taxid=RS_GCF_003948265.1:gtdb_taxid=RS_GCF_003948265.1:sci_name=s__Korarchaeum cryptofilum:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum cryptofilum|RS_GCF_003948265.1],D:1[&amp;&amp;NHX:taxid=GB_GCA_003344655.1:gtdb_taxid=GB_GCA_003344655.1:sci_name=s__Korarchaeum sp003344655:rank=subspecies:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum|s__Korarchaeum sp003344655|GB_GCA_003344655.1])N4:0.5[&amp;&amp;NHX:taxid=g__Korarchaeum:sci_name=g__Korarchaeum:rank=genus:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum])N5:0.5[&amp;&amp;NHX:taxid=g__Korarchaeum:sci_name=g__Korarchaeum:rank=genus:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum])Root[&amp;&amp;NHX:taxid=g__Korarchaeum:sci_name=g__Korarchaeum:rank=genus:named_lineage=root|d__Archaea|p__Thermoproteota|c__Korarchaeia|o__Korarchaeales|f__Korarchaeaceae|g__Korarchaeum];'</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t158" href="#t158">158</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t159" href="#t159">159</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">assertEqual</span><span class="op">(</span><span class="nam">test_tree_annotated</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">props</span><span class="op">=</span><span class="nam">show_properties</span><span class="op">,</span> <span class="nam">parser</span><span class="op">=</span><span class="num">1</span><span class="op">)</span><span class="op">,</span> <span class="nam">expected_tree_no_root</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t160" href="#t160">160</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">assertEqual</span><span class="op">(</span><span class="nam">test_tree_annotated</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">props</span><span class="op">=</span><span class="nam">show_properties</span><span class="op">,</span> <span class="nam">parser</span><span class="op">=</span><span class="num">1</span><span class="op">,</span> <span class="nam">format_root_node</span><span class="op">=</span><span class="key">True</span><span class="op">)</span><span class="op">,</span> <span class="nam">expected_tree_with_root</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t161" href="#t161">161</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t162" href="#t162">162</a></span><span class="t">    <span class="key">def</span> <span class="nam">test_rank_limit</span><span class="op">(</span><span class="nam">self</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t163" href="#t163">163</a></span><span class="t">        <span class="nam">test_ncbitree</span> <span class="op">=</span> <span class="nam">utils</span><span class="op">.</span><span class="nam">ete4_parse</span><span class="op">(</span><span class="str">"(((36324:1,42201:1,864673:1,864674:1,868587:1,2014662:1,(1769970:1,1769971:1,1783523:1)2.6225e+06:1)36323:1,(864665:1,864672:1,1902842:1,1966443:1,1902934:1)864664:1,1902863:1)36322:1,((28833:1,36326:1,40245:1,42202:1,42203:1,42204:1,42388:1,122241:1,864625:1,864626:1,869198:1,1898586:1,(1421346:1,2653558:1,2653559:1)2.62272e+06:1)28832:1,(42205:1,42212:1,42386:1,42387:1)42385:1,(206683:1,1690249:1,1902836:1)206682:1,(206685:1,2772383:1)206684:1,396326:1,(861480:1,1443624:1)861479:1,(864646:1,1633604:1)864645:1,864662:1,(864668:1,1207538:1,1633605:1,1902935:1,1633607:1)864667:1,(1633609:1,1777472:1)1.63361e+06:1,(1633611:1,1633612:1)1.63361e+06:1,(1633615:1,1633618:1,1633619:1)1.63361e+06:1,(1725248:1,2268661:1)1.72525e+06:1,(1902849:1,1980634:1,1980635:1)1.90285e+06:1,(1633614:1,1633616:1,1902875:1,1966442:1)1.90287e+06:1,(1980638:1,1980639:1,1980640:1,1980641:1,1980642:1,1980643:1)1.98064e+06:1,(864629:1,864631:1,864663:1)2.77157e+06:1,571821:1,864642:1,864661:1,864670:1,1622217:1,1690254:1,2268711:1,2528974:1,2576476:1,55632:1,1633606:1,2785017:1,2785214:1,2850318:1,1902940:1)36325:1,((42391:1,861476:1,861516:1,869196:1,1382469:1,(2172660:1,2172661:1)2.64079e+06:1)42390:1,(55631:1,1382468:1)55630:1,(869205:1,2172724:1,2268686:1,2268729:1)869204:1,(1238286:1,1238287:1,1239311:1)1.23828e+06:1,(1382473:1,2928469:1)1.38247e+06:1,(1382475:1,1690250:1,(1382678:1,1382679:1,1382680:1,1382681:1,1382682:1,1382683:1,1382684:1,1382685:1)2.62582e+06:1)1.38247e+06:1,(1382478:1,1382479:1,1382480:1,1933098:1,2172723:1,(1902937:1,2268728:1)2.6241e+06:1,2928468:1,2928470:1,2928471:1)1.38248e+06:1,(1382476:1,2810320:1)2.77157e+06:1,206687:1,1382471:1,(1382687:1,1382688:1)2.62497e+06:1,(1382690:1,1382691:1)2.62759e+06:1,(1382693:1,1382694:1)2.62909e+06:1,1690252:1)42389:1,((7710:1,2080421:1)7709:1,(42394:1,1774088:1,2172693:1,(2653564:1,2653565:1,2653566:1,2653567:1,2857184:1,2857185:1,2857186:1,2857213:1,2857318:1)2.65356e+06:1)42393:1,(2172754:1,2268677:1)2.17275e+06:1,206689:1,1902871:1,1966448:1,2033684:1)42392:1,(818303:1,818304:1,818305:1,857999:1,858000:1,858001:1,858002:1,858003:1,858004:1,858005:1,974485:1,2480094:1,2480095:1,2480096:1)734213:1,((864639:1,864640:1,1633603:1)864638:1,864654:1)864675:1,((1902853:1,2041650:1)1.90285e+06:1,1902938:1)1.90289e+06:1,1902861:1,1902877:1);"</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t164" href="#t164">164</a></span><span class="t">        <span class="nam">test_tree_annotated</span><span class="op">,</span> <span class="nam">rank2values</span> <span class="op">=</span> <span class="nam">tree_annotate</span><span class="op">.</span><span class="nam">annotate_taxa</span><span class="op">(</span><span class="nam">test_ncbitree</span><span class="op">,</span> <span class="nam">db</span><span class="op">=</span><span class="str">'NCBI'</span><span class="op">,</span> <span class="nam">taxid_attr</span><span class="op">=</span><span class="str">"name"</span><span class="op">,</span> <span class="nam">sp_delimiter</span><span class="op">=</span><span class="str">''</span><span class="op">,</span> <span class="nam">sp_field</span><span class="op">=</span><span class="num">0</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t165" href="#t165">165</a></span><span class="t">        <span class="nam">pruned_tree</span> <span class="op">=</span> <span class="nam">utils</span><span class="op">.</span><span class="nam">taxatree_prune</span><span class="op">(</span><span class="nam">test_tree_annotated</span><span class="op">,</span> <span class="nam">rank_limit</span><span class="op">=</span><span class="str">'family'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t166" href="#t166">166</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t167" href="#t167">167</a></span><span class="t">        <span class="nam">expected_tree_no_root</span> <span class="op">=</span> <span class="str">'(Psolidae:1[&amp;&amp;NHX:taxid=36322:sci_name=Psolidae:common_name=:rank=family:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|36322:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Psolidae|cellular organisms|Eleutherozoa],Cucumariidae:1[&amp;&amp;NHX:taxid=36325:sci_name=Cucumariidae:common_name=:rank=family:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|36325:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Cucumariidae|cellular organisms|Eleutherozoa],Phyllophoridae:1[&amp;&amp;NHX:taxid=42389:sci_name=Phyllophoridae:common_name=:rank=family:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|42389:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Phyllophoridae|cellular organisms|Eleutherozoa],Sclerodactylidae:1[&amp;&amp;NHX:taxid=42392:sci_name=Sclerodactylidae:common_name=:rank=family:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|42392:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Sclerodactylidae|cellular organisms|Eleutherozoa],(818303:1[&amp;&amp;NHX:taxid=818303:sci_name=Dendrochirotida sp. BOLD_AAB7664:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|818303:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. BOLD_AAB7664],818304:1[&amp;&amp;NHX:taxid=818304:sci_name=Dendrochirotida sp. BOLD_AAC9852:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|818304:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. BOLD_AAC9852],818305:1[&amp;&amp;NHX:taxid=818305:sci_name=Dendrochirotida sp. BOLD_AAE3748:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|818305:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. BOLD_AAE3748],857999:1[&amp;&amp;NHX:taxid=857999:sci_name=Dendrochirotida sp. ECNN112-08:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|857999:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. ECNN112-08],858000:1[&amp;&amp;NHX:taxid=858000:sci_name=Dendrochirotida sp. ECNN113-08:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|858000:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. ECNN113-08],858001:1[&amp;&amp;NHX:taxid=858001:sci_name=Dendrochirotida sp. ECNN124-08:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|858001:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. ECNN124-08],858002:1[&amp;&amp;NHX:taxid=858002:sci_name=Dendrochirotida sp. ECNN125-08:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|858002:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. ECNN125-08],858003:1[&amp;&amp;NHX:taxid=858003:sci_name=Dendrochirotida sp. ECNN126-08:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|858003:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. ECNN126-08],858004:1[&amp;&amp;NHX:taxid=858004:sci_name=Dendrochirotida sp. ECNN127-08:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|858004:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. ECNN127-08],858005:1[&amp;&amp;NHX:taxid=858005:sci_name=Dendrochirotida sp. ECNN138-08:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|858005:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. ECNN138-08],974485:1[&amp;&amp;NHX:taxid=974485:sci_name=Dendrochirotida sp. BOLD_AAN4944:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|974485:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. BOLD_AAN4944],2480094:1[&amp;&amp;NHX:taxid=2480094:sci_name=Dendrochirotida sp. WMNH-INV-07:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|2480094:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. WMNH-INV-07],2480095:1[&amp;&amp;NHX:taxid=2480095:sci_name=Dendrochirotida sp. WMNH-INV-08:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|2480095:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. WMNH-INV-08],2480096:1[&amp;&amp;NHX:taxid=2480096:sci_name=Dendrochirotida sp. WMNH-INV-09:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|2480096:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. WMNH-INV-09])734213:1[&amp;&amp;NHX:taxid=734213:sci_name=unclassified Dendrochirotida:common_name=:rank=no rank:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida],Paracucumidae:1[&amp;&amp;NHX:taxid=864675:sci_name=Paracucumidae:common_name=:rank=family:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|864675:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|Paracucumidae],Ypsilothuriidae:1[&amp;&amp;NHX:taxid=1902891:sci_name=Ypsilothuriidae:common_name=:rank=family:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|1902891:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|Ypsilothuriidae],Heterothyonidae:1[&amp;&amp;NHX:taxid=1902861:sci_name=Heterothyone alba:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|1902887|1902860|1902861:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|Heterothyone|Heterothyone alba|Heterothyonidae],Placothuriidae:1[&amp;&amp;NHX:taxid=1902877:sci_name=Placothuria squamata:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|1902888|1902876|1902877:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|Placothuria|Placothuria squamata|Placothuriidae]);'</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t168" href="#t168">168</a></span><span class="t">        <span class="nam">expected_tree_with_root</span> <span class="op">=</span> <span class="str">'(Psolidae:1[&amp;&amp;NHX:taxid=36322:sci_name=Psolidae:common_name=:rank=family:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|36322:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Psolidae|cellular organisms|Eleutherozoa],Cucumariidae:1[&amp;&amp;NHX:taxid=36325:sci_name=Cucumariidae:common_name=:rank=family:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|36325:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Cucumariidae|cellular organisms|Eleutherozoa],Phyllophoridae:1[&amp;&amp;NHX:taxid=42389:sci_name=Phyllophoridae:common_name=:rank=family:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|42389:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Phyllophoridae|cellular organisms|Eleutherozoa],Sclerodactylidae:1[&amp;&amp;NHX:taxid=42392:sci_name=Sclerodactylidae:common_name=:rank=family:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|42392:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|Sclerodactylidae|cellular organisms|Eleutherozoa],(818303:1[&amp;&amp;NHX:taxid=818303:sci_name=Dendrochirotida sp. BOLD_AAB7664:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|818303:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. BOLD_AAB7664],818304:1[&amp;&amp;NHX:taxid=818304:sci_name=Dendrochirotida sp. BOLD_AAC9852:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|818304:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. BOLD_AAC9852],818305:1[&amp;&amp;NHX:taxid=818305:sci_name=Dendrochirotida sp. BOLD_AAE3748:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|818305:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. BOLD_AAE3748],857999:1[&amp;&amp;NHX:taxid=857999:sci_name=Dendrochirotida sp. ECNN112-08:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|857999:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. ECNN112-08],858000:1[&amp;&amp;NHX:taxid=858000:sci_name=Dendrochirotida sp. ECNN113-08:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|858000:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. ECNN113-08],858001:1[&amp;&amp;NHX:taxid=858001:sci_name=Dendrochirotida sp. ECNN124-08:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|858001:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. ECNN124-08],858002:1[&amp;&amp;NHX:taxid=858002:sci_name=Dendrochirotida sp. ECNN125-08:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|858002:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. ECNN125-08],858003:1[&amp;&amp;NHX:taxid=858003:sci_name=Dendrochirotida sp. ECNN126-08:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|858003:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. ECNN126-08],858004:1[&amp;&amp;NHX:taxid=858004:sci_name=Dendrochirotida sp. ECNN127-08:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|858004:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. ECNN127-08],858005:1[&amp;&amp;NHX:taxid=858005:sci_name=Dendrochirotida sp. ECNN138-08:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|858005:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. ECNN138-08],974485:1[&amp;&amp;NHX:taxid=974485:sci_name=Dendrochirotida sp. BOLD_AAN4944:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|974485:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. BOLD_AAN4944],2480094:1[&amp;&amp;NHX:taxid=2480094:sci_name=Dendrochirotida sp. WMNH-INV-07:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|2480094:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. WMNH-INV-07],2480095:1[&amp;&amp;NHX:taxid=2480095:sci_name=Dendrochirotida sp. WMNH-INV-08:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|2480095:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. WMNH-INV-08],2480096:1[&amp;&amp;NHX:taxid=2480096:sci_name=Dendrochirotida sp. WMNH-INV-09:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213|2480096:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida|Dendrochirotida sp. WMNH-INV-09])734213:1[&amp;&amp;NHX:taxid=734213:sci_name=unclassified Dendrochirotida:common_name=:rank=no rank:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|734213:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|unclassified Dendrochirotida],Paracucumidae:1[&amp;&amp;NHX:taxid=864675:sci_name=Paracucumidae:common_name=:rank=family:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|864675:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|Paracucumidae],Ypsilothuriidae:1[&amp;&amp;NHX:taxid=1902891:sci_name=Ypsilothuriidae:common_name=:rank=family:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|1902891:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|Ypsilothuriidae],Heterothyonidae:1[&amp;&amp;NHX:taxid=1902861:sci_name=Heterothyone alba:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|1902887|1902860|1902861:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|Heterothyone|Heterothyone alba|Heterothyonidae],Placothuriidae:1[&amp;&amp;NHX:taxid=1902877:sci_name=Placothuria squamata:common_name=:rank=species:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707|1902888|1902876|1902877:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa|Placothuria|Placothuria squamata|Placothuriidae])[&amp;&amp;NHX:taxid=7707:sci_name=Dendrochirotida:common_name=:rank=order:lineage=1|131567|2759|33154|33208|6072|33213|33511|7586|133551|7624|7705|7706|7707:named_lineage=root|Eukaryota|Eumetazoa|Echinodermata|Echinozoa|Holothuroidea|Dendrochirotacea|Dendrochirotida|Opisthokonta|Metazoa|Bilateria|Deuterostomia|cellular organisms|Eleutherozoa];'</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t169" href="#t169">169</a></span><span class="t">        <span class="nam">props</span> <span class="op">=</span> <span class="op">[</span><span class="str">'taxid'</span><span class="op">,</span> <span class="str">'sci_name'</span><span class="op">,</span> <span class="str">'common_name'</span><span class="op">,</span> <span class="str">'rank'</span><span class="op">,</span> <span class="str">'lineage'</span><span class="op">,</span> <span class="str">'named_lineage'</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t170" href="#t170">170</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t171" href="#t171">171</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">assertEqual</span><span class="op">(</span><span class="nam">pruned_tree</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">props</span><span class="op">=</span><span class="nam">props</span><span class="op">,</span> <span class="nam">parser</span><span class="op">=</span><span class="num">1</span><span class="op">)</span><span class="op">,</span> <span class="nam">expected_tree_no_root</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t172" href="#t172">172</a></span><span class="t">        <span class="nam">self</span><span class="op">.</span><span class="nam">assertEqual</span><span class="op">(</span><span class="nam">pruned_tree</span><span class="op">.</span><span class="nam">write</span><span class="op">(</span><span class="nam">props</span><span class="op">=</span><span class="nam">props</span><span class="op">,</span> <span class="nam">parser</span><span class="op">=</span><span class="num">1</span><span class="op">,</span> <span class="nam">format_root_node</span><span class="op">=</span><span class="key">True</span><span class="op">)</span><span class="op">,</span> <span class="nam">expected_tree_with_root</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t173" href="#t173">173</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p class="run"><span class="n"><a id="t174" href="#t174">174</a></span><span class="t"><span class="key">if</span> <span class="nam">__name__</span> <span class="op">==</span> <span class="str">'__main__'</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p class="mis show_mis"><span class="n"><a id="t175" href="#t175">175</a></span><span class="t">    <span class="nam">unittest</span><span class="op">.</span><span class="nam">main</span><span class="op">(</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p class="pln"><span class="n"><a id="t176" href="#t176">176</a></span><span class="t"><span class="com">#pytest.main(['-v'])</span>&nbsp;</span><span class="r"></span></p>
</main>
<footer>
    <div class="content">
        <p>
            <a id="prevFileLink" class="nav" href="test_prune_py.html">&#xab; prev</a> &nbsp; &nbsp;
            <a id="indexLink" class="nav" href="index.html">&Hat; index</a> &nbsp; &nbsp;
            <a id="nextFileLink" class="nav" href="d_a75cd4a9f8cad98a___init___py.html">&#xbb; next</a>
            &nbsp; &nbsp; &nbsp;
            <a class="nav" href="https://coverage.readthedocs.io/en/7.2.7">coverage.py v7.2.7</a>,
            created at 2024-08-07 10:27 +0200
        </p>
    </div>
</footer>
</body>
</html>
